<!doctype html>
<html lang="en" id="top-of-site" class="js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Using the VitePWA Plugin for an Offline Site | CSS-Tricks - CSS-Tricks</title>
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#ff7a18">
<meta name="monetization" content="$ilp.uphold.com/biyqg2MkQKbe">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="CSS-Tricks Search">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="https://css-tricks.com/feed/">
<link rel="preconnect" href="https://s3.buysellads.com">
<link rel="dns-prefetch" href="https://s3.buysellads.com">
<link rel="preconnect" href="https://srv.buysellads.com">
<link rel="dns-prefetch" href="https://srv.buysellads.com">
<link rel="preconnect" href="https://res.cloudinary.com">
<link rel="dns-prefetch" href="https://res.cloudinary.com">
<link rel="preconnect" href="https://static.codepen.io">
<link rel="dns-prefetch" href="https://static.codepen.io">
<style id="jetpack-boost-critical-css">@media all{@charset "UTF-8";*{box-sizing:border-box}a{text-decoration:none}article,header,nav{display:block}html{-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0}body,html,ol,ul{margin:0}ol,ul{padding:0}nav ul{list-style:none;list-style-image:none}img{border:0;-ms-interpolation-mode:bicubic}input,textarea{font-size:100%;margin:0;vertical-align:baseline}input{line-height:normal}textarea{overflow:auto;vertical-align:top}@media (prefers-reduced-motion:reduce){*{scroll-behavior:auto!important}}@font-face{font-family:MD Primer Bold;font-weight:700}@font-face{font-family:Blanco;font-weight:400}@font-face{font-family:Blanco;font-weight:700}@font-face{font-family:Blanco;font-style:italic}@font-face{font-family:Blanco;font-weight:700;font-style:italic}html{font-family:Blanco,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:clamp(12px,calc(.8rem + .25vw),20px);font-weight:400;line-height:1.7}a{color:#0089c7}.article-title{font-size:clamp(1.2rem,calc(1rem + 3.5vw),4rem);text-shadow:0 2px 2px rgba(0,0,0,.5)}h1,h3,h4{font-weight:800;margin:0 0 1.5rem;line-height:1.1}h3 a{color:inherit}h1{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-size:clamp(2rem,calc(2rem + 1.2vw),3rem);font-weight:700}h3{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:2rem;letter-spacing:.03rem;font-weight:800}body:not(.page-id-21059):not(.parent-pageid-3222):not(.postid-181375):not(.postid-199370):not(.woocommerce-checkout) .article-content h3{margin-top:100px}body:not(.page-id-21059):not(.parent-pageid-3222):not(.postid-181375):not(.postid-199370):not(.woocommerce-checkout) .article-content h3 a{color:#0089c7}.aal_anchor{margin-left:-21px;margin-right:5px;position:relative;scroll-margin-top:100px;opacity:.33}.aal_anchor:before{content:"";position:absolute;width:100px;height:100px;border-radius:50%;left:50%;top:50%;transform:translate(-50%,-50%)}.aal_anchor svg{position:relative}h4{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:1.5rem;margin:0 0 .8rem}h4{line-height:1.05}.article-content li,.article-content p{max-width:700px}.article-content ol,.article-content ul{margin:0 0 1.5rem 1.5rem}.article-content ol li,.article-content ul li{line-height:1.6}.article-content ul li>*{text-indent:0}.article-content li{margin:0 0 5px}strong{font-weight:700}blockquote{font-size:1.3rem;letter-spacing:-.02rem;margin:1.5rem 0;padding:0 0 0 3rem;position:relative;font-style:italic}.article-content blockquote>*{hanging-punctuation:first}.article-content blockquote>:first-child:before{content:"\0022";width:100px;opacity:.15;font-size:100px;line-height:.85;position:absolute;left:-1rem}@media (max-width:800px){.article-content blockquote>:first-child:before{font-size:90px;left:-1.2rem}}blockquote p{margin:0 0 .25rem}blockquote p:last-child{margin:0}blockquote,blockquote p{max-width:900px}p,pre{margin:0 0 1.5rem}pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;clear:both;color:#fff;background:#1b1b1b;padding:0;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-ms-word-break:normal;word-break:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;position:relative;line-height:28px;border-radius:8px;overflow:hidden}pre[rel]:not([rel=""]):before{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:.5rem;content:attr(rel);color:#fff;position:absolute;top:-.2rem;right:.4rem;padding:0;color:#ff7a18!important}pre code{scrollbar-color:#666 #201c29;background:0 0;white-space:pre;-webkit-overflow-scrolling:touch;overflow-x:scroll;display:block;max-width:100%;min-width:100px;font-size:16px;padding:15px 20px 12px 22px;line-height:1.75}pre code::-webkit-scrollbar{width:.5em;height:.5em}@media (max-width:800px){pre code{font-size:11px;padding:15px 20px 10px 14px}}code{font-size:inherit;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace}li:not(.comment):not([data-category])>code,p>code{overflow-wrap:break-word;word-wrap:break-word;-webkit-box-decoration-break:clone;box-decoration-break:clone;padding:.1rem .3rem .2rem;border-radius:.2rem;font-size:88%}.screen-reader-text{position:absolute!important;clip:rect(1px,1px,1px,1px);width:1px;height:1px;overflow:hidden}p:empty{display:none}.language-javascript{color:#f5d67b}.button{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;background-color:#5e5e5e!important;color:#fff!important;border:0;border-bottom:1px solid #262626;border-right:1px solid #262626;box-shadow:inset 1px 1px 0 #777,0 2px 3px rgba(0,0,0,.4);display:inline-block;font-weight:700;line-height:1.4;text-transform:uppercase;text-decoration:none!important;border-radius:4px!important;white-space:nowrap;padding:1rem 1.5rem;text-align:center;position:relative}input[type=text],textarea{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;background:#eaeaea;border:1px solid #d4d4d4!important;padding:.5rem;border-radius:4px;border:0;width:100%}textarea{padding:1rem;display:block}html{--maxWidth:1600px;--gap:3rem;scrollbar-color:#666 #201c29;background:radial-gradient(900px 900px at top center,#5e5e5e,#2d3334,#262626);background-repeat:no-repeat;color:#fff;overflow-x:hidden}html::-webkit-scrollbar{width:16px;height:16px}@media (max-width:1200px){html{--gap:2rem}}@media (max-width:800px){html{--gap:1rem}}#top-of-site-pixel-anchor{position:absolute;width:1px;height:1px;top:500px;left:0}@media (max-width:800px){#top-of-site-pixel-anchor{top:46px}}.mega-header,.page-wrap{max-width:var(--maxWidth);margin:0 auto;padding:0 var(--gap)}main{position:relative;z-index:1}.articles-and-sidebar{display:grid;grid-template-columns:minmax(0,1fr) 300px;gap:var(--gap);margin:0 auto}.articles-and-sidebar>:not(.sidebar){align-self:start}@media (max-width:800px){.articles-and-sidebar{display:block;padding-top:0}}.articles-and-sidebar.single-mini{display:block}.articles-and-sidebar.single-mini .sidebar{display:none}.articles-and-sidebar.single-mini .article-content{font-size:1.5rem}@media (max-width:800px){.articles-and-sidebar.single-mini .article-content{font-size:1.2rem}}@media (max-width:800px){.sidebar{display:none}}img{max-width:100%}.site-header{position:relative;z-index:2;display:flex;padding:0 var(--gap);margin:0 0 var(--gap) 0;background-color:#111;background-image:paint(fleck);border-bottom:1px solid #676767}.site-header .logo{flex:0;position:relative;align-self:stretch}.site-header .logo,.site-header .logo>a{display:flex;align-items:center}.site-header .icon-logo-star{fill:#fff;width:25px;height:25px;margin:0 .5rem 0 0}.site-header .icon-logo-text{fill:#fff;height:25px;width:170px;margin-right:var(--gap)}.site-header .header-middle-area{flex:1;width:100%}.site-header .main-nav>ul{display:flex;height:100%}.site-header .main-nav>ul>li>a{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;text-transform:uppercase;font-weight:500;font-size:.8rem;height:100%;color:#fff;padding:1.2rem 1rem;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;overflow:hidden}@media (max-width:1000px){.site-header{padding:20px 20px 0;flex-wrap:wrap}.site-header .header-middle-area{flex:0 0 100%}.site-header .main-nav{padding-top:10px;-webkit-margin-start:-10px;margin-inline-start:-10px}.site-header .main-nav>ul>li>a{padding:.6rem .8rem;border-top-right-radius:4px;border-top-left-radius:4px}.site-header .icon-logo-star{width:18px;height:18px}.site-header .icon-logo-text{height:15px;width:116px}}@media (max-width:620px){.site-header{padding-top:15px}.site-header .main-nav{width:calc(100% + var(--gap)*2);overflow:auto}}.search-and-account{position:fixed;z-index:15;top:.9rem;right:var(--gap)}.search-and-account svg{width:32px;height:32px}@media (max-width:620px){.search-and-account{top:.95rem}.search-and-account svg{width:28px;height:28px}}.search-and-account a{margin-left:.5rem}.search-and-account a svg{-webkit-filter:drop-shadow(0 2px 5px rgba(0,0,0,.3));filter:drop-shadow(0 2px 5px rgba(0,0,0,.3))}.top-of-site-link{visibility:hidden;opacity:0;position:fixed;bottom:1.2rem;right:1.5rem;z-index:15}.top-of-site-link svg{-webkit-filter:drop-shadow(0 2px 5px rgba(0,0,0,.3));filter:drop-shadow(0 2px 5px rgba(0,0,0,.3))}.article-sponsor{padding:1rem 1.5rem calc(1rem + 10px);margin-bottom:-10px;border-radius:8px;background:rgba(0,0,0,.2)}.article-sponsor p{margin:0}.article-sponsor a{color:#fff;font-weight:700;position:relative;display:inline-block;line-height:1.2}.article-sponsor a:before{content:"";position:absolute;top:100%;width:100%;left:0;height:3px;border-radius:2px;background:linear-gradient(130deg,#ff7a18,#af002d 41.07%,#319197 76.05%)}.article-content{font-size:1.2rem;background:#fff;color:#000;overflow-wrap:break-word;border-radius:8px;padding:4rem;position:relative}@media (max-width:800px){.article-content{padding:1.66rem}}.article-content a{text-decoration:underline;-webkit-text-decoration-color:#a2dffb;text-decoration-color:#a2dffb}.article-content img{max-width:100%;height:auto!important}figure>img{display:block}.mega-header{position:relative;z-index:1;overflow:hidden;padding:0 0 2rem}.mega-header .tags a{color:#ffdfc7}.mega-header .author-name,.mega-header .author-row{color:#fff}.jp-relatedposts{margin-bottom:1rem}.author-row{-webkit-margin-before:auto;margin-block-start:auto;display:grid;grid-template-columns:40px 1fr;gap:.5rem;align-items:center;color:#565656;line-height:1.3;padding-top:.5rem}.author-row>div>*{white-space:nowrap}.avatar{width:40px;height:40px;border-radius:50%;margin-right:.5rem}.author-name{font-weight:700;color:#000}.tags{line-height:1;margin:0 0 .5rem}.tags a{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;text-transform:uppercase;color:#ff7a18;font-size:.66rem;-webkit-margin-end:.66rem;margin-inline-end:.66rem}.CommentForm .comment-wrap .author-avatar,.comment ul .comment-wrap .author-avatar,.commentlist .comment-wrap .author-avatar{margin:0;align-self:start;grid-area:auto}#commentform label{display:block}#commentform .comment-notes,#commentform .required{display:none}#commentform p{margin-bottom:.5rem}.bsap-doubles.side-by-side{margin-top:var(--gap)}#all-modules{height:100%}#scroll-ad-position{width:1px;height:1px}#sticky-sidebar-stuff{position:-webkit-sticky;position:sticky;top:2.5rem;opacity:0;visibility:hidden}@media (max-width:620px){#sticky-sidebar-stuff{top:89px}}.fem-ad{background:#1f1f1f;color:#fff;border-radius:8px;position:relative}.fem-ad:before{content:"";background:linear-gradient(130deg,#ff7a18,#af002d 41.07%,#319197 76.05%);position:absolute;top:-5px;left:-5px;width:calc(100% + 10px);height:calc(100% + 10px);z-index:-1;border-radius:12px}.fem-ad h4{font-size:1.2rem}.fem-ad .fem-learning-partner{font-size:.75rem;color:#fff;text-transform:uppercase;letter-spacing:.13rem;text-align:center;margin:0 0 .5rem}.fem-ad .fem-header-inner{background:rgba(0,0,0,.7);padding:1rem;border-radius:7px}.fem-ad .fem-title{text-align:center}.fem-ad .fem-logo{width:200px;display:block;margin:0 auto}.fem-ad .fem-message{background:#eaeaea;border-bottom-left-radius:7px;border-bottom-right-radius:7px;color:#000;padding:1.5rem;font-size:.85rem}.fem-ad .fem-message p{margin:0}.fem-footer-ad{margin:var(--gap) 0 var(--gap) 0;display:grid;grid-template-columns:1fr 2fr}@media (max-width:1200px){.fem-footer-ad{grid-template-columns:4fr 3fr}}@media (max-width:800px){.fem-footer-ad{display:block}.fem-footer-ad .fem-header-inner{height:auto}}.fem-footer-ad .fem-header-inner{padding:4rem 1.5rem;display:grid;place-items:center}.single-almanac-content .almanac-sidebar{grid-area:1/1/2/2;background:#111;border-radius:8px;padding:1rem}.single-almanac-content .article-content-wrap{grid-area:1/2/2/3}.single-almanac-content .sidebar{grid-area:1/3/2/4}@media (max-width:650px){.single-almanac-content .article-content-wrap{grid-area:1/1/2/2;min-width:0}.single-almanac-content .almanac-sidebar{grid-area:2/1/3/2}}@media screen and (max-width:400px){@-ms-viewport{width:320px}}}@media all{#jp-relatedposts{display:none;padding-top:1em;margin:1em 0;position:relative;clear:both}.jp-relatedposts:after{content:'';display:block;clear:both}}</style>

<meta name="description" content="The VitePWA plugin adds a service worker that handles offline support, caching assets, and prompting users when new content is available." />
<meta name="robots" content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large" />
<link rel="canonical" href="https://css-tricks.com/vitepwa-plugin-offline-service-worker/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Using the VitePWA Plugin for an Offline Site | CSS-Tricks" />
<meta property="og:description" content="The VitePWA plugin adds a service worker that handles offline support, caching assets, and prompting users when new content is available." />
<meta property="og:url" content="https://css-tricks.com/vitepwa-plugin-offline-service-worker/" />
<meta property="og:site_name" content="CSS-Tricks" />
<meta property="article:publisher" content="https://www.facebook.com/CSSTricks" />
<meta property="article:tag" content="service workers" />
<meta property="article:tag" content="vite" />
<meta property="article:section" content="Article" />
<meta property="og:updated_time" content="2022-01-18T06:30:29-08:00" />
<meta property="og:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/361001" />
<meta property="og:image:secure_url" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/361001" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content="VitePWA plugin" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="article:published_time" content="2022-01-18T06:30:26-08:00" />
<meta property="article:modified_time" content="2022-01-18T06:30:29-08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Using the VitePWA Plugin for an Offline Site | CSS-Tricks" />
<meta name="twitter:description" content="The VitePWA plugin adds a service worker that handles offline support, caching assets, and prompting users when new content is available." />
<meta name="twitter:site" content="@CSS" />
<meta name="twitter:creator" content="@AdamRackis" />
<meta name="twitter:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/361001" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Adam Rackis" />
<meta name="twitter:label2" content="Time to read" />
<meta name="twitter:data2" content="13 minutes" />

<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//i0.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="CSS-Tricks &raquo; Making a Site Work Offline Using the VitePWA Plugin Comments Feed" href="https://css-tricks.com/vitepwa-plugin-offline-service-worker/feed/" />
<noscript><link rel='stylesheet' id='css-tricks-style-css'  href='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/style.css?ver=cache_bust=1641416079722' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='css-tricks-style-css' href='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/style.css?ver=cache_bust=1641416079722' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='mediaelement-css'  href='https://c0.wp.com/c/5.8.3/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/5.8.3/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wp-mediaelement-css'  href='https://c0.wp.com/c/5.8.3/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/5.8.3/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wc-blocks-vendors-style-css'  href='https://c0.wp.com/p/woocommerce/6.1.0/packages/woocommerce-blocks/build/wc-blocks-vendors-style.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wc-blocks-vendors-style-css' href='https://c0.wp.com/p/woocommerce/6.1.0/packages/woocommerce-blocks/build/wc-blocks-vendors-style.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wc-blocks-style-css'  href='https://c0.wp.com/p/woocommerce/6.1.0/packages/woocommerce-blocks/build/wc-blocks-style.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wc-blocks-style-css' href='https://c0.wp.com/p/woocommerce/6.1.0/packages/woocommerce-blocks/build/wc-blocks-style.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel="https://api.w.org/" href="https://css-tricks.com/wp-json/" /><link rel="alternate" type="application/json" href="https://css-tricks.com/wp-json/wp/v2/posts/361001" /><link rel='shortlink' href='https://css-tricks.com/?p=361001' />
<link rel="alternate" type="application/json+oembed" href="https://css-tricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcss-tricks.com%2Fvitepwa-plugin-offline-service-worker%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://css-tricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcss-tricks.com%2Fvitepwa-plugin-offline-service-worker%2F&#038;format=xml" />


<meta property="og:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/361001">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/361001">
<meta name="twitter:card" content="summary_large_image">

<meta name="jetpack-boost-ready" content="true" />
<style type='text/css'>img#wpstats{display:none}</style>
<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<link rel="icon" href="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" />
</head>
<body class="post-template-default single single-post postid-361001 single-format-standard theme-CSS-Tricks-19 woocommerce-no-js jps-theme-CSS-Tricks-19 category-article">
<div id="top-of-site-pixel-anchor"></div>
<header class="site-header" id="site-header">
<a id="skip-nav" class="skip-nav screen-reader-text" href="#maincontent">Skip to main content</a>
<div class="logo">
<a href="/">
<div class="screen-reader-text">CSS-Tricks</div>
<svg class="icon-logo-star" width="35px" height="35px" viewBox="0 0 362.62 388.52" data-spin-me="false">
<path d="M156.58,239l-88.3,64.75c-10.59,7.06-18.84,11.77-29.43,11.77-21.19,0-38.85-18.84-38.85-40C0,257.83,14.13,244.88,27.08,239l103.6-44.74L27.08,148.34C13,142.46,0,129.51,0,111.85,0,90.66,18.84,73,40,73c10.6,0,17.66,3.53,28.25,11.77l88.3,64.75L144.81,44.74C141.28,20,157.76,0,181.31,0s40,18.84,36.5,43.56L206,149.52l88.3-64.75C304.93,76.53,313.17,73,323.77,73a39.2,39.2,0,0,1,38.85,38.85c0,18.84-12.95,30.61-27.08,36.5L231.93,194.26,335.54,239c14.13,5.88,27.08,18.83,27.08,37.67,0,21.19-18.84,38.85-40,38.85-9.42,0-17.66-4.71-28.26-11.77L206,239l11.77,104.78c3.53,24.72-12.95,44.74-36.5,44.74s-40-18.84-36.5-43.56Z" />
</svg>
<svg class="icon-logo-text" width="214px" height="35px" viewBox="0 0 474.15 58.26">
<path d="M46 42.57a4.5 4.5 0 0 0-3 1.13c-4.1 3.46-8.13 5.39-14.08 5.39-10.78 0-18.58-8.93-18.58-20v-.09c0-11 7.88-19.87 18.58-19.87a20.42 20.42 0 0 1 13.48 5.03 4.95 4.95 0 0 0 7.88-3.86 4.94 4.94 0 0 0-1.93-3.94c-4.91-3.79-10.62-6.36-19.35-6.36-17 0-29 13.12-29 29.13v.16c0 16.17 12.23 29 28.64 29 9.09 0 15.12-2.9 20.43-7.56a4.76 4.76 0 0 0 1.61-3.54 4.71 4.71 0 0 0-4.68-4.62zm36.86-17.95c-10.86-2.62-13.43-4.5-13.43-8.85v-.16c0-3.7 3.38-6.68 9.17-6.68 4.43 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.91-5.22c-11.18 0-19.23 6.68-19.23 16.34v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.73 4.58 12.73 8.6v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.94 3.77 35.05 35.05 0 0 0 21.16 7.1c11.83 0 20.11-6.28 20.11-16.82v-.16c0-9.34-6.11-13.6-18.02-16.5zm49.88 0c-10.86-2.57-13.43-4.51-13.43-8.85v-.16c0-3.7 3.38-6.68 9.17-6.68 4.42 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.91-5.22c-11.18 0-19.23 6.68-19.23 16.33v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.71 4.59 12.71 8.61v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.96 3.77 35.05 35.05 0 0 0 21.16 7.08c11.83 0 20.11-6.28 20.11-16.82v-.16c0-9.32-6.11-13.58-18.02-16.48zm45.62 3.22h-15.13a4.79 4.79 0 0 0 0 9.58h15.12a4.79 4.79 0 0 0 0-9.58zm45.64-26.84h-37.45a4.59 4.59 0 0 0 0 9.17h13.68v42.62a5 5 0 0 0 10 0v-42.65h13.77a4.59 4.59 0 0 0 0-9.14zm38.86 0h-20.15a4.91 4.91 0 0 0-5 5v46.79a4.95 4.95 0 0 0 9.89 0v-15.13h12.47l13.68 17.46a5.65 5.65 0 0 0 4.83 2.58 4.67 4.67 0 0 0 4.75-4.59 5.74 5.74 0 0 0-1.61-3.78l-10.78-13.6c7.56-2.33 12.79-7.81 12.79-16.82v-.16a17 17 0 0 0-4.66-12.15c-3.62-3.54-9.17-5.6-16.25-5.6zm10.86 18.51c0 5.71-4.51 9.41-11.58 9.41h-14.53v-18.92h14.39c7.32 0 11.67 3.3 11.67 9.33zm27-18.91a4.89 4.89 0 0 0-5 4.91v47.28a4.95 4.95 0 0 0 9.89 0v-47.32a4.88 4.88 0 0 0-4.98-4.91zm62.67 42a4.5 4.5 0 0 0-3 1.13c-4.1 3.46-8.13 5.39-14.08 5.39-10.78 0-18.58-8.93-18.58-20v-.12c0-11 7.88-19.87 18.58-19.87a20.42 20.42 0 0 1 13.44 5.07 4.95 4.95 0 0 0 7.88-3.86 4.94 4.94 0 0 0-1.93-3.94c-4.98-3.83-10.7-6.4-19.38-6.4-17.06 0-29 13.12-29 29.13v.16c0 16.17 12.23 29 28.64 29 9.09 0 15.12-2.9 20.43-7.56a4.76 4.76 0 0 0 1.61-3.58 4.71 4.71 0 0 0-4.7-4.58zm41-16.82l17.54-16.9a4.81 4.81 0 0 0 1.77-3.7 4.53 4.53 0 0 0-4.7-4.62 5.2 5.2 0 0 0-4.1 1.85l-26.66 26.88v-23.82a4.95 4.95 0 0 0-9.9 0v47.32a4.95 4.95 0 0 0 9.9 0v-11.67l9.17-8.85 18.1 23.09a5 5 0 0 0 4.18 2.33 4.83 4.83 0 0 0 5-4.83 5.36 5.36 0 0 0-1.37-3.54zm51.8-1.13c-10.92-2.65-13.49-4.53-13.49-8.88v-.16c0-3.7 3.38-6.68 9.17-6.68 4.42 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.94-5.22c-11.15 0-19.2 6.68-19.2 16.34v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.71 4.59 12.71 8.61v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.96 3.76 35.05 35.05 0 0 0 21.12 7.1c11.83 0 20.11-6.28 20.11-16.82v-.16c.04-9.34-6.11-13.6-17.98-16.5z" />
</svg> </a>
</div>
<div class="header-middle-area">
<nav class="main-nav" id="main-nav">
<ul>
<li class="articles">
<a href="/archives/">
<span>Articles</span>
</a>
</li>
<li class="videos">
<a href="/video-screencasts/">
<span>Videos</span>
</a>
</li>
<li class="almanac">
<a href="/almanac/">
<span>Almanac</span>
</a>
</li>
<li class="newsletter">
<a href="/newsletters/">
<span>Newsletter</span>
</a>
</li>
<li class="guides">
<a href="/guides/">
<span>Guides</span>
</a>
</li>
<li class="books">
<a href="/books/">
<span>Books</span>
</a>
</li>
</ul>
</nav>
<div class="search-and-account">
<a href="https://www.google.com/search?q=site:css-tricks.com%20layout" class="jetpack-search-filter__link">
<span class="screen-reader-text">Search</span>
<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M15.0726 10.4326C12.4801 10.4326 10.4 12.5451 10.4 15.1053C10.4 17.6978 12.5125 19.7779 15.0726 19.7779C17.6651 19.7779 19.7453 17.6654 19.7453 15.1053C19.744 12.544 17.664 10.4326 15.0726 10.4326Z" fill="white" />
<path d="M16.0327 0.447479C7.42401 0.447479 0.447693 7.4238 0.447693 16.0324C0.447693 24.6398 7.42401 31.6161 16.0314 31.6161C24.64 31.6161 31.6163 24.6398 31.6163 16.0324C31.6163 7.4238 24.64 0.447479 16.0327 0.447479ZM23.6163 24.0324C23.3926 24.2562 23.0401 24.385 22.6563 24.385C22.2726 24.385 21.9526 24.2575 21.6963 24.0324L18.7526 21.0887L18.4651 21.2487C17.4088 21.825 16.2576 22.145 15.0724 22.145C11.1998 22.145 8.06509 19.0087 8.06509 15.1376C8.06509 11.265 11.2013 8.13023 15.0724 8.13023C18.9451 8.13023 22.0798 11.2665 22.0798 15.1376C22.0798 16.5138 21.6961 17.8251 20.9273 18.9776L20.7348 19.2976L23.6473 22.2101C23.8711 22.4664 24.0311 22.7864 24.0311 23.1376C23.9998 23.4563 23.8723 23.7763 23.616 24.0326L23.6163 24.0324Z" fill="white" />
</svg>
</a>
<a href="/product/membership/">
<span class="screen-reader-text">Account</span>
<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17 1.7C11.5335 1.7 6.48243 4.61655 3.74917 9.35C1.0172 14.0835 1.0172 19.9165 3.74917 24.65C6.48246 29.3835 11.5335 32.3 17 32.3C20.4918 32.3133 23.8809 31.1193 26.5917 28.9199C29.9014 26.2557 31.9559 22.3365 32.2602 18.0984C32.5657 13.8603 31.0954 9.68748 28.2003 6.57682C25.3063 3.46636 21.249 1.69986 17.0003 1.69986L17 1.7ZM27.9956 24.411C27.2651 22.1412 25.014 20.2514 21.9925 19.2447C20.7069 20.6405 18.8967 21.4361 17 21.4361C15.1021 21.4347 13.292 20.6405 12.0074 19.2447C8.98463 20.2514 6.73335 22.1413 6.00439 24.411C4.20212 21.7388 3.43579 18.5008 3.8475 15.3041C4.25921 12.1073 5.82242 9.17082 8.24234 7.04174C10.6622 4.91276 13.7752 3.7387 16.9987 3.7387C20.2221 3.7387 23.3353 4.91276 25.7564 7.04041C28.1763 9.16939 29.7395 12.1057 30.1513 15.3027C30.563 18.4995 29.7966 21.7376 27.9957 24.411L27.9956 24.411Z" fill="white" />
<path d="M22.5049 13.6092C22.5049 16.9919 20.0399 19.736 17 19.736C13.9586 19.736 11.4937 16.9921 11.4937 13.6092C11.4937 10.2251 13.9587 7.48236 17 7.48236C20.0401 7.48236 22.5049 10.2249 22.5049 13.6092Z" fill="white" />
</svg>
</a>
</div>
</div>
</header>
<div class="page-wrap">
<div class="articles-and-sidebar ">
<main id="post-361001">
<article>
<header class="mega-header">
<style>
    html {
      --featured-img: url(https://css-tricks.com/wp-content/uploads/2022/01/website-offline-pwa.jpg);
      --bg-blend-mode: multiply;
      background-size: 120% 2000px, 100% auto;
    }
  </style>
<div class="tags">
<a href="https://css-tricks.com/tag/service-workers/" rel="tag">service workers</a> <a href="https://css-tricks.com/tag/vite/" rel="tag">vite</a> </div>
<h1 class="article-title">
Making a Site Work Offline Using the VitePWA&nbsp;Plugin </h1>
<div class="author-row">
<a href="https://css-tricks.com/author/adam-rackis/" aria-label="Author page of Adam Rackis">
<img alt="Avatar of Adam Rackis" src="https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=80&#038;d=retro&#038;r=pg" srcset="https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=160&#038;d=retro&#038;r=pg 2x" class="avatar avatar-80 photo skip-lazy" height="80" width="80" loading="lazy"><noscript><img alt='Avatar of Adam Rackis' src='https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=80&#038;d=retro&#038;r=pg' srcset='https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=160&#038;d=retro&#038;r=pg 2x' class='avatar avatar-80 photo skip-lazy' height='80' width='80' loading='lazy'/></noscript> </a>
<div>
<a class="author-name" href="https://css-tricks.com/author/adam-rackis/">
Adam Rackis </a>
on
<time datetime="">
Jan 18, 2022 </time>
</div>
</div>
</header>
<div class="article-sponsor">
<p>
<a href="https://ad.doubleclick.net/ddm/trackclk/N1224323.3091281BUYSELLADS/B25600467.324342617;dc_trk_aid=517316264;dc_trk_cid=157730382;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;ltd=">Try Mailchimp today.</a>
<img src="https://ad.doubleclick.net/ddm/trackimp/N1224323.3091281BUYSELLADS/B25600467.324342617;dc_trk_aid=517316264;dc_trk_cid=157730382;ord=1642516236;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;ltd=?" alt="MailChimp Tracking Pixel">
</p>
</div>
<div class="article-content">
<p><a href="https://vite-plugin-pwa.netlify.app/" rel="noopener">The VitePWA plugin</a> from <a href="https://antfu.me" rel="noopener">Anthony Fu</a> is a fantastic tool for your Vite-powered sites. It helps you add a service worker that handles:</p>
<ul><li>offline support</li><li>caching assets and content</li><li>prompting the user when new content is available</li><li>…and other goodies!</li></ul>
<p>We’ll walk through the concept of service workers together, then jump right into making one with the VitePWA plugin.</p>
<span id="more-361001"></span>
<p>New to Vite? Check out <a href="https://css-tricks.com/adding-vite-to-your-existing-web-app">my prior post</a> for an introduction.</p>
<h2 class="simpletoc-title"><a href="#aa-table-of-contents" aria-hidden="true" class="aal_anchor" id="aa-table-of-contents"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2><ol class="simpletoc">
<li>
<a href="#service-workers-introduced">Service workers, introduced</a></li><li>
<a href="#versioning-and-manifests">Versioning and manifests</a></li><li>
<a href="#our-first-service-worker">Our first service worker</a></li><li>
<a href="#what-about-offline-functionality">What about offline functionality?</a></li><li>
<a href="#how-service-workers-update">How service workers update</a></li><li>
<a href="#a-better-way-to-update-content">A better way to update content</a></li><li>
<a href="#runtime-caching">Runtime caching</a></li><li>
<a href="#adding-your-own-service-worker-content">Adding your own service worker content</a></li><li>
<a href="#wrapping-up">Wrapping up</a></li></ol>
<h3 id="service-workers-introduced"><a href="#aa-service-workers-introduced" aria-hidden="true" class="aal_anchor" id="aa-service-workers-introduced"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service workers, introduced</h3>
<p>Before getting into the VitePWA plugin, let’s briefly talk about the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API" rel="noopener">Service Worker</a> itself.</p>
<p>A <dfn>service worker</dfn> is a background process that runs on a separate thread in your web application. Service workers have the ability to intercept network requests and do… anything. The possibilities are surprisingly wide. For example, you could intercept requests for TypeScript files and compile them on the fly. Or you could intercept requests for video files and perform an advanced transcoding that the browser doesn’t currently support. More commonly though, a service worker is used to cache assets, both to improve a site’s performance and enable it to do <em>something</em> when it’s offline.</p>
<p>When someone first lands on your site, the service worker the VitePWA plugin creates installs, and caches all of your HTML, CSS, and JavaScript files by leveraging the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache" rel="noopener">Cache Storage API</a>. The result is that, on subsequent visits to your site, the browser will load those resources from cache, rather than needing to make network requests. And even on the first visit to your site, since the service worker <em>just</em> pre-cached everything, the next place your user clicks will probably be pre-cached already, allowing the browser to completely bypass a network request.</p>
<h3 id="versioning-and-manifests"><a href="#aa-versioning-and-manifests" aria-hidden="true" class="aal_anchor" id="aa-versioning-and-manifests"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Versioning and manifests</h3>
<p>You might be wondering what happens with a service worker when your code is updated. If your service worker is caching, say, a <code>foo.js</code> file, and you modify that file, you want the service worker to pull down the updated version, the next time a user visits the site.</p>
<p>But in practice you don’t have a <code>foo.js</code> file. Usually, a build system will create something like <code>foo-ABC123.js</code>, where “ABC123” is a hash of the file. If you update <code>foo.js</code>, the next deployment of your site may send over <code>foo-XYZ987.js</code>. How does the service worker handle this?</p>
<p>It turns out the Service Worker API is an <em>extremely</em> low-level primitive. If you’re looking for a native turnkey solution between it and the cache API, you’ll be disappointed. <strong>Basically, the creation of your service worker needs to be automated, in part, and connected to the build system.</strong> You’d need to see all the assets your build created, hard-code those file names into the service worker, have code to pre-cache them, and more importantly, <em>keep track of</em> the files that are cached.</p>
<p>If code updates, the service worker file also changes, containing the <em>new</em> filenames, complete with hashes. When a user makes their next visit to the app, the new service worker will need to install, and compare the new file manifest with the manifest that’s currently in cache, ejecting files that are no longer needed, while caching the new content.</p>
<p>This is an absurd amount of work and incredibly difficult to get right. While it can be a fun project, in practice you’ll want to use an established product to generate your service worker — and the best product around is <a href="https://developers.google.com/web/tools/workbox" rel="noopener">Workbox</a>, which is from the folks at Google.</p>
<p>Even Workbox is a bit of a low-level primitive. It needs detailed information about the files you’re pre-caching, which are buried in your build tool. This is why we use the VitePWA plugin. It uses Workbox under the hood, and configures it with all the info it needs about the bundles that Vite creates. Unsurprisingly, there are also <a href="https://developers.google.com/web/tools/workbox/guides/generate-service-worker/webpack" rel="noopener">webpack</a> and <a href="https://www.npmjs.com/package/rollup-plugin-workbox" rel="noopener">Rollup</a> plugins if you happen to prefer working with those bundlers.</p>
<h3 id="our-first-service-worker"><a href="#aa-our-first-service-worker" aria-hidden="true" class="aal_anchor" id="aa-our-first-service-worker"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Our first service worker</h3>
<p>I’ll assume you already have a Vite-based site. If not, feel free to <a href="https://vitejs.dev/guide/#scaffolding-your-first-vite-project" rel="noopener">create one</a> from any of the <a href="https://vitejs.dev/guide/#community-templates" rel="noopener">available templates</a>.</p>
<p>First, we install the VitePWA plugin:</p>
<pre rel="Terminal" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">npm i vite-plugin-pwa</code></pre>
<p>We’ll import the plugin in our Vite config:</p>
<pre rel="Terminal" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">import { VitePWA } from "vite-plugin-pwa"</code></pre>
<p>Then we put it to use in the config as well:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">plugins: [
  VitePWA()</code></pre>
<p>We’ll add more options in a bit, but that’s all we need to create a surprisingly useful service worker. Now let’s register it somewhere in the entry of our application with this code:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">import { registerSW } from "virtual:pwa-register";

if ("serviceWorker" in navigator) {
  // &amp;&amp; !/localhost/.test(window.location)) {
  registerSW();
}</code></pre>
<p>Don’t let the code that’s commented out throw you for a loop. It&#8217;s extremely important, in fact, as it prevents the service worker from running in development. We only want to install the service worker anywhere that’s not on the localhost where we’re developing, that is, unless we’re developing the service worker itself, in which case we can comment out that check (and revert before pushing code to the main branch).</p>
<p>Let’s go ahead and open a fresh browser, launch DevTools, navigate to the Network tab, and run the web app. Everything should load as you’d normally expect. The difference is that you should see a whole slew of network requests in DevTools.</p>
<figure class="wp-block-image"><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637565267503_image.png" alt="A screenshot of DevTools listing all of the network requests for the currant app using the VitePWA plugin. There are a total of 16 various JavaScript and CSS files." data-lazy-src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637565267503_image.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637565267503_image.png" alt="A screenshot of DevTools listing all of the network requests for the currant app using the VitePWA plugin. There are a total of 16 various JavaScript and CSS files."/></noscript></figure>
<p>That’s Workbox pre-caching the bundles. Things are working!</p>
<h3 id="what-about-offline-functionality"><a href="#aa-what-about-offline-functionality" aria-hidden="true" class="aal_anchor" id="aa-what-about-offline-functionality"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What about offline functionality?</h3>
<p>So, our service worker is pre-caching all of our bundled assets. That means it will serve those assets from cache without even needing to hit the network. Does that mean our service worker could serve assets even when the user has no network access? Indeed, it does!</p>
<p>And, believe it or not, it’s already done. Give it a try by opening the Network tab in DevTools and telling Chrome to simulate offline mode, like this.</p>
<figure class="wp-block-image"><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637633418654_image.png" alt="Screenshot of the DevTools UO to simulate an offline connection with the select menu open. The No throttling option is currently checked but the Offline option is highlighted in light blue." data-lazy-src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637633418654_image.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637633418654_image.png" alt="Screenshot of the DevTools UO to simulate an offline connection with the select menu open. The No throttling option is currently checked but the Offline option is highlighted in light blue."/></noscript><figcaption>The&nbsp;“No&nbsp;throttling” option is the default selection. Click that and select the&nbsp;“Offline”&nbsp;option to simulate an offline connection.</figcaption></figure>
<p>Let’s refresh the page. You <em>should</em> see everything load. Of course, if you’re running any network requests, you’ll see them hang forever since you’re offline. Even here, though, there are things you can do. Modern browsers ship with their own internal, persistent database called IndexedDB. There’s nothing stopping you from writing your own code to sync some data to there, then write some custom service worker code to intercept network requests, determine if the user is offline, and then serve equivalent content from IndexedDB if it&#8217;s in there.</p>
<p>But a much simpler option is to detect <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/onLine" rel="noopener">if the user is offline</a>, show a message about being offline, and then bypass the data requests. This is a topic unto itself, which <a href="https://css-tricks.com/making-web-app-work-offline-part-2-implementation/">I’ve written about</a> in much greater detail.</p>
<p>Before showing you how to write, and integrate your own service worker content, let’s take a closer look at our existing service worker. In particular, let&#8217;s see how it manages updating/changing content. This is surprisingly tricky and easy to mess up, even with the VitePWA plugin.</p>
<p>Before moving on, make sure you tell Chrome DevTools to put you back online.</p>
<h3 id="how-service-workers-update"><a href="#aa-how-service-workers-update" aria-hidden="true" class="aal_anchor" id="aa-how-service-workers-update"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How service workers update</h3>
<p>Take a closer look at what happens to our site when we change the content. We’ll go ahead and remove our existing service worker, which we can do in the Application tab of DevTools, under Storage.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1154" height="774" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1154%2C774&#038;ssl=1" alt="Screenshot showing the Storage panel of DevTools. The DevTools menu is a panel on the left and the app usage is displayed in a panel on the right, showing that 508 kilobytes of data total is used, where 392 kilobytes are cached and 16.4 are service workers. A button to clear site data is below the Usage stats with a deep blue label and a light gray background." class="wp-image-361008 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?w=1154&amp;ssl=1 1154w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=300%2C201&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1024%2C687&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=768%2C515&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1000%2C671&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1154%2C774&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1154" height="774" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1154%2C774&#038;ssl=1" alt="Screenshot showing the Storage panel of DevTools. The DevTools menu is a panel on the left and the app usage is displayed in a panel on the right, showing that 508 kilobytes of data total is used, where 392 kilobytes are cached and 16.4 are service workers. A button to clear site data is below the Usage stats with a deep blue label and a light gray background." class="wp-image-361008" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?w=1154&amp;ssl=1 1154w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=300%2C201&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1024%2C687&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=768%2C515&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634017139_image.png?resize=1000%2C671&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>Click the “Clear site data” button to get a clean slate. While I’m at it, I’m going to remove most of the routes of my own site so there’s fewer resources, then let Vite rebuild the app.</p>
<p>Look in the generated <code>sw.js</code> to see the generated Workbox service worker. There should be a pre-cache manifest inside of it. Mine looks like this:</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1336" height="474" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1336%2C474&#038;ssl=1" alt="A dark mode screenshot showing a list of eight asset urls inside of a precacheAndRoute function." class="wp-image-361013 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?w=1336&amp;ssl=1 1336w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=300%2C106&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1024%2C363&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=768%2C272&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1000%2C355&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1336%2C474&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1336" height="474" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1336%2C474&#038;ssl=1" alt="A dark mode screenshot showing a list of eight asset urls inside of a precacheAndRoute function." class="wp-image-361013" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?w=1336&amp;ssl=1 1336w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=300%2C106&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1024%2C363&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=768%2C272&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634248783_image.png?resize=1000%2C355&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p class="is-style-explanation">If <code>sw.js</code> is minified, run it through Prettier to make it easier to read.</p>
<p>Now let’s run the site and see what’s in our cache:</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1962" height="382" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1962%2C382&#038;ssl=1" alt class="wp-image-361015 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?w=1962&amp;ssl=1 1962w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=300%2C58&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1024%2C199&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=768%2C150&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1536%2C299&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1000%2C195&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1962%2C382&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1962" height="382" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1962%2C382&#038;ssl=1" alt="" class="wp-image-361015" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?w=1962&amp;ssl=1 1962w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=300%2C58&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1024%2C199&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=768%2C150&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1536%2C299&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637634292609_image.png?resize=1000%2C195&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>Let’s focus on the <code>settings.js file</code>. Vite generated <code>assets/settings.ccb080c2.js</code> based on the hash of its contents. Workbox, being independent of Vite, generated <em>its own</em> hash of the same file. If that same file name were to be generated with different content, then a new service worker would be re-generated, with a different pre-cache manifest (same file, but different revision) and Workbox would know to cache the new version, and remove the old when it’s no longer needed.</p>
<p>Again, the filenames will always be different since we’re using a bundler that injects hash codes into our file names, but Workbox supports dev environments which don’t do that.</p>
<p class="is-style-explanation">Since the time writing, the VitePWA plugin has been updated and no longer injects these revision hashes. If you’re attempting to follow along with the steps in this article, this specific step might be slightly different from your actual experience. See <a href="https://github.com/antfu/vite-plugin-pwa/issues/163" rel="noopener">this GitHub issue</a> for more context.</p>
<p>If we update our <code>settings.js</code> file, then Vite will create a new file in our build, with a new hash code, which Workbox will treat as a new file. Let’s see this in action. After changing the file and re-running the Vite build, our pre-cache manifest looks like this:</p>
<figure class="wp-block-image"><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635068016_image.png" alt data-lazy-src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635068016_image.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635068016_image.png" alt=""/></noscript></figure>
<p>Now, when we refresh the page, the prior service worker is <em>still</em> running and loading the <em>prior</em> file. Then, the <em>new</em> service worker, with the <em>new</em> pre-cache manifest is downloaded and pre-cached.</p>
<figure class="wp-block-image"><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635183984_image.png" alt="A DevTools screenshot showing a table of pre-cached assets processed by the VitePWA plugin and Workbox." data-lazy-src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635183984_image.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://paper-attachments.dropbox.com/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635183984_image.png" alt="A DevTools screenshot showing a table of pre-cached assets processed by the VitePWA plugin and Workbox."/></noscript><figcaption>The new pre-cached manifest is displayed in the list of cached assets. Notice that both versions of our settings file are there (and both versions of a few other assets were affected as well): the old version, since that’s what’s still being run, and the new version, since the new service worker has pre-cached it.</figcaption></figure>
<p>Note the corollary here: our old content is still being served to the user since the old service worker is still running. The user is unable to see the change we just made, even if they refresh because the service worker, by default, guarantees any and all tabs with this web app are running the <em>same</em> version. If you want the browser to show the updated version, close your tab (and any other tabs with the site), and re-open it.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="2220" height="714" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=2220%2C714&#038;ssl=1" alt="The same DevTools screenshot of pre-cached assets, but now only displaying new assets instead of duplicates." class="wp-image-361016 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?w=2220&amp;ssl=1 2220w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=300%2C96&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1024%2C329&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=768%2C247&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1536%2C494&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=2048%2C659&amp;ssl=1 2048w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1000%2C322&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=2220%2C714&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="2220" height="714" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=2220%2C714&#038;ssl=1" alt="The same DevTools screenshot of pre-cached assets, but now only displaying new assets instead of duplicates." class="wp-image-361016" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?w=2220&amp;ssl=1 2220w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=300%2C96&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1024%2C329&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=768%2C247&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1536%2C494&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=2048%2C659&amp;ssl=1 2048w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637635407986_image.png?resize=1000%2C322&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>The cache should now only contain the new assets.</figcaption></figure>
<p>Workbox did all the legwork of making this all come out right! We did very little to get this going.</p>
<h3 id="a-better-way-to-update-content"><a href="#aa-a-better-way-to-update-content" aria-hidden="true" class="aal_anchor" id="aa-a-better-way-to-update-content"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A better way to update content</h3>
<p>It’s unlikely that you can get away with serving stale content to your users until they happen to close all their browser tabs. Fortunately, the VitePWA plugin offers a better way. The <a href="https://vite-plugin-pwa.netlify.app/guide/auto-update.html" rel="noopener"><code>registerSW</code> function</a> accepts an object with an <code>onNeedRefresh</code> method. This method is called whenever there’s a new service worker waiting to take over. <code>registerSW</code> also returns a function that you can call to reload the page, activating the new service worker in the process.</p>
<p>That’s a lot, so let’s see some code:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">if ("serviceWorker" in navigator) {
  // &amp;&amp; !/localhost/.test(window.location) &amp;&amp; !/lvh.me/.test(window.location)) {
  const updateSW = registerSW({
    onNeedRefresh() {
      Toastify({
        text: `&lt;h4 style='display: inline'>An update is available!&lt;/h4>
               &lt;br>&lt;br>
               &lt;a class='do-sw-update'>Click to update and reload&lt;/a>&nbsp;&nbsp;`,
        escapeMarkup: false,
        gravity: "bottom",
        onClick() {
          updateSW(true);
        }
      }).showToast();
    }
  });
}</code></pre>
<p>I’m using the <a href="https://www.npmjs.com/package/toastify-js" rel="noopener">toastify-js library</a> to show a toast UI component to let users know when a new version of the service worker is available and waiting. If the user clicks the toast, I call the function VitePWA gives me to reload the page, with the new service worker running.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="516" height="198" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?resize=516%2C198&#038;ssl=1" alt="A toast component screenshot with white text and a slight background gradient that goes from light blue on the left to bright blue on the right. It reads: an update is available! Click to update and reload." class="wp-image-361018 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?w=516&amp;ssl=1 516w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?resize=300%2C115&amp;ssl=1 300w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?resize=516%2C198&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="516" height="198" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?resize=516%2C198&#038;ssl=1" alt="A toast component screenshot with white text and a slight background gradient that goes from light blue on the left to bright blue on the right. It reads: an update is available! Click to update and reload." class="wp-image-361018" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?w=516&amp;ssl=1 516w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637636900295_image.png?resize=300%2C115&amp;ssl=1 300w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>Now when we have pending updates, a nice toast component pops up on the front end. Clicking it reloads the page with the new content in there.</figcaption></figure>
<p>One thing to remember here is that, after you deploy the code to show the toast, the toast component won’t show up the next time you load your site. That’s because the old service worker (the one before we added the toast component) is still running. That requires manually closing all tabs and re-opening the web app for the new service worker to take over. Then, the <em>next</em> time you update some code, the service worker should show the toast, prompting you to update.</p>
<p>Why doesn’t the service worker update when the page is refreshed? I mentioned earlier that refreshing the page does not update or activate the waiting service worker, so why does <em>this</em> work? Calling this method doesn’t only refresh the page, but it calls some low-level Service Worker APIs (in particular <code>skipWaiting</code>) as well, giving us the outcome we want.</p>
<h3 id="runtime-caching"><a href="#aa-runtime-caching" aria-hidden="true" class="aal_anchor" id="aa-runtime-caching"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Runtime caching</h3>
<p>We’ve seen the bundle pre-caching we get for free with VitePWA for our build assets. What about caching any other content we might request at runtime? Workbox supports this via its <code>runtimeCaching</code> feature.</p>
<p>Here’s how. The VitePWA plugin can take an object, one property of which is <code>workbox</code>, which takes Workbox properties.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const getCache = ({ name, pattern }: any) => ({
  urlPattern: pattern,
  handler: "CacheFirst" as const,
  options: {
    cacheName: name,
    expiration: {
      maxEntries: 500,
      maxAgeSeconds: 60 * 60 * 24 * 365 * 2 // 2 years
    },
    cacheableResponse: {
      statuses: [200]
    }
  }
});
// ...

  plugins: [
    VitePWA({
      workbox: {
        runtimeCaching: [
          getCache({ 
            pattern: /^https:\/\/s3.amazonaws.com\/my-library-cover-uploads/, 
            name: "local-images1" 
          }),
          getCache({ 
            pattern: /^https:\/\/my-library-cover-uploads.s3.amazonaws.com/, 
            name: "local-images2" 
          })
        ]
      }
    })
  ],
// ...</code></pre>
<p>I know, that’s a lot of code. But all it’s really doing is telling Workbox to cache anything it sees matching those URL patterns. <a href="https://developers.google.com/web/tools/workbox/reference-docs/latest/module-workbox-build#.RuntimeCachingEntry" rel="noopener">The docs</a> provide much more info if you want to get deep into specifics.</p>
<p>Now, after that update takes effect, we can see those resources being served by our service worker.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1578" height="170" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1578%2C170&#038;ssl=1" alt="DevTools screenshot showing the resources that are loaded by the browser. There are four jpeg images." class="wp-image-361021 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?w=1578&amp;ssl=1 1578w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=300%2C32&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1024%2C110&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=768%2C83&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1536%2C165&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1000%2C108&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1578%2C170&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1578" height="170" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1578%2C170&#038;ssl=1" alt="DevTools screenshot showing the resources that are loaded by the browser. There are four jpeg images." class="wp-image-361021" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?w=1578&amp;ssl=1 1578w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=300%2C32&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1024%2C110&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=768%2C83&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1536%2C165&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637637974120_image.png?resize=1000%2C108&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>And we can see the corresponding cache that was created.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1702" height="586" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1702%2C586&#038;ssl=1" alt="DevTools screenshot showing the new cache instance that is stored in Cache Storage. It includes all of the cached images." class="wp-image-361023 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?w=1702&amp;ssl=1 1702w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=300%2C103&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1024%2C353&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=768%2C264&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1536%2C529&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1000%2C344&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1702%2C586&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1702" height="586" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1702%2C586&#038;ssl=1" alt="DevTools screenshot showing the new cache instance that is stored in Cache Storage. It includes all of the cached images." class="wp-image-361023" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?w=1702&amp;ssl=1 1702w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=300%2C103&amp;ssl=1 300w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1024%2C353&amp;ssl=1 1024w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=768%2C264&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1536%2C529&amp;ssl=1 1536w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/s_3C8A95FDBE22C735794597C555C00971224DE1D0D940961AF7164CACA28CF6E5_1637638053731_image.png?resize=1000%2C344&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<h3 id="adding-your-own-service-worker-content"><a href="#aa-adding-your-own-service-worker-content" aria-hidden="true" class="aal_anchor" id="aa-adding-your-own-service-worker-content"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding your own service worker content</h3>
<p>Let’s say you want to get advanced with your service worker. You want to add some code to sync data with IndexedDB, add fetch handlers, and respond with IndexedDB data when the user is offline (again, <a href="https://css-tricks.com/making-web-app-work-offline-part-2-implementation/">my prior post</a> walks through the ins and outs of IndexedDB). But how do you put your own code into the service worker that Vite creates for us?</p>
<p>There’s another Workbox option we can use for this: <code>importScripts</code>.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">VitePWA({
  workbox: {
    importScripts: ["sw-code.js"],</code></pre>
<p>Here, the service worker will request <code>sw-code.js</code> at runtime. In that case, make sure there’s an <code>sw-code.js</code> file that can be served by your application. The easiest way to achieve that is to put it in the <code>public</code> folder (see the <a href="https://vitejs.dev/config/#publicdir" rel="noopener">Vite docs</a> for detailed instructions).</p>
<p>If this file starts to grow to a size such that you need to break things up with JavaScript imports, make sure you bundle it to prevent your service worker from trying to execute import statements (which it may or may not be able to do). You can create a separate Vite build instead.</p>
<h3 id="wrapping-up"><a href="#aa-wrapping-up" aria-hidden="true" class="aal_anchor" id="aa-wrapping-up"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrapping up</h3>
<p>At the end of 2021, CSS-Tricks asked a bunch of front-end folks what one thing someone cans do to make their website better. <a href="https://css-tricks.com/add-a-service-worker-to-your-site/">Chris Ferdinandi suggested a service worker.</a> Well, that’s exactly what we accomplished in this article and it was relatively simple, wasn’t it? That’s thanks to the VitePWA with hat tips to Workbox and the Cache API.</p>
<p>Service workers that leverage the Cache API are capable of greatly improving the perf of your web app. And while it might seem a little scary or confusing at first, it’s nice to know we have tools like the VitePWA plugin to simplify things a great deal. Install the plugin and let it do the heavy lifting. Sure, there are more advanced things that a service worker can do, and VitePWA can be used for more complex functionality, but an offline site is a fantastic starting point!</p>
</div>
</article>
</main>
<div class="entry-unrelated sidebar">
<div id="all-modules">
<div id="scroll-ad-position"></div>
<div id="sticky-sidebar-stuff">
<div class="fem-conditional-message">
<div class="fem-ad fem-sidebar-ad">
<div class="fem-header">
<div class="fem-header-inner">
<div class="fem-learning-partner">
Our Learning Partner
</div>
<a href="https://frontendmasters.com/courses/service-workers/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar"><img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1578251803/FEM-sidebar-Generic_dipjef.png" alt="Frontend Masters logo" class="fem-logo" /></a>
<div class="fem-title">
Frontend Masters
</div>
</div>
</div>
<div class="fem-message">
<h4>Wanna really learn about Service Workers?</h4>
<p>Service Workers are extremely powerful. They are the one technology that can make websites work offline, for example, and have true control over cache. But there is a lot to learn. Fortunately, <a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Frontend Masters</a> has <a href="https://frontendmasters.com/courses/service-workers/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">a great course</a> all about them.</p>
</div>
</div>
</div> </div>
</div>
</div>
</div>
<div class="related-ads-comments-wrap">
<div class="related-ads-comments">
<div class="end-of-article-ads">
<div class="bsap-doubles side-by-side">
<div id="bsap_1250418" class="bsarocks bsap_3469a2a501a9e18091036aa0c89f9dcb"></div>
</div>
<div class="fem-conditional-message">
<div class="fem-ad fem-footer-ad">
<div class="fem-header">
<div class="fem-header-inner">
<a href="https://frontendmasters.com/courses/service-workers/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar"><img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1578251803/FEM-footer-Generic_fgvhuc.png" alt="Frontend Masters logo" class="fem-logo-large" /></a>
</div>
</div>
<div class="fem-message">
<div>
<h4>Wanna really learn about Service Workers?</h4>
<p>Service Workers are extremely powerful. They are the one technology that can make websites work offline, for example, and have true control over cache. But there is a lot to learn. Fortunately, <a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Frontend Masters</a> has <a href="https://frontendmasters.com/courses/service-workers/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">a great course</a> all about them.</p>
</div>
</div>
</div>
</div>
</div>
<section class="respond-area">
<div class="respond">
<div class="comment-form-form-area">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/vitepwa-plugin-offline-service-worker/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://css-tricks.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="_mc4wp_subscribe_wp-comment-form" value="0" /><p class=" mc4wp-checkbox mc4wp-checkbox-wp-comment-form"><label><input type="checkbox" name="_mc4wp_subscribe_wp-comment-form" value="1" checked="checked" /><span>Get the CSS-Tricks newsletter</span></label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='361001' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9845d4eafe" /></p> <p class="antispam-group antispam-group-q" style="clear: both;">
<label>Copy and paste this code: <strong class="antspmpro-input-a">micuno</strong> <span class="required">*</span></label>
<input type="hidden" name="antspmpro-a" class="antispam-control antispam-control-a" value="micuno" />
<input type="text" name="antspmpro-q-luwele" class="antispam-control antispam-control-q" value="4.1" />
</p>
<p class="antispam-group antispam-group-e" style="display: none;">
<label>Leave this field empty</label>
<input type="text" name="antspmpro-e-email-url-website-luwele" class="antispam-control antispam-control-e" value="" />
</p>
<p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="87" /></p></form> </div>
</div>
</div>
</section> <div class="related-posts">
<div id='jp-relatedposts' class='jp-relatedposts'>
</div> <div class="jetpack-sponsored-posts-message">
<img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1590422774/jetpack-logo_cegyqg.svg" alt="Jetpack Logo">
<p>The related posts above were algorithmically generated and displayed here without any load on our servers at all, <a href="https://jetpack.com/support/related-posts/?aff=8638">thanks to Jetpack</a>.</p>
</div>
</div> </div>
</div>
</div>
<footer class="site-footer">
<svg class="icon-logo-star" width="35px" height="35px" viewBox="0 0 362.62 388.52" data-spin-me="false">
<path d="M156.58,239l-88.3,64.75c-10.59,7.06-18.84,11.77-29.43,11.77-21.19,0-38.85-18.84-38.85-40C0,257.83,14.13,244.88,27.08,239l103.6-44.74L27.08,148.34C13,142.46,0,129.51,0,111.85,0,90.66,18.84,73,40,73c10.6,0,17.66,3.53,28.25,11.77l88.3,64.75L144.81,44.74C141.28,20,157.76,0,181.31,0s40,18.84,36.5,43.56L206,149.52l88.3-64.75C304.93,76.53,313.17,73,323.77,73a39.2,39.2,0,0,1,38.85,38.85c0,18.84-12.95,30.61-27.08,36.5L231.93,194.26,335.54,239c14.13,5.88,27.08,18.83,27.08,37.67,0,21.19-18.84,38.85-40,38.85-9.42,0-17.66-4.71-28.26-11.77L206,239l11.77,104.78c3.53,24.72-12.95,44.74-36.5,44.74s-40-18.84-36.5-43.56Z" />
</svg>
<div class="footer-inside">
<div class="footer-message-and-form">
<p class="colophon">
CSS-Tricks is created by <a href="https://chriscoyier.net">Chris</a> and a <a href="/about">team</a> of swell&nbsp;people.
</p>
<div class="footer-form-wrap">
<form action="https://chriscoyier.us2.list-manage.com/subscribe/post?u=155f5a9ccc4e24c318130cace&amp;id=197f127a68" method="post" id="mc-embedded-subscribe-form">
<h4>Keep up to date on web dev</h4>
<p>with our hand-crafted weekly newsletter</p>
<div class="footer-form">
<label for="mce-EMAIL" class="screen-reader">Email Address</label>
<input type="email" name="EMAIL" class="required email mailchimp-email-input" id="mce-EMAIL" placeholder="smart@cookie.com" required="">
<input type="submit" value="Subscribe" name="Subscribe" id="mc-embedded-subscribe" class="button subscribe-button">
</div>
</form>
</div> </div>
<div class="link-grid">
<div>
<div>
<h5>
Tech
</h5>
<ul>
<li><a href="https://wordpress.org/">WordPress</a> <span>(CMS)</span></li>
<li><a href="/jetpack/">Jetpack</a> <span>(Search, Backup)</span></li>
<li><a href="https://woocommerce.com/?aff=8638">WooCommerce</a> <span>(eCommerce)</span></li>
<li><a href="https://localwp.com/">Local</a> <span>(Development)</span></li>
</ul>
</div>
<div>
<h5>Hosting</h5>
<ul>
<li><a href="https://share.getf.ly/k96n2f">Flywheel</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Family</h5>
<ul>
<li><a href="https://codepen.io/">CodePen</a></li>
<li><a href="https://shoptalkshow.com/">ShopTalk Show</a></li>
</ul>
</div>
<div>
<h5>Minisites</h5>
<ul>
<li><a href="https://serverless.css-tricks.com/">The Power of Serverless</a></li>
<li><a href="https://conferences.css-tricks.com/">Upcoming Conferences</a></li>
<li><a href="https://coding-fonts.css-tricks.com/">Coding Fonts</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Contact</h5>
<ul>
<li><a href="/cdn-cgi/l/email-protection#4a3e2f2b270a293939673e382329213964292527">Email</a></li>
<li><a href="https://www.notion.so/csstricks/Sponsorship-Possibilities-cb5b33a3f6f64c239220547fe7965d78">Sponsorship Info</a></li>
<li><a href="/guest-writing-for-css-tricks/">Guest Writing</a></li>
</ul>
</div>
<div>
<h5>Buy</h5>
<ul>
<li><a href="/shop/">Posters & Swag</a></li>
<li><a href="/product/mvp-supporter/">Membership</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Follow</h5>
<ul>
<li><a href="https://twitter.com/css">Twitter</a></li>
<li><a href="https://www.instagram.com/real_css_tricks/">Instagram</a></li>
<li><a href="https://www.youtube.com/user/realcsstricks">YouTube</a></li>
<li><a href="https://codepen.io/team/css-tricks">CodePen</a></li>
<li><a href="https://github.com/CSS-Tricks">GitHub</a></li>
<li><a href="https://podcasts.apple.com/us/podcast/css-tricks-screencasts/id273881728">iTunes</a></li>
<li><a href="/feed/">RSS</a></li>
</ul>
</div>
</div>
</div>
</div>
<a href="#top-of-site" class="top-of-site-link" data-visible="false">
<span class="screen-reader-text">Back to Top</span>
<svg width="32" height="32" viewBox="0 0 100 100">
<path fill="white" d="m50 0c-13.262 0-25.98 5.2695-35.355 14.645s-14.645 22.094-14.645 35.355 5.2695 25.98 14.645 35.355 22.094 14.645 35.355 14.645 25.98-5.2695 35.355-14.645 14.645-22.094 14.645-35.355-5.2695-25.98-14.645-35.355-22.094-14.645-35.355-14.645zm20.832 62.5-20.832-22.457-20.625 22.457c-1.207 0.74219-2.7656 0.57812-3.7891-0.39844-1.0273-0.98047-1.2695-2.5273-0.58594-3.7695l22.918-25c0.60156-0.61328 1.4297-0.96094 2.2891-0.96094 0.86328 0 1.6914 0.34766 2.293 0.96094l22.918 25c0.88672 1.2891 0.6875 3.0352-0.47266 4.0898-1.1562 1.0508-2.9141 1.0859-4.1133 0.078125z" />
</svg>
</a>
</footer>
<div class="jetpack-instant-search__widget-area" style="display: none">
<div id="media_image-3" class="widget widget_media_image"><a href="https://jetpack.com/upgrade/search/?aff=8638"><img width="600" height="444" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?fit=600%2C444&amp;ssl=1" class="image wp-image-321694  attachment-full size-full jetpack-lazy-image" alt="" loading="lazy" style="max-width: 100%; height: auto;" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?w=600&amp;ssl=1 600w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?resize=300%2C222&amp;ssl=1 300w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?fit=600%2C444&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" /></a></div><div id="jetpack-search-filters-5" class="widget jetpack-filters widget_search"> <div id="jetpack-search-filters-5-wrapper" class="jetpack-instant-search-wrapper">
</div></div> </div>

<svg width="0" height="0" class="screen-reader">
<defs>
<linearGradient id="orange-to-pink" x1="0" x2="1" y1="0" y2="1">
<stop offset="0%" stop-color="#ff7a18" />
<stop offset="40%" stop-color="#af002d" />
<stop offset="100%" stop-color="#319197" />
</linearGradient>
<filter id="duotone_orange_pink">
<feColorMatrix type="matrix" result="grayscale" values="1 0 0 0 0
                  1 0 0 0 0
                  1 0 0 0 0
                  0 0 0 1 0">
</feColorMatrix>
<feComponentTransfer color-interpolation-filters="sRGB" result="duotone">
<feFuncR type="table" tableValues="0.7411764706 0.9882352941"></feFuncR>
<feFuncG type="table" tableValues="0.0431372549 0.7333333333"></feFuncG>
<feFuncB type="table" tableValues="0.568627451 0.05098039216"></feFuncB>
<feFuncA type="table" tableValues="0 1"></feFuncA>
</feComponentTransfer>
</filter>
</defs>
</svg>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="application/ld+json" class="rank-math-schema-pro">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://css-tricks.com/#organization","name":"CSS-Tricks","logo":{"@type":"ImageObject","@id":"https://css-tricks.com/#logo","url":"https://css-tricks.com/wp-content/uploads/2019/06/akqRGyta_400x400.jpg","caption":"CSS-Tricks","inLanguage":"en-US"}},{"@type":"WebSite","@id":"https://css-tricks.com/#website","url":"https://css-tricks.com","name":"CSS-Tricks","publisher":{"@id":"https://css-tricks.com/#organization"},"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/website-offline-pwa.jpg?fit=1200%2C600&amp;ssl=1","url":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/website-offline-pwa.jpg?fit=1200%2C600&amp;ssl=1","width":"1200","height":"600","inLanguage":"en-US"},{"@type":"Person","@id":"https://css-tricks.com/author/adam-rackis/","name":"Adam Rackis","url":"https://css-tricks.com/author/adam-rackis/","image":{"@type":"ImageObject","@id":"https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=96&amp;d=retro&amp;r=pg","url":"https://secure.gravatar.com/avatar/d4b0907c0d98a2394568d9bf9e8814c3?s=96&amp;d=retro&amp;r=pg","caption":"Adam Rackis","inLanguage":"en-US"},"sameAs":["https://adamrackis.dev","https://twitter.com/AdamRackis"],"worksFor":{"@id":"https://css-tricks.com/#organization"}},{"@type":"WebPage","@id":"https://css-tricks.com/vitepwa-plugin-offline-service-worker/#webpage","url":"https://css-tricks.com/vitepwa-plugin-offline-service-worker/","name":"Using the VitePWA Plugin for an Offline Site | CSS-Tricks","datePublished":"2022-01-18T06:30:26-08:00","dateModified":"2022-01-18T06:30:29-08:00","author":{"@id":"https://css-tricks.com/author/adam-rackis/"},"isPartOf":{"@id":"https://css-tricks.com/#website"},"primaryImageOfPage":{"@id":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/website-offline-pwa.jpg?fit=1200%2C600&amp;ssl=1"},"inLanguage":"en-US"},{"@type":"BlogPosting","headline":"Using the VitePWA Plugin for an Offline Site | CSS-Tricks","keywords":"VitePWA plugin,VitePWA","datePublished":"2022-01-18T06:30:26-08:00","dateModified":"2022-01-18T06:30:29-08:00","author":{"@id":"https://css-tricks.com/author/adam-rackis/"},"publisher":{"@id":"https://css-tricks.com/#organization"},"description":"The VitePWA plugin adds a service worker that handles offline support, caching assets, and prompting users when new content is available.","name":"Using the VitePWA Plugin for an Offline Site | CSS-Tricks","@id":"https://css-tricks.com/vitepwa-plugin-offline-service-worker/#richSnippet","isPartOf":{"@id":"https://css-tricks.com/vitepwa-plugin-offline-service-worker/#webpage"},"image":{"@id":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2022/01/website-offline-pwa.jpg?fit=1200%2C600&amp;ssl=1"},"inLanguage":"en-US","mainEntityOfPage":{"@id":"https://css-tricks.com/vitepwa-plugin-offline-service-worker/#webpage"}}]}</script><script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script><script src='https://c0.wp.com/p/jetpack/10.5/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script><script src='https://c0.wp.com/c/5.8.3/wp-includes/js/dist/vendor/regenerator-runtime.min.js' id='regenerator-runtime-js'></script><script src='https://c0.wp.com/c/5.8.3/wp-includes/js/dist/vendor/wp-polyfill.min.js' id='wp-polyfill-js'></script><script src='https://c0.wp.com/c/5.8.3/wp-includes/js/dist/hooks.min.js' id='wp-hooks-js'></script><script src='https://c0.wp.com/c/5.8.3/wp-includes/js/dist/i18n.min.js' id='wp-i18n-js'></script><script id='wp-i18n-js-after'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script><script type='text/javascript' id='wp-jp-i18n-state-js-before'>
console.warn( "Failed to determine languages base URL. Is WP_LANG_DIR in the WordPress root?" );
</script><script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script><script defer data-domain="css-tricks.com" data-api="/plausible-proxy/api/event" src="/plausible-proxy/js/script.js"></script><script>
  var articleYear = 2022;
  var articleAuthor = "250838";
  var articleType = "post";
</script><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script><script>window.addEventListener('load', function() {
				document.querySelectorAll('link').forEach(function(e) {'not all' === e.media && e.dataset.media && (e.media=e.dataset.media,delete e.dataset.media)});
				var e = document.getElementById('jetpack-boost-critical-css');
				e && (e.media = 'not all');
			});</script><script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script><script src='https://c0.wp.com/p/jetpack/10.5/_inc/build/photon/photon.min.js' id='jetpack-photon-js'></script><script src='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/jquery-3.5.1.min.js' id='jquery-js'></script><script type='text/javascript' id='antispampro-script-js-extra'>
/* <![CDATA[ */
var antispampro_vars = {"code":"micuno","input_name_suffix":"luwele"};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/anti-spam-pro/js/anti-spam-pro-4.1.js' id='antispampro-script-js'></script><script type='text/javascript' id='jetpack-live-comment-markdown-js-extra'>
/* <![CDATA[ */
var markdownify = {"ajax_url":"\/wp-admin\/admin-ajax.php","nonce":"ac78ef88f7"};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack-markdown-live-preview-comments/js/markdownify.js?ver=1' id='jetpack-live-comment-markdown-js'></script><script id='jetpack-instant-search-js-translations'>
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "jetpack", { "locale_data": { "messages": { "": {} } } } );
</script><script id='jetpack-instant-search-js-before'>
var JetpackInstantSearchOptions=JSON.parse(decodeURIComponent("%7B%22overlayOptions%22%3A%7B%22colorTheme%22%3A%22dark%22%2C%22enableInfScroll%22%3Afalse%2C%22enableSort%22%3Atrue%2C%22highlightColor%22%3A%22%23f4af38%22%2C%22overlayTrigger%22%3A%22results%22%2C%22resultFormat%22%3A%22expanded%22%2C%22showPoweredBy%22%3Atrue%2C%22defaultSort%22%3A%22relevance%22%2C%22excludedPostTypes%22%3A%5B%22attachment%22%2C%22screenshot%22%5D%7D%2C%22homeUrl%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%22%2C%22locale%22%3A%22en-US%22%2C%22postsPerPage%22%3A11%2C%22siteId%22%3A45537868%2C%22postTypes%22%3A%7B%22post%22%3A%7B%22singular_name%22%3A%22Post%22%2C%22name%22%3A%22Posts%22%7D%2C%22page%22%3A%7B%22singular_name%22%3A%22Page%22%2C%22name%22%3A%22Pages%22%7D%2C%22attachment%22%3A%7B%22singular_name%22%3A%22Media%22%2C%22name%22%3A%22Media%22%7D%2C%22product%22%3A%7B%22singular_name%22%3A%22Product%22%2C%22name%22%3A%22Products%22%7D%2C%22screenshot%22%3A%7B%22singular_name%22%3A%22Screenshot%22%2C%22name%22%3A%22Screenshots%22%7D%2C%22guides%22%3A%7B%22singular_name%22%3A%22Guide%22%2C%22name%22%3A%22Guides%22%7D%2C%22newsletters%22%3A%7B%22singular_name%22%3A%22Newsletter%22%2C%22name%22%3A%22Newsletters%22%7D%2C%22chapters%22%3A%7B%22singular_name%22%3A%22Chapter%22%2C%22name%22%3A%22Chapters%22%7D%7D%2C%22webpackPublicPath%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%5C%2Fwp-content%5C%2Fplugins%5C%2Fjetpack%5C%2F_inc%5C%2Fbuild%5C%2Finstant-search%5C%2F%22%2C%22isPhotonEnabled%22%3Atrue%2C%22apiRoot%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%5C%2Fwp-json%5C%2F%22%2C%22apiNonce%22%3A%22ca1f6e390e%22%2C%22isPrivateSite%22%3Afalse%2C%22isWpcom%22%3Afalse%2C%22hasOverlayWidgets%22%3Atrue%2C%22widgets%22%3A%5B%7B%22filters%22%3A%5B%7B%22name%22%3A%22Post%20Types%22%2C%22type%22%3A%22post_type%22%2C%22count%22%3A5%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22post_type_0%22%7D%2C%7B%22name%22%3A%22Year%22%2C%22type%22%3A%22date_histogram%22%2C%22count%22%3A1%2C%22field%22%3A%22post_date%22%2C%22interval%22%3A%22year%22%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22date_histogram_1%22%7D%2C%7B%22name%22%3A%22Tags%22%2C%22type%22%3A%22taxonomy%22%2C%22taxonomy%22%3A%22post_tag%22%2C%22count%22%3A5%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22taxonomy_2%22%7D%5D%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%7D%5D%2C%22widgetsOutsideOverlay%22%3A%5B%5D%2C%22hasNonSearchWidgets%22%3Atrue%2C%22adminQueryFilter%22%3A%7B%22bool%22%3A%7B%22should%22%3A%5B%7B%22term%22%3A%7B%22post_type%22%3A%22post%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22page%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22newsletters%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22chapters%22%7D%7D%5D%7D%7D%7D"));
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack/_inc/build/instant-search/jp-search-main.js?minify=false&#038;ver=d06c48532583ce5d0adee59db35f7ddf' id='jetpack-instant-search-js'></script><script src='//stats.wp.com/w.js?ver=202203' id='jp-tracks-js'></script><script src='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/comment-reply.min.js?ver=1.1' id='my-comment-reply-js'></script><script src='https://css-tricks.com/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-lazy-images/dist/intersection-observer.js?minify=false&#038;ver=6ae6d91d4b64fe31e32c2797e7c3dd42' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script><script type='text/javascript' id='jetpack-lazy-images-js-extra'>
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-lazy-images/dist/lazy-images.js?minify=false&#038;ver=22d8bb42bcd6edc9c8ef53eb9b087d17' id='jetpack-lazy-images-js'></script><script type="text/javascript">
jQuery(function($) { 

			$( '.add_to_cart_button:not(.product_type_variable, .product_type_grouped)' ).on( 'click', function() {
				gtag( 'event', 'add_to_cart', { 'event_category': 'ecommerce', 'event_label': ($(this).data('product_sku')) ? ($(this).data('product_sku')) : ('#' + $(this).data('product_id')), 'items': [ {'id': ($(this).data('product_sku')) ? ($(this).data('product_sku')) : ('#' + $(this).data('product_id')),'quantity': $(this).data('quantity')} ] } );
			});
		
 });
</script><script src='https://stats.wp.com/e-202203.js' defer></script><script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.5',blog:'45537868',post:'361001',tz:'-8',srv:'css-tricks.com'} ]);
	_stq.push([ 'clickTrackerInit', '45537868', '361001' ]);
</script><script>
    window.activeMember = false;
  </script><script src="https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/global-concat.min.js?cache_bust=1636061739380"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-68528-29', 'auto');

  if (typeof articleYear !== "undefined") {
    ga('set', 'dimension1', articleYear);
  }
  if (typeof articleAuthor !== "undefined") {
    ga('set', 'dimension2', articleAuthor);
  }
  if (typeof articleType !== "undefined") {
    ga('set', 'dimension3', articleType);
  }

  ga('send', 'pageview');
</script><script async src="https://static.codepen.io/assets/embed/ei.js"></script><script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon='{"rayId":"6cfbf2b6482081c7","token":"2863ac31b15c48f5b94bd8b0c38aba94","version":"2021.12.0","si":100}' crossorigin="anonymous"></script>
</body>
</html>