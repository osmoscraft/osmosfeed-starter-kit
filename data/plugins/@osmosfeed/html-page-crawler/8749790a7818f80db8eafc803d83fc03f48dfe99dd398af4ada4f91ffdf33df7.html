

<!doctype html>
<html lang="en-US">
<head data-template-path="https://hacks.mozilla.org/wp-content/themes/Hax">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="w2ocEMd5yV9IsGCjhq-7ls67r4VH-Ob6oWdiZpqjN8U">

  
  <meta name="title" content="Improving Firefox stability on Linux – Mozilla Hacks - the Web developer blog">

    <meta property="og:site_name" content="Mozilla Hacks &#8211; the Web developer blog">
  <meta property="og:url" content="https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux">
  <meta property="og:title" content="Improving Firefox stability on Linux – Mozilla Hacks - the Web developer blog">
  <meta property="og:description" content="A year ago at Mozilla we started to improve Firefox stability on Linux. This effort quickly became an example of good synergies between FOSS.">
  <meta property="og:image" content="https://hacks.mozilla.org/files/2021/04/image2.png">
  <meta property="og:image:width" content="893">
  <meta property="og:image:height" content="812">

    <meta property="twitter:title" content="Improving Firefox stability on Linux – Mozilla Hacks - the Web developer blog">
  <meta property="twitter:description" content="A year ago at Mozilla we started to improve Firefox stability on Linux. This effort quickly became an example of good synergies between FOSS.">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="https://hacks.mozilla.org/files/2021/04/image2.png">
  <meta name="twitter:site" content="@mozhacks">

  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/style.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/8.6.0/styles/solarized_light.min.css">

  <script type="text/javascript">
    window.hacks = {};
    // http://cfsimplicity.com/61/removing-analytics-clutter-from-campaign-urls
    var removeUtms  =   function(){
        var l = window.location;
        if( l.hash.indexOf( "utm" ) != -1 ){
            var anchor = l.hash.match(/#(?!utm)[^&]+/);
            anchor  =   anchor? anchor[0]: '';
            if(!anchor && window.history.replaceState){
                history.replaceState({},'', l.pathname + l.search);
            } else {
                l.hash = anchor;
            }
        };
    };

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35433268-8'],
              ['_setAllowAnchor', true]);
    _gaq.push (['_gat._anonymizeIp']);
    _gaq.push(['_trackPageview']);
    _gaq.push( removeUtms );
    (function(d, k) {
      var ga = d.createElement(k); ga.type = 'text/javascript'; ga.async = true;
      ga.src = 'https://ssl.google-analytics.com/ga.js';
      var s = d.getElementsByTagName(k)[0]; s.parentNode.insertBefore(ga, s);
    })(document, 'script');
  </script>

  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<meta name="blog-name" content="Mozilla Hacks - the Web developer blog" />
<link rel="alternate" hreflang="en" href="https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/" />
<link rel="alternate" hreflang="x-default" href="https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/" />

	<!-- This site is optimized with the Yoast SEO plugin v17.5 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Improving Firefox stability on Linux - Mozilla Hacks - the Web developer blog</title>
	<meta name="description" content="A year ago at Mozilla we started to improve Firefox stability on Linux. This effort quickly became an example of good synergies between FOSS." />
	<link rel="canonical" href="https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Gabriele Svelto" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="7 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://hacks.mozilla.org/#website","url":"https://hacks.mozilla.org/","name":"Mozilla Hacks - the Web developer blog","description":"hacks.mozilla.org","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://hacks.mozilla.org/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/#primaryimage","inLanguage":"en-US","url":"https://hacks.mozilla.org/files/2021/04/image2.png","contentUrl":"https://hacks.mozilla.org/files/2021/04/image2.png","width":893,"height":812,"caption":"A screenshot of a tab that justc crashed"},{"@type":"WebPage","@id":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/#webpage","url":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/","name":"Improving Firefox stability on Linux - Mozilla Hacks - the Web developer blog","isPartOf":{"@id":"https://hacks.mozilla.org/#website"},"primaryImageOfPage":{"@id":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/#primaryimage"},"datePublished":"2021-05-19T14:28:53+00:00","dateModified":"2021-05-20T08:27:26+00:00","author":{"@id":"https://hacks.mozilla.org/#/schema/person/620507e97c1c85ba7ec57db52e409ff0"},"description":"A year ago at Mozilla we started to improve Firefox stability on Linux. This effort quickly became an example of good synergies between FOSS.","breadcrumb":{"@id":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/"]}]},{"@type":"BreadcrumbList","@id":"https://hacks.mozilla.org/2021/05/improving-firefox-stability-on-linux/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://hacks.mozilla.org/"},{"@type":"ListItem","position":2,"name":"Articles","item":"https://hacks.mozilla.org/articles/"},{"@type":"ListItem","position":3,"name":"Improving Firefox stability on Linux"}]},{"@type":"Person","@id":"https://hacks.mozilla.org/#/schema/person/620507e97c1c85ba7ec57db52e409ff0","name":"Gabriele Svelto","image":{"@type":"ImageObject","@id":"https://hacks.mozilla.org/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?s=96&d=mm&r=g","caption":"Gabriele Svelto"},"url":"https://hacks.mozilla.org/author/gsveltomozilla-com/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//blog.mozilla.org' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Mozilla Hacks - the Web developer blog &raquo; Feed" href="https://hacks.mozilla.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Mozilla Hacks - the Web developer blog &raquo; Comments Feed" href="https://hacks.mozilla.org/comments/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/css/dist/block-library/style.min.css?ver=5.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=5.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.mozilla.org/hacks/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' type='text/css' media='all' />
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/js/analytics.js?ver=5.8.2' id='analytics-js'></script>
<link rel="https://api.w.org/" href="https://hacks.mozilla.org/wp-json/" /><link rel="alternate" type="application/json" href="https://hacks.mozilla.org/wp-json/wp/v2/posts/47175" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://hacks.mozilla.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://hacks.mozilla.org/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://hacks.mozilla.org/?p=47175' />
<link rel="alternate" type="application/json+oembed" href="https://hacks.mozilla.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhacks.mozilla.org%2F2021%2F05%2Fimproving-firefox-stability-on-linux%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://hacks.mozilla.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhacks.mozilla.org%2F2021%2F05%2Fimproving-firefox-stability-on-linux%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.5.1 stt:59,61,1,2;" />
<link rel="shortcut icon" type="image/x-icon" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/favicon.ico" /><style>#wpadminbar #wp-admin-bar-site-name>.ab-item:before { content: none !important;}li#wp-admin-bar-site-name a { background: url( "https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/favicon.ico" ) left center/20px no-repeat !important; padding-left: 21px !important; background-size: 20px !important; } li#wp-admin-bar-site-name { margin-left: 5px !important; } li#wp-admin-bar-site-name {} #wp-admin-bar-site-name div a { background: none !important; }
</style></head>
<body>
  <div class="outer-wrapper">
    <header class="section section--fullwidth header">
      <div class="masthead row">
        <div class="branding block block--3">
          <h1>
            <a href="https://hacks.mozilla.org">
              <img class="branding__logo" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/mdn-logo-mono.svg">
              <img class="branding__wordmark" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/wordmark.svg" alt="Mozilla">
              <span class="branding__title">Hac<span class="logo-askew">k</span>s</span>
            </a>
          </h1>
        </div>
        <div class="search block block--2">
          <form class="search__form" method="get" action="https://hacks.mozilla.org/">
            <input type="search" name="s" class="search__input" placeholder="Search Mozilla Hacks" value="">
            <i class="fa fa-search search__badge"></i>
          </form>
        </div>
        <nav class="social">
          <a class="social__link youtube" href="http://www.youtube.com/user/mozhacks" title="YouTube"><i class="fa fa-youtube" aria-hidden="true"></i><span>Hacks on YouTube</span></a>
          <a class="social__link twitter" href="https://twitter.com/mozhacks" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i><span>@mozhacks on Twitter</span></a>
          <a class="social__link rss" href="https://hacks.mozilla.org/feed/" title="RSS Feed"><i class="fa fa-rss" aria-hidden="true"></i><span>Hacks RSS Feed</span></a>
          <a class="fx-button" href="https://www.mozilla.org/firefox/download/thanks/?utm_source=hacks.mozilla.org&utm_medium=referral&utm_campaign=header-download-button&utm_content=header-download-button">Download Firefox</a>
        </nav>
      </div>
    </header>

  
<div id="content-head" class="section">
  <h1 class="post__title">Improving Firefox stability on Linux</h1>
  <div class="byline">
    <h3 class="post__author">
                      <img alt='' src='https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?s=64&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?s=128&#038;d=mm&#038;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' loading='lazy'/>        By
                                        <a class="url" href="https://hacks.mozilla.org/author/gsveltomozilla-com/">Gabriele Svelto</a>                            </h2>
    <div class="post__meta">
      Posted on
      <abbr class="published" title="2021-05-19T07:28:53-07:00">
        May 19, 2021      </abbr>
      <span class="entry-cat">in
        <a href="https://hacks.mozilla.org/category/featured/" rel="category tag" title="View all posts in Featured Article" >Featured Article</a>, <a href="https://hacks.mozilla.org/category/firefox/" rel="category tag" title="View all posts in Firefox" >Firefox</a>,  and <a href="https://hacks.mozilla.org/category/mozilla/" rel="category tag" title="View all posts in Mozilla" >Mozilla</a>      </span>
            <div class="socialshare" data-type="bubbles"></div>
    </div>
  </div>
</div>

<main id="content-main" class="section article">
  <article class="post" role="article">
    <p>Roughly a year ago at Mozilla we started an effort to improve Firefox stability on Linux. This effort quickly became an example of good synergies between FOSS projects.</p>
<p>Every time Firefox crashes, the user can send us a crash report which we use to analyze the problem and hopefully fix it:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47180" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image2.png" alt="A screenshot of a tab that justc crashed" width="893" height="812" srcset="https://hacks.mozilla.org/files/2021/04/image2.png 893w, https://hacks.mozilla.org/files/2021/04/image2-250x227.png 250w, https://hacks.mozilla.org/files/2021/04/image2-500x455.png 500w, https://hacks.mozilla.org/files/2021/04/image2-768x698.png 768w" sizes="(max-width: 893px) 100vw, 893px" /></p>
<p>This report contains, among other things, a minidump: a small snapshot of the process memory at the time it crashed. This includes the contents of the processor&#8217;s registers as well as data from the stacks of every thread.</p>
<p>Here’s what this usually looks like:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47188" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image4.png" alt="" width="1253" height="596" srcset="https://hacks.mozilla.org/files/2021/04/image4.png 1253w, https://hacks.mozilla.org/files/2021/04/image4-250x119.png 250w, https://hacks.mozilla.org/files/2021/04/image4-500x238.png 500w, https://hacks.mozilla.org/files/2021/04/image4-768x365.png 768w" sizes="(max-width: 1253px) 100vw, 1253px" /></p>
<p>If you&#8217;re familiar with core dumps, then minidumps are essentially a smaller version of them. The minidump format was originally designed at Microsoft and Windows has a native way of writing out minidumps. On Linux, we use Breakpad for this task. Breakpad originated at Google for their software (Picasa, Google Earth, etc&#8230;) but we have forked, heavily modified for our purposes and recently partly rewrote it in Rust.</p>
<p>Once the user submits a crash report, we have a server-side component &#8211; called Socorro &#8211; that processes it and extracts a stack trace from the minidump. The reports are then clustered based on the top method name of the stack trace of the crashing thread. When a new crash is spotted we assign it a bug and start working on it. See the picture below for an example of how crashes are grouped:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47184" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image3.png" alt="The snapshot of a stack trace as displayed on crash-stats.mozilla.com" width="1827" height="250" srcset="https://hacks.mozilla.org/files/2021/04/image3.png 1827w, https://hacks.mozilla.org/files/2021/04/image3-250x34.png 250w, https://hacks.mozilla.org/files/2021/04/image3-500x68.png 500w, https://hacks.mozilla.org/files/2021/04/image3-768x105.png 768w, https://hacks.mozilla.org/files/2021/04/image3-1536x210.png 1536w" sizes="(max-width: 1827px) 100vw, 1827px" /></p>
<p>To extract a meaningful stack trace from a minidump two more things are needed: unwinding information and symbols. The unwinding information is a set of instructions that describe how to find the various frames in the stack given an instruction pointer. Symbol information contains the names of the functions corresponding to a given range of addresses as well as the source files they come from and the line numbers a given instruction corresponds to.</p>
<p>In regular Firefox releases, we extract this information from the build files and store it into symbol files in Breakpad standard format. Equipped with this information Socorro can produce a human-readable stack trace. The whole flow can be seen below:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47200" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image7.png" alt="A graphicsl representation of our crash reporting flow, from the capture on the client to processing on the server" width="708" height="774" srcset="https://hacks.mozilla.org/files/2021/04/image7.png 708w, https://hacks.mozilla.org/files/2021/04/image7-250x273.png 250w, https://hacks.mozilla.org/files/2021/04/image7-500x547.png 500w" sizes="(max-width: 708px) 100vw, 708px" /></p>
<p>Here’s an example of a proper stack trace:</p>
<p><img loading="lazy" class="aligncenter wp-image-47176 size-full" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image1.png" alt="A fully symbolicated stack trace" width="1776" height="620" srcset="https://hacks.mozilla.org/files/2021/04/image1.png 1776w, https://hacks.mozilla.org/files/2021/04/image1-250x87.png 250w, https://hacks.mozilla.org/files/2021/04/image1-500x175.png 500w, https://hacks.mozilla.org/files/2021/04/image1-768x268.png 768w, https://hacks.mozilla.org/files/2021/04/image1-1536x536.png 1536w" sizes="(max-width: 1776px) 100vw, 1776px" /></p>
<p>If Socorro doesn’t have access to the appropriate symbol files for a crash the resulting trace contains only addresses and isn’t very helpful:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47196" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image6.png" alt="A stack trace showing raw addresses instead of symbols" width="859" height="334" srcset="https://hacks.mozilla.org/files/2021/04/image6.png 859w, https://hacks.mozilla.org/files/2021/04/image6-250x97.png 250w, https://hacks.mozilla.org/files/2021/04/image6-500x194.png 500w, https://hacks.mozilla.org/files/2021/04/image6-768x299.png 768w" sizes="(max-width: 859px) 100vw, 859px" /></p>
<p>When it comes to Linux things work differently than on other platforms: most of our users do not install our builds, they install the Firefox version that comes packaged for their favourite distribution.</p>
<p>This posed a significant problem when dealing with stability issues on Linux: for the majority of our crash reports, we couldn&#8217;t produce high-quality stack traces because we didn&#8217;t have the required symbol information. The Firefox builds that submitted the reports weren’t done by us. To make matters worse, Firefox depends on a number of third-party packages (such as GTK, Mesa, FFmpeg, SQLite, etc.). We wouldn&#8217;t get good stack traces if a crash occurred in one of these packages instead of Firefox itself because we didn&#8217;t have symbols for them either.</p>
<p>To address this issue, we started scraping debug information for Firefox builds and their dependencies from the package repositories of multiple distributions: Arch, Debian, Fedora, OpenSUSE and Ubuntu. Since every distribution does things a little bit differently, we had to write distro-specific scripts that would go through the list of packages in their repositories and find the associated debug information (the scripts are available <a href="https://github.com/gabrielesvelto/symbol-scrapers/">here</a>). This data is then fed into a tool that extracts symbol files from the debug information and uploads it to our symbol server.</p>
<p>With that information now available, we were able to analyze &gt;99% of the crash reports we received from Linux users, up from less than 20%. Here’s an example of a high-quality trace extracted from a distro-packaged version of Firefox. We haven’t built any of the libraries involved yet the function names are present and so are the file and line numbers of the affected code:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-47192" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/04/image5.png" alt="A fully symbolicated stack trace including external code" width="1452" height="799" srcset="https://hacks.mozilla.org/files/2021/04/image5.png 1452w, https://hacks.mozilla.org/files/2021/04/image5-250x138.png 250w, https://hacks.mozilla.org/files/2021/04/image5-500x275.png 500w, https://hacks.mozilla.org/files/2021/04/image5-768x423.png 768w" sizes="(max-width: 1452px) 100vw, 1452px" /></p>
<p>The importance of this cannot be overestimated: Linux users tend to be more tech-savvy and are more likely to help us solve issues, so all those reports were a treasure trove for improving stability even for other operating systems (Windows, Mac, Android, etc). In particular, we often identified <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1633459">Fission bugs</a> on Linux first.</p>
<p>The first effect of this newfound ability to inspect Linux crashes is that it greatly sped up our response time to Linux-specific issues, and often allowed us to identify problems in the Nightly and Beta versions of Firefox before they reached users on the release channel.</p>
<p>We could also quickly identify issues in bleeding-edge components such as <a href="https://github.com/servo/webrender">WebRender</a>, <a href="https://hacks.mozilla.org/2020/04/experimental-webgpu-in-firefox/">WebGPU</a>, <a href="https://fedoraproject.org/wiki/Changes/Firefox_Wayland_By_Default_On_Gnome">Wayland</a> and VA-API video acceleration; oftentimes providing a fix within days of the change that triggered the issue.</p>
<p>We didn&#8217;t stop there: we could now identify distro-specific issues and regressions. This allowed us to inform package maintainers of the problems and have them resolved quickly. For example, we were able to identify a Debian-specific issue only two weeks after it was introduced and fixed it right away. The crash was caused by a modification made by Debian to one of Firefox dependencies that could cause a crash on startup, it’s filed under bug <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1679430">1679430</a> if you’re curious about the details.</p>
<p>Another good example comes from Fedora: they had been using their own crash reporting system (ABRT) to catch Firefox crashes in their Firefox builds, but given the improvements on our side <a href="https://src.fedoraproject.org/rpms/firefox/c/de27f20acc7bdf391ccb1b571a9cb2061fc2dc3c?branch=master">they started sending Firefox crashes our way instead</a>.</p>
<p>We could also finally identify regressions and issues in our dependencies. This allowed us to communicate the issues upstream and sometimes even contributed fixes, benefiting both our users and theirs.</p>
<p>For example, at some point, Debian updated the fontconfig package by backporting an upstream fix for a memory leak. Unfortunately, the fix contained a bug that <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1633467">would crash Firefox</a> and possibly other software too. We spotted the new crash only six days after the change landed in Debian sources and only a couple of weeks afterwards the issue had been fixed both upstream and in Debian. We sent reports and fixes to other projects too including <a href="https://gitlab.freedesktop.org/mesa/mesa/-/issues/3066">Mesa</a>, GTK, <a href="https://gitlab.gnome.org/GNOME/glib/-/issues/954">glib</a>, <a href="https://github.com/LudovicRousseau/PCSC/issues/51">PCSC</a>, SQLite and more.</p>
<p>Nightly versions of Firefox also include a tool to spot security-sensitive issues: <a href="https://groups.google.com/g/mozilla.dev.platform/c/AyECjDNsqUE/m/Jd7Jr4cXAgAJ">the probabilistic heap checker</a>. This tool randomly pads a handful of memory allocations in order to detect buffer overflows and use-after-free accesses. When it detects one of these, it sends us a very detailed crash report. Given Firefox&#8217;s large user-base on Linux, this allowed us to spot some elusive issues in upstream projects and report them.</p>
<p>This also exposed some limitations in the tools we use for crash analysis, so we decided to rewrite them in Rust largely relying on the excellent crates developed by Sentry. The resulting tools were dramatically faster than our old ones, used a fraction of the memory and produced more accurate results. Code flowed both ways: we contributed improvements to their crates (and their dependencies) while they expanded their APIs to address our new use-cases and fixed the issues we discovered.</p>
<p>Another pleasant side-effect of this work is that Thunderbird now also benefits from the improvement we made for Firefox.</p>
<p>This goes on to show how collaboration between FOSS projects not only benefits their users but ultimately improves the whole ecosystem and the broader community that relies on it.</p>
<p>Special thanks to Calixte Denizet, Nicholas Nethercote, Jan Auer and all the others that contributed to this effort!</p>
    <section class="about">
                                <h2 class="about__header">About
                          Gabriele Svelto                      </h3>
                                <p><a class="url" href="https://hacks.mozilla.org/author/gsveltomozilla-com/">More articles by Gabriele Svelto&hellip;</a></p>
                  </section>
  </article>
  <section class="promo">
    <form id="newsletterForm" name="newsletter-form" class="newsletter block block--1 block--polite" action="https://www.mozilla.org/en-US/newsletter/" method="post">
  <h2 class="heading">Discover great resources for web development</h2>
  <p class="newsletter__description">Sign up for the Mozilla Developer Newsletter:</p>
  <input id="fmt" name="fmt" value="H" type="hidden">
  <input id="newsletterNewslettersInput" name="newsletters" value="app-dev" type="hidden">

  <div id="newsletterErrors" class="newsletter__errors"></div>

  <div id="newsletterEmail" class="form__row">
    <label for="newsletterEmailInput" class="offscreen">E-mail</label>
    <input id="newsletterEmailInput" name="email" class="newsletter__input" required="" placeholder="you@example.com" size="30" type="email">
  </div>

  <div id="newsletterPrivacy" class="form__row form__fineprint">
    <input id="newsletterPrivacyInput" name="privacy" required="" type="checkbox">
    <label for="newsletterPrivacyInput">
      I'm okay with Mozilla handling my info as explained in this <a href="https://www.mozilla.org/privacy/">Privacy Policy</a>.
    </label>
  </div>
  <button id="newsletter-submit" type="submit" class="button positive">Sign up now</button>
</form>
<div id="newsletterThanks" class="newsletter newsletter--thanks block block--1 block--polite hidden">
  <h2 class="heading">Thanks! Please check your inbox to confirm your subscription.</h2>
  <p>If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an email from us.
  </p>
</div>
  </section>
  

</main><!-- /#content-main -->

  

    <footer class="footer section section--fullwidth">
      <div class="row">
        <p class="block block--1">
          Except where otherwise noted, content on this site is licensed
          under the
          <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license external">Creative Commons Attribution Share-Alike License v3.0</a>
          or any later version.
        </p>
        <img class="footer__logo" alt="the Mozilla dino logo" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/dino.svg">
      </div>
    </footer>
  </div>
  <link rel='stylesheet' id='hljstheme-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/styles/solarized-light.css?ver=0.6.2' type='text/css' media='all' />
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=5.8.2' id='wp-embed-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/highlight.common.pack.js?ver=0.6.2' id='hljs_preload-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/highlight.custom.pack.js?ver=0.6.2' id='hljs-js'></script>
    <style>pre.hljs {padding: 5px;}
pre.hljs code {}</style>
    <script type="text/javascript">
    (function($, window) {
        var init_fn_flag = false;
        var init_fn = (function() {
            if (init_fn_flag)
                return;
            init_fn_flag = true;
             hljs.configure({"tabReplace":"    "});
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
        $(document).ready(init_fn);
        $(window).on("load", init_fn);
    })(jQuery, window);
    </script>
  <script>
    // External links should open in a new tab.
    (function () {
      var postLinks = document.querySelectorAll('#content-main a');

      var origin = location.origin;

      for (var i = 0; i < postLinks.length; i++) {
        var link = postLinks[i];
        if (link.origin !== origin && !link.getAttribute('target')) {
          link.setAttribute('target', '_blank');
        }
      }
    })();

    window.addEventListener('load', function () {
      if (document.querySelector('#newsletterForm')) {
        var script = document.createElement('script');
        var path = document.head.getAttribute('data-template-path');
        script.setAttribute('src', path + '/js/newsletter.js');
        document.head.appendChild(script);
      }
    });
  </script>
</body>
</html>
