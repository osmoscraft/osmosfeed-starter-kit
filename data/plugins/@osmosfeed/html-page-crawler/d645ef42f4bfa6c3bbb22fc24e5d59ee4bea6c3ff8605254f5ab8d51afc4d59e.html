<!doctype html>
<html lang="en" id="top-of-site" class="js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>How to Create a Browser Extension | CSS-Tricks - CSS-Tricks</title>
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#ff7a18">
<meta name="monetization" content="$ilp.uphold.com/biyqg2MkQKbe">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="CSS-Tricks Search">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="https://css-tricks.com/feed/">
<link rel="preconnect" href="https://s3.buysellads.com">
<link rel="dns-prefetch" href="https://s3.buysellads.com">
<link rel="preconnect" href="https://srv.buysellads.com">
<link rel="dns-prefetch" href="https://srv.buysellads.com">
<link rel="preconnect" href="https://res.cloudinary.com">
<link rel="dns-prefetch" href="https://res.cloudinary.com">
<link rel="preconnect" href="https://static.codepen.io">
<link rel="dns-prefetch" href="https://static.codepen.io">
<style id="jetpack-boost-critical-css">@media all{@charset "UTF-8";*{box-sizing:border-box}a{text-decoration:none}article,header,nav{display:block}html{-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0}body,html,ol,ul{margin:0}ol,ul{padding:0}nav ul{list-style:none;list-style-image:none}img{border:0;-ms-interpolation-mode:bicubic}input,textarea{font-size:100%;margin:0;vertical-align:baseline}input{line-height:normal}textarea{overflow:auto;vertical-align:top}@media (prefers-reduced-motion:reduce){*{scroll-behavior:auto!important}}@font-face{font-family:MD Primer Bold;font-weight:700}@font-face{font-family:Blanco;font-weight:400}@font-face{font-family:Blanco;font-weight:700}@font-face{font-family:Blanco;font-style:italic}@font-face{font-family:Blanco;font-weight:700;font-style:italic}html{font-family:Blanco,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:clamp(12px,calc(.8rem + .25vw),20px);font-weight:400;line-height:1.7}a{color:#0089c7}.article-title{font-size:clamp(1.2rem,calc(1rem + 3.5vw),4rem);text-shadow:0 2px 2px rgba(0,0,0,.5)}h1,h3,h4{font-weight:800;margin:0 0 1.5rem;line-height:1.1}h3 a{color:inherit}h1{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-size:clamp(2rem,calc(2rem + 1.2vw),3rem);font-weight:700}h3{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:2rem;letter-spacing:.03rem;font-weight:800}body:not(.page-id-21059):not(.parent-pageid-3222):not(.postid-181375):not(.postid-199370):not(.woocommerce-checkout) .article-content h3{margin-top:100px}body:not(.page-id-21059):not(.parent-pageid-3222):not(.postid-181375):not(.postid-199370):not(.woocommerce-checkout) .article-content h3 a{color:#0089c7}.aal_anchor{margin-left:-21px;margin-right:5px;position:relative;scroll-margin-top:100px;opacity:.33}.aal_anchor:before{content:"";position:absolute;width:100px;height:100px;border-radius:50%;left:50%;top:50%;transform:translate(-50%,-50%)}.aal_anchor svg{position:relative}h4{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:1.5rem;margin:0 0 .8rem}h4{line-height:1.05}.article-content li,.article-content p{max-width:700px}.article-content ol,.article-content ul{margin:0 0 1.5rem 1.5rem}.article-content ol li,.article-content ul li{line-height:1.6}.article-content ul li>*{text-indent:0}.article-content li{margin:0 0 5px}strong{font-weight:700}blockquote{font-size:1.3rem;letter-spacing:-.02rem;margin:1.5rem 0;padding:0 0 0 3rem;position:relative;font-style:italic}.article-content blockquote>*{hanging-punctuation:first}.article-content blockquote>:first-child:before{content:"\0022";width:100px;opacity:.15;font-size:100px;line-height:.85;position:absolute;left:-1rem}@media (max-width:800px){.article-content blockquote>:first-child:before{font-size:90px;left:-1.2rem}}blockquote p{margin:0 0 .25rem}blockquote p:last-child{margin:0}blockquote,blockquote p{max-width:900px}p,pre{margin:0 0 1.5rem}pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;clear:both;color:#fff;background:#1b1b1b;padding:0;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-ms-word-break:normal;word-break:normal;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;position:relative;line-height:28px;border-radius:8px;overflow:hidden}pre[rel]:not([rel=""]):before{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;font-size:.5rem;content:attr(rel);color:#fff;position:absolute;top:-.2rem;right:.4rem;padding:0;color:#ff7a18!important}pre code{scrollbar-color:#666 #201c29;background:0 0;white-space:pre;-webkit-overflow-scrolling:touch;overflow-x:scroll;display:block;max-width:100%;min-width:100px;font-size:16px;padding:15px 20px 12px 22px;line-height:1.75}pre code::-webkit-scrollbar{width:.5em;height:.5em}@media (max-width:800px){pre code{font-size:11px;padding:15px 20px 10px 14px}}code{font-size:inherit;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace}li:not(.comment):not([data-category])>code,p>code{overflow-wrap:break-word;word-wrap:break-word;-webkit-box-decoration-break:clone;box-decoration-break:clone;padding:.1rem .3rem .2rem;border-radius:.2rem;font-size:88%}.screen-reader-text{position:absolute!important;clip:rect(1px,1px,1px,1px);width:1px;height:1px;overflow:hidden}p:empty{display:none}.language-javascript{color:#f5d67b}.button{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;background-color:#5e5e5e!important;color:#fff!important;border:0;border-bottom:1px solid #262626;border-right:1px solid #262626;box-shadow:inset 1px 1px 0 #777,0 2px 3px rgba(0,0,0,.4);display:inline-block;font-weight:700;line-height:1.4;text-transform:uppercase;text-decoration:none!important;border-radius:4px!important;white-space:nowrap;padding:1rem 1.5rem;text-align:center;position:relative}input[type=text],textarea{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;background:#eaeaea;border:1px solid #d4d4d4!important;padding:.5rem;border-radius:4px;border:0;width:100%}textarea{padding:1rem;display:block}html{--maxWidth:1600px;--gap:3rem;scrollbar-color:#666 #201c29;background:radial-gradient(900px 900px at top center,#5e5e5e,#2d3334,#262626);background-repeat:no-repeat;color:#fff;overflow-x:hidden}html::-webkit-scrollbar{width:16px;height:16px}@media (max-width:1200px){html{--gap:2rem}}@media (max-width:800px){html{--gap:1rem}}#top-of-site-pixel-anchor{position:absolute;width:1px;height:1px;top:500px;left:0}@media (max-width:800px){#top-of-site-pixel-anchor{top:46px}}.mega-header,.page-wrap{max-width:var(--maxWidth);margin:0 auto;padding:0 var(--gap)}main{position:relative;z-index:1}.articles-and-sidebar{display:grid;grid-template-columns:minmax(0,1fr) 300px;gap:var(--gap);margin:0 auto}.articles-and-sidebar>:not(.sidebar){align-self:start}@media (max-width:800px){.articles-and-sidebar{display:block;padding-top:0}}.articles-and-sidebar.single-mini{display:block}.articles-and-sidebar.single-mini .sidebar{display:none}.articles-and-sidebar.single-mini .article-content{font-size:1.5rem}@media (max-width:800px){.articles-and-sidebar.single-mini .article-content{font-size:1.2rem}}@media (max-width:800px){.sidebar{display:none}}img{max-width:100%}.site-header{position:relative;z-index:2;display:flex;padding:0 var(--gap);margin:0 0 var(--gap) 0;background-color:#111;background-image:paint(fleck);border-bottom:1px solid #676767}.site-header .logo{flex:0;position:relative;align-self:stretch}.site-header .logo,.site-header .logo>a{display:flex;align-items:center}.site-header .icon-logo-star{fill:#fff;width:25px;height:25px;margin:0 .5rem 0 0}.site-header .icon-logo-text{fill:#fff;height:25px;width:170px;margin-right:var(--gap)}.site-header .header-middle-area{flex:1;width:100%}.site-header .main-nav>ul{display:flex;height:100%}.site-header .main-nav>ul>li>a{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;text-transform:uppercase;font-weight:500;font-size:.8rem;height:100%;color:#fff;padding:1.2rem 1rem;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;overflow:hidden}@media (max-width:1000px){.site-header{padding:20px 20px 0;flex-wrap:wrap}.site-header .header-middle-area{flex:0 0 100%}.site-header .main-nav{padding-top:10px;-webkit-margin-start:-10px;margin-inline-start:-10px}.site-header .main-nav>ul>li>a{padding:.6rem .8rem;border-top-right-radius:4px;border-top-left-radius:4px}.site-header .icon-logo-star{width:18px;height:18px}.site-header .icon-logo-text{height:15px;width:116px}}@media (max-width:620px){.site-header{padding-top:15px}.site-header .main-nav{width:calc(100% + var(--gap)*2);overflow:auto}}.search-and-account{position:fixed;z-index:15;top:.9rem;right:var(--gap)}.search-and-account svg{width:32px;height:32px}@media (max-width:620px){.search-and-account{top:.95rem}.search-and-account svg{width:28px;height:28px}}.search-and-account a{margin-left:.5rem}.search-and-account a svg{-webkit-filter:drop-shadow(0 2px 5px rgba(0,0,0,.3));filter:drop-shadow(0 2px 5px rgba(0,0,0,.3))}.top-of-site-link{visibility:hidden;opacity:0;position:fixed;bottom:1.2rem;right:1.5rem;z-index:15}.top-of-site-link svg{-webkit-filter:drop-shadow(0 2px 5px rgba(0,0,0,.3));filter:drop-shadow(0 2px 5px rgba(0,0,0,.3))}.article-sponsor{padding:1rem 1.5rem calc(1rem + 10px);margin-bottom:-10px;border-radius:8px;background:rgba(0,0,0,.2)}.article-sponsor p{margin:0}.article-sponsor a{color:#fff;font-weight:700;position:relative;display:inline-block;line-height:1.2}.article-sponsor a:before{content:"";position:absolute;top:100%;width:100%;left:0;height:3px;border-radius:2px;background:linear-gradient(130deg,#ff7a18,#af002d 41.07%,#319197 76.05%)}.article-content{font-size:1.2rem;background:#fff;color:#000;overflow-wrap:break-word;border-radius:8px;padding:4rem;position:relative}@media (max-width:800px){.article-content{padding:1.66rem}}.article-content a{text-decoration:underline;-webkit-text-decoration-color:#a2dffb;text-decoration-color:#a2dffb}.article-content img{max-width:100%;height:auto!important}figure>img{display:block}.mega-header{position:relative;z-index:1;overflow:hidden;padding:0 0 2rem}.mega-header .tags a{color:#ffdfc7}.mega-header .author-name,.mega-header .author-row{color:#fff}.jp-relatedposts{margin-bottom:1rem}.author-row{-webkit-margin-before:auto;margin-block-start:auto;display:grid;grid-template-columns:40px 1fr;gap:.5rem;align-items:center;color:#565656;line-height:1.3;padding-top:.5rem}.author-row>div>*{white-space:nowrap}.avatar{width:40px;height:40px;border-radius:50%;margin-right:.5rem}.author-name{font-weight:700;color:#000}.tags{line-height:1;margin:0 0 .5rem}.tags a{font-family:MD Primer Bold,Rubik,Lato,Lucida Grande,Lucida Sans Unicode,Tahoma,Sans-Serif;font-style:normal;font-weight:700;text-transform:uppercase;color:#ff7a18;font-size:.66rem;-webkit-margin-end:.66rem;margin-inline-end:.66rem}.CommentForm .comment-wrap .author-avatar,.comment ul .comment-wrap .author-avatar,.commentlist .comment-wrap .author-avatar{margin:0;align-self:start;grid-area:auto}#commentform label{display:block}#commentform .comment-notes,#commentform .required{display:none}#commentform p{margin-bottom:.5rem}.bsap-doubles.side-by-side{margin-top:var(--gap)}#all-modules{height:100%}#scroll-ad-position{width:1px;height:1px}#sticky-sidebar-stuff{position:-webkit-sticky;position:sticky;top:2.5rem;opacity:0;visibility:hidden}@media (max-width:620px){#sticky-sidebar-stuff{top:89px}}.fem-ad{background:#1f1f1f;color:#fff;border-radius:8px;position:relative}.fem-ad:before{content:"";background:linear-gradient(130deg,#ff7a18,#af002d 41.07%,#319197 76.05%);position:absolute;top:-5px;left:-5px;width:calc(100% + 10px);height:calc(100% + 10px);z-index:-1;border-radius:12px}.fem-ad h4{font-size:1.2rem}.fem-ad .fem-learning-partner{font-size:.75rem;color:#fff;text-transform:uppercase;letter-spacing:.13rem;text-align:center;margin:0 0 .5rem}.fem-ad .fem-header-inner{background:rgba(0,0,0,.7);padding:1rem;border-radius:7px}.fem-ad .fem-title{text-align:center}.fem-ad .fem-logo{width:200px;display:block;margin:0 auto}.fem-ad .fem-message{background:#eaeaea;border-bottom-left-radius:7px;border-bottom-right-radius:7px;color:#000;padding:1.5rem;font-size:.85rem}.fem-ad .fem-message p{margin:0}.fem-footer-ad{margin:var(--gap) 0 var(--gap) 0;display:grid;grid-template-columns:1fr 2fr}@media (max-width:1200px){.fem-footer-ad{grid-template-columns:4fr 3fr}}@media (max-width:800px){.fem-footer-ad{display:block}.fem-footer-ad .fem-header-inner{height:auto}}.fem-footer-ad .fem-header-inner{padding:4rem 1.5rem;display:grid;place-items:center}.single-almanac-content .almanac-sidebar{grid-area:1/1/2/2;background:#111;border-radius:8px;padding:1rem}.single-almanac-content .article-content-wrap{grid-area:1/2/2/3}.single-almanac-content .sidebar{grid-area:1/3/2/4}@media (max-width:650px){.single-almanac-content .article-content-wrap{grid-area:1/1/2/2;min-width:0}.single-almanac-content .almanac-sidebar{grid-area:2/1/3/2}}@media screen and (max-width:400px){@-ms-viewport{width:320px}}}@media all{#jp-relatedposts{display:none;padding-top:1em;margin:1em 0;position:relative;clear:both}.jp-relatedposts:after{content:'';display:block;clear:both}}</style>

<meta name="description" content="I’ll bet you are using browser extensions right now. Some of them are extremely popular and useful, like ad blockers, password managers, and PDF viewers." />
<meta name="robots" content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large" />
<link rel="canonical" href="https://css-tricks.com/how-to-create-a-browser-extension/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How to Create a Browser Extension | CSS-Tricks" />
<meta property="og:description" content="I’ll bet you are using browser extensions right now. Some of them are extremely popular and useful, like ad blockers, password managers, and PDF viewers." />
<meta property="og:url" content="https://css-tricks.com/how-to-create-a-browser-extension/" />
<meta property="og:site_name" content="CSS-Tricks" />
<meta property="article:publisher" content="https://www.facebook.com/CSSTricks" />
<meta property="article:tag" content="browser extension" />
<meta property="article:section" content="Article" />
<meta property="og:updated_time" content="2022-01-03T07:12:34-08:00" />
<meta property="og:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/359615" />
<meta property="og:image:secure_url" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/359615" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content="How to Create a Browser Extension" />
<meta property="og:image:type" content="image/png" />
<meta property="article:published_time" content="2022-01-03T07:12:31-08:00" />
<meta property="article:modified_time" content="2022-01-03T07:12:34-08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="How to Create a Browser Extension | CSS-Tricks" />
<meta name="twitter:description" content="I’ll bet you are using browser extensions right now. Some of them are extremely popular and useful, like ad blockers, password managers, and PDF viewers." />
<meta name="twitter:site" content="@CSS" />
<meta name="twitter:creator" content="@CSS" />
<meta name="twitter:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/359615" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Lars Kölker" />
<meta name="twitter:label2" content="Time to read" />
<meta name="twitter:data2" content="22 minutes" />

<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//i0.wp.com' />
<link rel='dns-prefetch' href='//i1.wp.com' />
<link rel='dns-prefetch' href='//i2.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="CSS-Tricks &raquo; How to Create a Browser Extension Comments Feed" href="https://css-tricks.com/how-to-create-a-browser-extension/feed/" />
<noscript><link rel='stylesheet' id='css-tricks-style-css'  href='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/style.css?ver=cache_bust=1641416079722' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='css-tricks-style-css' href='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/style.css?ver=cache_bust=1641416079722' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='mediaelement-css'  href='https://c0.wp.com/c/5.8.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/5.8.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wp-mediaelement-css'  href='https://c0.wp.com/c/5.8.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/5.8.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wc-blocks-vendors-style-css'  href='https://c0.wp.com/p/woocommerce/6.0.0/packages/woocommerce-blocks/build/wc-blocks-vendors-style.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wc-blocks-vendors-style-css' href='https://c0.wp.com/p/woocommerce/6.0.0/packages/woocommerce-blocks/build/wc-blocks-vendors-style.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<noscript><link rel='stylesheet' id='wc-blocks-style-css'  href='https://c0.wp.com/p/woocommerce/6.0.0/packages/woocommerce-blocks/build/wc-blocks-style.css' type='text/css' media='all' />
</noscript><link rel='stylesheet' id='wc-blocks-style-css' href='https://c0.wp.com/p/woocommerce/6.0.0/packages/woocommerce-blocks/build/wc-blocks-style.css' type='text/css' media="not all" data-media="all" onload="this.media=this.dataset.media; delete this.dataset.media; this.removeAttribute( 'onload' );" />
<style id='woocommerce-inline-inline-css' type='text/css'>
.woocommerce form .form-row .required { visibility: visible; }
</style>
<link rel="https://api.w.org/" href="https://css-tricks.com/wp-json/" /><link rel="alternate" type="application/json" href="https://css-tricks.com/wp-json/wp/v2/posts/359615" /><link rel='shortlink' href='https://css-tricks.com/?p=359615' />
<link rel="alternate" type="application/json+oembed" href="https://css-tricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcss-tricks.com%2Fhow-to-create-a-browser-extension%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://css-tricks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcss-tricks.com%2Fhow-to-create-a-browser-extension%2F&#038;format=xml" />


<meta property="og:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/359615">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:image" content="https://css-tricks.com/wp-json/social-image-generator/v1/image/359615">
<meta name="twitter:card" content="summary_large_image">

<meta name="jetpack-boost-ready" content="true" />
<style type='text/css'>img#wpstats{display:none}</style>
<noscript><style>.woocommerce-product-gallery{ opacity: 1 !important; }</style></noscript>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<link rel="icon" href="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&#038;ssl=1" />
</head>
<body class="post-template-default single single-post postid-359615 single-format-standard theme-CSS-Tricks-19 woocommerce-no-js jps-theme-CSS-Tricks-19 category-article">
<div id="top-of-site-pixel-anchor"></div>
<header class="site-header" id="site-header">
<a id="skip-nav" class="skip-nav screen-reader-text" href="#maincontent">Skip to main content</a>
<div class="logo">
<a href="/">
<div class="screen-reader-text">CSS-Tricks</div>
<svg class="icon-logo-star" width="35px" height="35px" viewBox="0 0 362.62 388.52" data-spin-me="false">
<path d="M156.58,239l-88.3,64.75c-10.59,7.06-18.84,11.77-29.43,11.77-21.19,0-38.85-18.84-38.85-40C0,257.83,14.13,244.88,27.08,239l103.6-44.74L27.08,148.34C13,142.46,0,129.51,0,111.85,0,90.66,18.84,73,40,73c10.6,0,17.66,3.53,28.25,11.77l88.3,64.75L144.81,44.74C141.28,20,157.76,0,181.31,0s40,18.84,36.5,43.56L206,149.52l88.3-64.75C304.93,76.53,313.17,73,323.77,73a39.2,39.2,0,0,1,38.85,38.85c0,18.84-12.95,30.61-27.08,36.5L231.93,194.26,335.54,239c14.13,5.88,27.08,18.83,27.08,37.67,0,21.19-18.84,38.85-40,38.85-9.42,0-17.66-4.71-28.26-11.77L206,239l11.77,104.78c3.53,24.72-12.95,44.74-36.5,44.74s-40-18.84-36.5-43.56Z" />
</svg>
<svg class="icon-logo-text" width="214px" height="35px" viewBox="0 0 474.15 58.26">
<path d="M46 42.57a4.5 4.5 0 0 0-3 1.13c-4.1 3.46-8.13 5.39-14.08 5.39-10.78 0-18.58-8.93-18.58-20v-.09c0-11 7.88-19.87 18.58-19.87a20.42 20.42 0 0 1 13.48 5.03 4.95 4.95 0 0 0 7.88-3.86 4.94 4.94 0 0 0-1.93-3.94c-4.91-3.79-10.62-6.36-19.35-6.36-17 0-29 13.12-29 29.13v.16c0 16.17 12.23 29 28.64 29 9.09 0 15.12-2.9 20.43-7.56a4.76 4.76 0 0 0 1.61-3.54 4.71 4.71 0 0 0-4.68-4.62zm36.86-17.95c-10.86-2.62-13.43-4.5-13.43-8.85v-.16c0-3.7 3.38-6.68 9.17-6.68 4.43 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.91-5.22c-11.18 0-19.23 6.68-19.23 16.34v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.73 4.58 12.73 8.6v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.94 3.77 35.05 35.05 0 0 0 21.16 7.1c11.83 0 20.11-6.28 20.11-16.82v-.16c0-9.34-6.11-13.6-18.02-16.5zm49.88 0c-10.86-2.57-13.43-4.51-13.43-8.85v-.16c0-3.7 3.38-6.68 9.17-6.68 4.42 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.91-5.22c-11.18 0-19.23 6.68-19.23 16.33v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.71 4.59 12.71 8.61v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.96 3.77 35.05 35.05 0 0 0 21.16 7.08c11.83 0 20.11-6.28 20.11-16.82v-.16c0-9.32-6.11-13.58-18.02-16.48zm45.62 3.22h-15.13a4.79 4.79 0 0 0 0 9.58h15.12a4.79 4.79 0 0 0 0-9.58zm45.64-26.84h-37.45a4.59 4.59 0 0 0 0 9.17h13.68v42.62a5 5 0 0 0 10 0v-42.65h13.77a4.59 4.59 0 0 0 0-9.14zm38.86 0h-20.15a4.91 4.91 0 0 0-5 5v46.79a4.95 4.95 0 0 0 9.89 0v-15.13h12.47l13.68 17.46a5.65 5.65 0 0 0 4.83 2.58 4.67 4.67 0 0 0 4.75-4.59 5.74 5.74 0 0 0-1.61-3.78l-10.78-13.6c7.56-2.33 12.79-7.81 12.79-16.82v-.16a17 17 0 0 0-4.66-12.15c-3.62-3.54-9.17-5.6-16.25-5.6zm10.86 18.51c0 5.71-4.51 9.41-11.58 9.41h-14.53v-18.92h14.39c7.32 0 11.67 3.3 11.67 9.33zm27-18.91a4.89 4.89 0 0 0-5 4.91v47.28a4.95 4.95 0 0 0 9.89 0v-47.32a4.88 4.88 0 0 0-4.98-4.91zm62.67 42a4.5 4.5 0 0 0-3 1.13c-4.1 3.46-8.13 5.39-14.08 5.39-10.78 0-18.58-8.93-18.58-20v-.12c0-11 7.88-19.87 18.58-19.87a20.42 20.42 0 0 1 13.44 5.07 4.95 4.95 0 0 0 7.88-3.86 4.94 4.94 0 0 0-1.93-3.94c-4.98-3.83-10.7-6.4-19.38-6.4-17.06 0-29 13.12-29 29.13v.16c0 16.17 12.23 29 28.64 29 9.09 0 15.12-2.9 20.43-7.56a4.76 4.76 0 0 0 1.61-3.58 4.71 4.71 0 0 0-4.7-4.58zm41-16.82l17.54-16.9a4.81 4.81 0 0 0 1.77-3.7 4.53 4.53 0 0 0-4.7-4.62 5.2 5.2 0 0 0-4.1 1.85l-26.66 26.88v-23.82a4.95 4.95 0 0 0-9.9 0v47.32a4.95 4.95 0 0 0 9.9 0v-11.67l9.17-8.85 18.1 23.09a5 5 0 0 0 4.18 2.33 4.83 4.83 0 0 0 5-4.83 5.36 5.36 0 0 0-1.37-3.54zm51.8-1.13c-10.92-2.65-13.49-4.53-13.49-8.88v-.16c0-3.7 3.38-6.68 9.17-6.68 4.42 0 8.61 1.45 13 4.26a4.78 4.78 0 0 0 2.57.72 4.6 4.6 0 0 0 4.67-4.59 4.47 4.47 0 0 0-2.17-3.94 31 31 0 0 0-17.94-5.22c-11.15 0-19.2 6.68-19.2 16.34v.16c0 10.38 6.76 13.92 18.74 16.82 10.46 2.41 12.71 4.59 12.71 8.61v.16c0 4.18-3.86 7.08-10 7.08a24.42 24.42 0 0 1-15.77-5.79 4.79 4.79 0 0 0-7.56 3.7 4.64 4.64 0 0 0 1.96 3.76 35.05 35.05 0 0 0 21.12 7.1c11.83 0 20.11-6.28 20.11-16.82v-.16c.04-9.34-6.11-13.6-17.98-16.5z" />
</svg> </a>
</div>
<div class="header-middle-area">
<nav class="main-nav" id="main-nav">
<ul>
<li class="articles">
<a href="/archives/">
<span>Articles</span>
</a>
</li>
<li class="videos">
<a href="/video-screencasts/">
<span>Videos</span>
</a>
</li>
<li class="almanac">
<a href="/almanac/">
<span>Almanac</span>
</a>
</li>
<li class="newsletter">
<a href="/newsletters/">
<span>Newsletter</span>
</a>
</li>
<li class="guides">
<a href="/guides/">
<span>Guides</span>
</a>
</li>
<li class="books">
<a href="/books/">
<span>Books</span>
</a>
</li>
</ul>
</nav>
<div class="search-and-account">
<a href="https://www.google.com/search?q=site:css-tricks.com%20layout" class="jetpack-search-filter__link">
<span class="screen-reader-text">Search</span>
<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M15.0726 10.4326C12.4801 10.4326 10.4 12.5451 10.4 15.1053C10.4 17.6978 12.5125 19.7779 15.0726 19.7779C17.6651 19.7779 19.7453 17.6654 19.7453 15.1053C19.744 12.544 17.664 10.4326 15.0726 10.4326Z" fill="white" />
<path d="M16.0327 0.447479C7.42401 0.447479 0.447693 7.4238 0.447693 16.0324C0.447693 24.6398 7.42401 31.6161 16.0314 31.6161C24.64 31.6161 31.6163 24.6398 31.6163 16.0324C31.6163 7.4238 24.64 0.447479 16.0327 0.447479ZM23.6163 24.0324C23.3926 24.2562 23.0401 24.385 22.6563 24.385C22.2726 24.385 21.9526 24.2575 21.6963 24.0324L18.7526 21.0887L18.4651 21.2487C17.4088 21.825 16.2576 22.145 15.0724 22.145C11.1998 22.145 8.06509 19.0087 8.06509 15.1376C8.06509 11.265 11.2013 8.13023 15.0724 8.13023C18.9451 8.13023 22.0798 11.2665 22.0798 15.1376C22.0798 16.5138 21.6961 17.8251 20.9273 18.9776L20.7348 19.2976L23.6473 22.2101C23.8711 22.4664 24.0311 22.7864 24.0311 23.1376C23.9998 23.4563 23.8723 23.7763 23.616 24.0326L23.6163 24.0324Z" fill="white" />
</svg>
</a>
<a href="/product/membership/">
<span class="screen-reader-text">Account</span>
<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17 1.7C11.5335 1.7 6.48243 4.61655 3.74917 9.35C1.0172 14.0835 1.0172 19.9165 3.74917 24.65C6.48246 29.3835 11.5335 32.3 17 32.3C20.4918 32.3133 23.8809 31.1193 26.5917 28.9199C29.9014 26.2557 31.9559 22.3365 32.2602 18.0984C32.5657 13.8603 31.0954 9.68748 28.2003 6.57682C25.3063 3.46636 21.249 1.69986 17.0003 1.69986L17 1.7ZM27.9956 24.411C27.2651 22.1412 25.014 20.2514 21.9925 19.2447C20.7069 20.6405 18.8967 21.4361 17 21.4361C15.1021 21.4347 13.292 20.6405 12.0074 19.2447C8.98463 20.2514 6.73335 22.1413 6.00439 24.411C4.20212 21.7388 3.43579 18.5008 3.8475 15.3041C4.25921 12.1073 5.82242 9.17082 8.24234 7.04174C10.6622 4.91276 13.7752 3.7387 16.9987 3.7387C20.2221 3.7387 23.3353 4.91276 25.7564 7.04041C28.1763 9.16939 29.7395 12.1057 30.1513 15.3027C30.563 18.4995 29.7966 21.7376 27.9957 24.411L27.9956 24.411Z" fill="white" />
<path d="M22.5049 13.6092C22.5049 16.9919 20.0399 19.736 17 19.736C13.9586 19.736 11.4937 16.9921 11.4937 13.6092C11.4937 10.2251 13.9587 7.48236 17 7.48236C20.0401 7.48236 22.5049 10.2249 22.5049 13.6092Z" fill="white" />
</svg>
</a>
</div>
</div>
</header>
<div class="page-wrap">
<div class="articles-and-sidebar ">
<main id="post-359615">
<article>
<header class="mega-header">
<style>
    html {
      --featured-img: url(https://css-tricks.com/wp-content/uploads/2021/12/unnamed-file.png);
      --bg-blend-mode: multiply;
      background-size: 120% 2000px, 100% auto;
    }
  </style>
<div class="tags">
<a href="https://css-tricks.com/tag/browser-extension/" rel="tag">browser extension</a> </div>
<h1 class="article-title">
How to Create a Browser&nbsp;Extension </h1>
<div class="author-row">
<a href="https://css-tricks.com/author/larskoelker/" aria-label="Author page of Lars Kölker">
<img alt="Avatar of Lars Kölker" class="avatar avatar-80 photo avatar-default jetpack-lazy-image" height="80" src="https://css-tricks.com/wp-content/uploads/2021/12/Portrait_2x_optimized-scaled-80x80.jpg" width="80" data-lazy-src="https://css-tricks.com/wp-content/uploads/2021/12/Portrait_2x_optimized-scaled-80x80.jpg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img alt="Avatar of Lars Kölker" class="avatar avatar-80 photo avatar-default" height="80" src="https://css-tricks.com/wp-content/uploads/2021/12/Portrait_2x_optimized-scaled-80x80.jpg" width="80"></noscript> </a>
<div>
<a class="author-name" href="https://css-tricks.com/author/larskoelker/">
Lars Kölker </a>
on
<time datetime="">
Jan 3, 2022 </time>
</div>
</div>
</header>
<div class="article-sponsor">
<p>
<a href="https://ad.doubleclick.net/ddm/trackclk/N1224323.3091281BUYSELLADS/B25600467.324342617;dc_trk_aid=517316264;dc_trk_cid=157730382;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;ltd=">Try Mailchimp today.</a>
<img src="https://ad.doubleclick.net/ddm/trackimp/N1224323.3091281BUYSELLADS/B25600467.324342617;dc_trk_aid=517316264;dc_trk_cid=157730382;ord=1641592967;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;ltd=?" alt="MailChimp Tracking Pixel">
</p>
</div>
<div class="article-content">
<p>I’ll bet you are using browser extensions right now. Some of them are extremely popular and useful, like ad blockers, password managers, and PDF viewers. These extensions (or &#8220;add-ons&#8221;) are not limited to those purposes — you can do a lot more with them! In this article, I will give you an introduction on how to create one. Ultimately, we’ll make it work in multiple browsers.</p>
<span id="more-359615"></span>
<h3><a href="#what-were-making" aria-hidden="true" class="aal_anchor" id="aa-what-were-making"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What we’re making</h3>
<p>We’re making an extension called <strong>&#8220;Transcribers of Reddit&#8221;</strong> and it’s going to improve Reddit’s accessibility by moving specific comments to the top of the comment section and adding <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA" rel="noopener"><code>aria-</code> attributes</a> for screen readers. We will also take our extension a little further with options for adding borders and backgrounds to comments for better text contrast.</p>
<p>The whole idea is that you’ll get a nice introduction for how to develop a browser extension. We will start by creating the extension for Chromium-based browsers (e.g. Google Chrome, Microsoft Edge, Brave, etc.). In a future post we will port the extension to work with Firefox, as well as Safari which <a href="https://webkit.org/blog/11989/new-webkit-features-in-safari-15/" rel="noopener">recently added support for Web Extensions</a> in both the MacOS and iOS versions of the browser.</p>
<div class="wp-block-buttons">
<div class="wp-block-button"><a class="wp-block-button__link" href="https://github.com/Lars418/torExtension" rel="noopener">GitHub repo</a></div>
</div>
<p>Ready? Let’s take this one step at a time.</p>
<h3><a href="#create-a-working-directory" aria-hidden="true" class="aal_anchor" id="aa-create-a-working-directory"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a working directory</h3>
<p>Before anything else, we need a working space for our project. All we really need is to create a folder and give it a name (which I’m calling <code>transcribers-of-reddit</code>). Then, create another folder inside that one named <code>src</code> for our source code.</p>
<h3><a href="#define-the-entry-point" aria-hidden="true" class="aal_anchor" id="aa-define-the-entry-point"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Define the entry point</h3>
<p>The entry point is a file that contains general information about the extension (i.e. extension name, description, etc.) and defines permissions or scripts to execute.</p>
<p>Our entry point can be a <code>manifest.json</code> file located in the <code>src</code> folder we just created. In it, let’s add the following three properties:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">{
  "manifest_version": 3,
  "name": "Transcribers of Reddit",
  "version": "1.0"
}</code></pre>
<p>The <code>manifest_version</code> is similar to version in npm or Node. It defines what APIs are available (or not). We’re going to work on the bleeding edge and use the latest version, 3 (also known as as <code>mv3</code>).</p>
<p>The second property is <code>name</code> and it specifies our extension name. This name is what’s displayed everywhere our extension appears, like <a href="https://chrome.google.com/webstore" rel="noopener">Chrome Web Store</a> and the <code>chrome://extensions</code> page in the Chrome browser.</p>
<p>Then there’s <code>version</code>. It labels the extension with a version number. Keep in mind that this property (in contrast to <code>manifest_version</code>) is a string that can only contain numbers and dots (e.g. 1.3.5).</p>
<h3><a href="#more-manifest-json-information" aria-hidden="true" class="aal_anchor" id="aa-more-manifest-json-information"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>More <code>manifest.json</code> information</h3>
<p>There’s actually a lot more we can add to help add context to our extension. For example, we can provide a <code>description</code> that explains what the extension does. It’s a good idea to provide these sorts of things, as it gives users a better idea of what they’re getting into when they use it.</p>
<p>In this case, we’re not only adding a description, but supplying icons and a web address that Chrome Web Store points to on the extension’s page.</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">{
  "description": "Reddit made accessible for disabled users.",
  "icons": {
    "16": "images/logo/16.png",
    "48": "images/logo/48.png",
    "128": "images/logo/128.png"
  },
  "homepage_url": "https://lars.koelker.dev/extensions/tor/"
}</code></pre>
<ul><li>The <code>description</code> is displayed on Chrome’s management page (<code>chrome://extensions</code>) and should be brief, less than 132 characters.</li><li>The <code>icons</code> are used in lots of places. As the <a href="https://developer.chrome.com/docs/extensions/mv3/manifest/icons/" rel="noopener">docs</a> state, it’s best to provide three versions of the same icon in different resolutions, preferably as a PNG file. Feel free to use the ones in the <a href="https://github.com/Lars418/torExtension/tree/main/src/images/logo" rel="noopener">GitHub repository</a> for this example.</li><li>The <code>homepage_url</code> can be used to connect your website with the extension. A button including the link will be displayed when clicking on &#8220;More details&#8221; on the management page.</li></ul>
<div class="wp-block-image"><figure class="aligncenter size-full"><img loading="lazy" width="566" height="851" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?resize=566%2C851&#038;ssl=1" alt class="wp-image-359642 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?w=566&amp;ssl=1 566w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?resize=200%2C300&amp;ssl=1 200w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?resize=566%2C851&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="566" height="851" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?resize=566%2C851&#038;ssl=1" alt="" class="wp-image-359642" srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?w=566&amp;ssl=1 566w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/image-2.png?resize=200%2C300&amp;ssl=1 200w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>Our opened extension card inside the extension management page.</figcaption></figure></div>
<h3><a href="#setting-permissions" aria-hidden="true" class="aal_anchor" id="aa-setting-permissions"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting permissions</h3>
<p>One major advantage extensions have is that their APIs allow you to interact directly with the browser. But we have to explicitly give the extension those permissions, which also goes inside the <code>manifest.json</code> file.</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line="13,14,15,16"><code markup="tt">
{
  "manifest_version": 3,
  "name": "Transcribers of Reddit",
  "version": "1.0",
  "description": "Reddit made accessible for disabled users.",
  "icons": {
    "16": "images/logo/16.png",
    "48": "images/logo/48.png",
    "128": "images/logo/128.png"
  },
  "homepage_url": "https://lars.koelker.dev/extensions/tor/",

  "permissions": [
    "storage",
    "webNavigation"
  ]
}</code></pre>
<p>What did we just give this extension permission to? First, storage. We want this extension to be able to save the user’s settings, so we need to access the browser’s web storage to hold them. For example, if the user wants red borders on the comments, then we’ll save that for next time rather than making them set it again.</p>
<p>We also gave the extension permission to look at how the user navigated to the current screen. Reddit is a single-page application (SPA) which means it doesn’t trigger a page refresh. We need to &#8220;catch&#8221; this interaction, as Reddit will only load the comments of a post if we click on it. So, that’s why we’re tapping into <code>webNavigation</code>.</p>
<p>We’ll get to executing code on a page later as it requires a whole new entry inside <code>manifest.json</code>.</p>
<p>/explanation Depending on which permissions are allowed, the browser might display a warning to the user to accept the permissions. It’s only certain ones, though, and <a href="https://developer.chrome.com/docs/extensions/mv3/permission_warnings/#permissions_with_warnings" rel="noopener">Chrome has a nice outline of them</a>.</p>
<h3><a href="#managing-translations" aria-hidden="true" class="aal_anchor" id="aa-managing-translations"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Managing translations</h3>
<p>Browser extensions have a built-in internalization (i18n) API. It allows you to manage translations for multiple languages (<a href="https://developer.chrome.com/docs/webstore/i18n/#choosing-locales-to-support" rel="noopener">full list</a>). To use the API, we have to define our translations and default language right in the <code>manifest.json</code> file:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">"default_locale": "en"</code></pre>
<p>This sets English as the language. In the event that a browser is set to any other language that isn’t supported, the extension will fall back to the default locale (<code>en</code> in this example).</p>
<p>Our translations are defined inside the <code>_locales</code> directory. Let’s create another folder in there each language you want to support. Each subdirectory gets its own <code>messages.json</code> file.</p>
<pre rel="" class="wp-block-csstricks-code-block language-none" data-line=""><code markup="tt">src 
 └─ _locales
     └─ en
        └─ messages.json
     └─ fr
        └─ messages.json</code></pre>
<p>A translation file consists of multiple parts:</p>
<ul><li><strong>Translation key (&#8220;id&#8221;):</strong> This key is used to reference the translation.</li><li><strong>Message:</strong> The actual translation content</li><li><strong>Description (optional):</strong> Describes the translation (I wouldn’t use them, they just bloat up the file and your translation key should be descriptive enough)</li><li><strong>Placeholders (optional):</strong> Can be used to insert dynamic content inside a translation</li></ul>
<p>Here’s an example that pulls all that together:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">{
  "userGreeting": { // Translation key ("id")
    "message": "Good $daytime$, $user$!" // Translation
    "description": "User Greeting", // Optional description for translators
    "placeholders": { // Optional placeholders
      "daytime": { // As referenced inside the message
        "content": "$1",
        "example": "morning" // Example value for our content
      },
      "user": { 
        "content": "$1",
        "example": "Lars"
      }
    }
  }
}</code></pre>
<p>Using placeholders is a bit more challenging. At first we need to define the placeholder inside the message. A placeholder needs to be wrapped in between <code>$</code> characters. Afterwards, we have to add our placeholder to the &#8220;placeholder list.&#8221; This is a bit unintuitive, but Chrome wants to know what value should be inserted for our placeholders. We (obviously) want to use a dynamic value here, so we use the special <code>content</code> value <code>$1</code> which references our inserted value.</p>
<p>The <code>example</code> property is optional. It can be used to give translators a hint what value the placeholder could be (but is not actually displayed).</p>
<p>We need to define the following translations for our extension. Copy and paste them into the <code>messages.json</code> file. Feel free to add more languages (e.g. if you speak German, add a <code>de</code> folder inside <code>_locales</code>, and so on).</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">{
  "name": {
    "message": "Transcribers of Reddit"
  },
  "description": {
    "message": "Accessible image descriptions for subreddits."
  },
  "popupManageSettings": {
    "message": "Manage settings"
  },
  "optionsPageTitle": {
    "message": "Settings"
  },
  "sectionGeneral": {
    "message": "General settings"
  },
  "settingBorder": {
    "message": "Show comment border"
  },
  "settingBackground": {
    "message": "Show comment background"
  }
}</code></pre>
<p class="is-style-explanation">You might be wondering why we registered the permissions when there is no sign of an i18n permission, right? Chrome is a bit weird in that regard, as you don’t need to register every permission. Some (e.g. <code>chrome.i18n</code>) don’t require an entry inside the manifest. Other permissions require an entry but won’t be displayed to the user when installing the extension. Some other permissions are &#8220;hybrid&#8221; (e.g. <code>chrome.runtime</code>), meaning some of their functions can be used without declaring a permission—but other functions of the same API require one entry in the manifest. You’ll want to take a look at the <a href="https://developer.chrome.com/docs/extensions/reference/" rel="noopener">documentation</a> for a solid overview of the differences.</p>
<h4><a href="#using-translations-inside-the-manifest" aria-hidden="true" class="aal_anchor" id="aa-using-translations-inside-the-manifest"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using translations inside the manifest</h4>
<p>The first thing our end user will see is either the entry inside the Chrome Web Store or the extension overview page. We need to adjust our manifest file to make sure everything os translated.</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">{
  // Update these entries
  "name": "__MSG_name__",
  "description": "__MSG_description__"
}</code></pre>
<p>Applying this syntax uses the corresponding translation in our <code>messages.json</code> file (e.g. <code>_MSG_name_</code> uses the <code>name</code> translation).</p>
<h4><a href="#using-translations-in-html-pages" aria-hidden="true" class="aal_anchor" id="aa-using-translations-in-html-pages"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using translations in HTML pages</h4>
<p>Applying translations in an HTML file takes a little JavaScript.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">chrome.i18n.getMessage('name');</code></pre>
<p>That code returns our defined translation (which is <code>Transcribers of Reddit</code>). Placeholders can be done in a similar way.</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">chrome.i18n.getMessage('userGreeting', {
  daytime: 'morning',
  user: 'Lars'
});</code></pre>
<p>It would be a pain in the butt to apply translations to all elements this way. But we can write a little script that performs the translation based on a <code>data-</code> attribute. So, let’s create a new <code>js</code> folder inside the <code>src</code> directory, then add a new <code>util.js</code> file in it.</p>
<pre rel="" class="wp-block-csstricks-code-block language-none" data-line=""><code markup="tt">src 
 └─ js
     └─ util.js</code></pre>
<p>This gets the job done:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const i18n = document.querySelectorAll("[data-intl]");
i18n.forEach(msg => {
  msg.innerHTML = chrome.i18n.getMessage(msg.dataset.intl);
});

chrome.i18n.getAcceptLanguages(languages => {
  document.documentElement.lang = languages[0];
});</code></pre>
<p>Once that script is added to an HTML page, we can add the <code>data-intl</code> attribute to an element to set its content. The document language will also be set based on the user language.</p>
<div class="wp-block-columns">
<div class="wp-block-column">
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line=""><code markup="tt">&lt;!-- Before JS execution -->
&lt;html>
  &lt;body>
    &lt;button data-intl="popupManageSettings">&lt;/button>
  &lt;/body>
&lt;/html></code></pre>
</div>
<div class="wp-block-column">
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line=""><code markup="tt">&lt;!-- After JS execution -->
&lt;html lang="en">
  &lt;body>
    &lt;button data-intl="popupManageSettings">Manage settings&lt;/button>
  &lt;/body>
&lt;/html></code></pre>
</div>
</div>
<h3><a href="#adding-a-pop-up-and-options-page" aria-hidden="true" class="aal_anchor" id="aa-adding-a-pop-up-and-options-page"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a pop-up and options page</h3>
<p>Before we dive into actual programming, we we need to create two pages:</p>
<ol><li>An options page that contains user settings</li><li>A pop-up page that opens when interacting with the extension icon right next to our address bar. This page can be used for various scenarios (e.g. for displaying stats or quick settings).</li></ol>
<div class="wp-block-columns">
<div class="wp-block-column">
<figure class="wp-block-image size-full"><img loading="lazy" width="820" height="298" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=820%2C298&#038;ssl=1" alt class="wp-image-359621 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?w=820&amp;ssl=1 820w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=300%2C109&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=768%2C279&amp;ssl=1 768w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=820%2C298&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="820" height="298" src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=820%2C298&#038;ssl=1" alt="" class="wp-image-359621" srcset="https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?w=820&amp;ssl=1 820w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=300%2C109&amp;ssl=1 300w, https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653699948_image.png?resize=768%2C279&amp;ssl=1 768w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>The options page containg our settings.</figcaption></figure>
</div>
<div class="wp-block-column">
<figure class="wp-block-image size-full"><img loading="lazy" width="356" height="143" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?resize=356%2C143&#038;ssl=1" alt class="wp-image-359622 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?w=356&amp;ssl=1 356w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?resize=300%2C121&amp;ssl=1 300w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?resize=356%2C143&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="356" height="143" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?resize=356%2C143&#038;ssl=1" alt="" class="wp-image-359622" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?w=356&amp;ssl=1 356w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image.png?resize=300%2C121&amp;ssl=1 300w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>The pop-up containg a link to the options page.</figcaption></figure>
</div>
</div>
<p>Here’s an outline of the folders and files we need in order to make the pages:</p>
<pre rel="" class="wp-block-csstricks-code-block language-none" data-line=""><code markup="tt">src 
 ├─ css
 |    └─ paintBucket.css
 ├─ popup
 |    ├─ popup.html
 |    ├─ popup.css
 |    └─ popup.js
 └─ options
      ├─ options.html
      ├─ options.css
      └─ options.js</code></pre>
<p>The <code>.css</code> files contain plain CSS, nothing more and nothing less. I won’t into detail because I know most of you reading this are already fully aware of how CSS works. You can copy and paste the styles from the <a href="https://github.com/Lars418/torExtension/tree/main/src" rel="noopener">GitHub repository</a> for this project.</p>
<p class="is-style-explanation">Note that the pop-up is not a tab and that its size depends on the content in it. If you want to use a fixed popup size, you can set the <code>width</code> and <code>height</code> properties on the <code>html</code> element.</p>
<h4><a href="#creating-the-pop-up" aria-hidden="true" class="aal_anchor" id="aa-creating-the-pop-up"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating the pop-up</h4>
<p>Here’s an HTML skeleton that links up the CSS and JavaScript files and adds a headline and button inside the <code>&lt;body&gt;</code>.</p>
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line=""><code markup="tt">&lt;!doctype html>
&lt;html lang="en">
  &lt;head>
    &lt;meta charset="UTF-8">
    &lt;meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge">
    &lt;title data-intl="name">&lt;/title>

    &lt;link rel="stylesheet" href="../css/paintBucket.css">
    &lt;link rel="stylesheet" href="popup.css">

    &lt;!-- Our "translation" script -->
    &lt;script src="../js/util.js" defer>&lt;/script>
    &lt;script src="popup.js" defer>&lt;/script>
  &lt;/head>
  &lt;body>
    &lt;h1 id="title">&lt;/h1>
    &lt;button data-intl="popupManageSettings">&lt;/button>
  &lt;/body>
&lt;/html></code></pre>
<p>The <code>h1</code> contains the extension name and version; the <code>button</code> is used to open the options page. The headline will not be filled with a translation (because it lacks a <code>data-intl</code> attribute), and the button doesn’t have any click handler yet, so we need to populate our <code>popup.js</code> file:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const title = document.getElementById('title');
const settingsBtn = document.querySelector('button');
const manifest = chrome.runtime.getManifest();

title.textContent = `${manifest.name} (${manifest.version})`;

settingsBtn.addEventListener('click', () => {
  chrome.runtime.openOptionsPage();
});</code></pre>
<p>This script first looks for the manifest file. Chrome offers the <code>runtime</code> API which contains the <code>getManifest</code> method (this specific method does not require the <code>runtime</code> permission). It returns our <code>manifest.json</code> as a JSON object. After we populate the title with the extension name and version, we can add an event listener to the settings button. If the user interacts with it, we will open the options page using <code>chrome.runtime.openOptionsPage()</code> (again no permission entry needed).</p>
<p>The pop-up page is now finished, but the extension doesn’t know it exists yet. We have to register the pop-up by appending the following property to the <code>manifest.json</code> file.</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">"action": {
  "default_popup": "popup/popup.html",
  "default_icon": {
    "16": "images/logo/16.png",
    "48": "images/logo/48.png",
    "128": "images/logo/128.png"
  }
},</code></pre>
<h4><a href="#creating-the-options-page" aria-hidden="true" class="aal_anchor" id="aa-creating-the-options-page"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating the options page</h4>
<p>Creating this page follows a pretty similar process as what we just completed. First, we populate our <code>options.html</code> file. Here’s some markup we can use:</p>
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line=""><code markup="tt">&lt;!doctype html>
&lt;html lang="en">
&lt;head>
  &lt;meta charset="UTF-8">
  &lt;meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  &lt;meta http-equiv="X-UA-Compatible" content="ie=edge">
  &lt;title data-intl="name">&lt;/title>

  &lt;link rel="stylesheet" href="../css/paintBucket.css">
  &lt;link rel="stylesheet" href="options.css">

  &lt;!-- Our "translation" script -->
  &lt;script src="../js/util.js" defer>&lt;/script>
  &lt;script src="options.js" defer>&lt;/script>
&lt;/head>
&lt;body>
  &lt;header>
    &lt;h1>
      &lt;!-- Icon provided by feathericons.com -->
      &lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" role="presentation">
        &lt;circle cx="12" cy="12" r="3">&lt;/circle>
        &lt;path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">&lt;/path>
      &lt;/svg>
      &lt;span data-intl="optionsPageTitle">&lt;/span>
    &lt;/h1>
  &lt;/header>

  &lt;main>
    &lt;section id="generalOptions">
      &lt;h2 data-intl="sectionGeneral">&lt;/h2>

      &lt;div id="generalOptionsWrapper">&lt;/div>
    &lt;/section>
  &lt;/main>

  &lt;footer>
    &lt;p>Transcribers of Reddit extension by &lt;a href="https://lars.koelker.dev" target="_blank">lars.koelker.dev&lt;/a>.&lt;/p>
    &lt;p>Reddit is a registered trademark of Reddit, Inc. This extension is not endorsed or affiliated with Reddit, Inc. in any way.&lt;/p>
  &lt;/footer>
&lt;/body>
&lt;/html></code></pre>
<p>There are no actual options yet (just their wrappers). We need to write the script for the options page. First, we define variables to access our wrappers and default settings inside <code>options.js</code>. &#8220;Freezing&#8221; our default settings prevents us from accidentally modifying them later.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const defaultSettings = Object.freeze({
  border: false,
  background: false,
});
const generalSection = document.getElementById('generalOptionsWrapper');
</code></pre>
<p>Next, we need to load the saved settings. We can use the (previously registered) <code>storage</code> API for that. Specifically, we need to define if we want to store the data locally (<code>chrome.storage.local</code>) or sync settings through all devices the end user is logged in to (<code>chrome.storage.sync</code>). Let’s go with local storage for this project.</p>
<p>Retrieving values needs to be done with the <code>get</code> method. It accepts two arguments:</p>
<ol><li>The entries we want to load</li><li>A callback containing the values</li></ol>
<p>Our entries can either be a string (e.g. like <code>settings</code> below) or an array of entries (useful if we want to load multiple entries). The argument inside the callback function contains an object of all entries we previously defined in <code>{ settings: ... }</code>:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">chrome.storage.local.get('settings', ({ settings }) => {
  const options = settings ?? defaultSettings; // Fall back to default if settings are not defined
  if (!settings) {
    chrome.storage.local.set({
     settings: defaultSettings,
    });
 }

  // Create and display options
  const generalOptions = Object.keys(options).filter(x => !x.startsWith('advanced'));
  
  generalOptions.forEach(option => createOption(option, options, generalSection));
});</code></pre>
<p>To render the options, we also need to create a <code>createOption()</code> function.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">function createOption(setting, settingsObject, wrapper) {
  const settingWrapper = document.createElement("div");
  settingWrapper.classList.add("setting-item");
  settingWrapper.innerHTML = `
  &lt;div class="label-wrapper">
    &lt;label for="${setting}" id="${setting}Desc">
      ${chrome.i18n.getMessage(`setting${setting}`)}
    &lt;/label>
  &lt;/div>

  &lt;input type="checkbox" ${settingsObject[setting] ? 'checked' : ''} id="${setting}" />
  &lt;label for="${setting}"
    tabindex="0"
    role="switch"
    aria-checked="${settingsObject[setting]}"
    aria-describedby="${setting}-desc"
    class="is-switch"
  >&lt;/label>
  `;

  const toggleSwitch = settingWrapper.querySelector("label.is-switch");
  const input = settingWrapper.querySelector("input");

  input.onchange = () => {
    toggleSwitch.setAttribute('aria-checked', input.checked);
    updateSetting(setting, input.checked);
  };

  toggleSwitch.onkeydown = e => {
    if(e.key === " " || e.key === "Enter") {
      e.preventDefault();
      toggleSwitch.click();
    }
  }

  wrapper.appendChild(settingWrapper);
}</code></pre>
<p>Inside the <code>onchange</code> event listener of our switch (aká radio button) we call the function <code>updateSetting</code>. This method will write the updated value of our radio button inside the storage.</p>
<p>To accomplish this, we will make use of the <code>set</code> function. It has two arguments: The entry we want to overwrite and an (optional) callback (which we don’t use in our case). As our <code>settings</code> entry is not a boolean or a string but an object containing different settings, we use the spread operator (<code>…</code>) and only overwrite our actual key (setting) inside the <code>settings</code> object.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">function updateSetting(key, value) {
  chrome.storage.local.get('settings', ({ settings }) => {
    chrome.storage.local.set({
      settings: {
        ...settings,
        [key]: value
      }
    })
  });
}</code></pre>
<p>Once again, we need to &#8220;inform&#8221; the extension about our options page by appending the following entry to the <code>manifest.json</code>:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">"options_ui": {
  "open_in_tab": true,
  "page": "options/options.html"
},</code></pre>
<p>Depending on your use case you can also force the options dialog to open as a popup by setting <code>open_in_tab</code> to <code>false</code>.</p>
<h3><a href="#installing-the-extension-for-development" aria-hidden="true" class="aal_anchor" id="aa-installing-the-extension-for-development"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installing the extension for development</h3>
<p>Now that we’ve successfully set up the manifest file and have added both the pop-up and options page to the mix, we can install our extension to check if our pages actually work. Navigate to <code>chrome://extensions</code> and enable &#8220;Developer mode.&#8221; Three buttons will appear. Click the one labeled &#8220;Load unpacked&#8221; and select the <code>src</code> folder of your extension to load it up.</p>
<p>The extension should now be successfully installed and our &#8220;Transcribers of Reddit&#8221; tile should be on the page.</p>
<p>We can already interact with our extension. Click on the puzzle piece (&#x1f9e9;) icon right next to the browser’s address bar and click on the newly-added &#8220;Transcribers of Reddit&#8221; extension. You should now be greeted by a small pop-up with the button to open the options page.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="356" height="143" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?resize=356%2C143&#038;ssl=1" alt class="wp-image-359628 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?w=356&amp;ssl=1 356w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?resize=300%2C121&amp;ssl=1 300w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?resize=356%2C143&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="356" height="143" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?resize=356%2C143&#038;ssl=1" alt="" class="wp-image-359628" srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?w=356&amp;ssl=1 356w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1636653810349_image-1.png?resize=300%2C121&amp;ssl=1 300w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>Lovely, right? It might look a bit different on your device, as I have dark mode enabled in these screenshots.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1129" height="382" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1129%2C382&#038;ssl=1" alt class="wp-image-359629 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?w=1129&amp;ssl=1 1129w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=300%2C102&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1024%2C346&amp;ssl=1 1024w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=768%2C260&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1000%2C338&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1129%2C382&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1129" height="382" src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1129%2C382&#038;ssl=1" alt="" class="wp-image-359629" srcset="https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?w=1129&amp;ssl=1 1129w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=300%2C102&amp;ssl=1 300w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1024%2C346&amp;ssl=1 1024w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=768%2C260&amp;ssl=1 768w, https://i2.wp.com/css-tricks.com/wp-content/uploads/2021/12/settings-page-reddit.png?resize=1000%2C338&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>If you enable the &#8220;Show comment background&#8221; and &#8220;Show comment border&#8221; settings, then reload the page, the state will persist because we’re saving it in the browser’s local storage.</p>
<h3><a href="#adding-the-content-script" aria-hidden="true" class="aal_anchor" id="aa-adding-the-content-script"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding the content script</h3>
<p>OK, so we can already trigger the pop-up and interact with the extension settings, but the extension doesn’t do anything particularly useful yet. To give it some life, we will add a content script.</p>
<p>Add a file called <code>comment.js</code> inside the <code>js</code> directory and make sure to define it in the <code>manifest.json</code> file:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">"content_scripts": [
  {
    "matches": [ "*://www.reddit.com/*" ],
    "js": [ "js/comment.js" ]
  }
],</code></pre>
<p>The <code>content_scripts</code> is made up of two parts:</p>
<ul><li><code>matches</code>: This array holds URLs that tell the browser where we want our content scripts to run. Being an extension for Reddit and all, we want this to run on any page matching <code>://www.redit.com/*</code>, where the asterisk is a wild card to match anything after the top-level domain.</li><li><code>js</code>: This array contains the actual content scripts.</li></ul>
<p>Content scripts can’t interact with other (normal) JavaScripts. This means if a website’s scripts defines a variable or function, we can’t access it. For example:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">// script_on_website.js
const username = 'Lars';

// content_script.js
console.log(username); // Error: username is not defined</code></pre>
<p>Now let’s start writing our content script. First, we add some constants to <code>comment.js</code>. These constants contain RegEx expressions and selectors that will be used later on. The <code>CommentUtils</code> is used to determine whether or not a post contains a &#8220;tor comment,&#8221; or if comment wrappers exists.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const messageTypes = Object.freeze({
  COMMENT_PAGE: 'comment_page',
  SUBREDDIT_PAGE: 'subreddit_page',
  MAIN_PAGE: 'main_page',
  OTHER_PAGE: 'other_page',
});

const Selectors = Object.freeze({
  commentWrapper: 'div[style*="--commentswrapper-gradient-color"] > div, div[style*="max-height: unset"] > div',
  torComment: 'div[data-tor-comment]',
  postContent: 'div[data-test-id="post-content"]'
});

const UrlRegex = Object.freeze({
  commentPage: /\/r\/.*\/comments\/.*/,
  subredditPage: /\/r\/.*\//
});

const CommentUtils = Object.freeze({
  isTorComment: (comment) => comment.querySelector('[data-test-id="comment"]') ? comment.querySelector('[data-test-id="comment"]').textContent.includes('m a human volunteer content transcriber for Reddit') : false,
  torCommentsExist: () => !!document.querySelector(Selectors.torComment),
  commentWrapperExists: () => !!document.querySelector('[data-reddit-comment-wrapper="true"]')
});</code></pre>
<p>Next, we check whether or not a user directly opens a comment page (&#8220;post&#8221;), then perform a RegEx check and update the <code>directPage</code> variable. This case occurs when a user directly opens the URL (e.g. by typing it into the address bar or clicking on<code>&lt;a&gt;</code> element on another page, like Twitter).</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">let directPage = false;
if (UrlRegex.commentPage.test(window.location.href)) {
  directPage = true;
  moveComments();
}</code></pre>
<p>Besides opening a page directly, a user normally interacts with the SPA. To catch this case, we can add a message listener to our <code>comment.js</code> file by using the <code>runtime</code> API.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">chrome.runtime.onMessage.addListener(msg => {
  if (msg.type === messageTypes.COMMENT_PAGE) {
    waitForComment(moveComments);
  }
});</code></pre>
<p>All we need now are the functions. Let’s create a <code>moveComments()</code> function. It moves the special &#8220;tor comment&#8221; to the start of the comment section. It also conditionally applies a background color and border (if borders are enabled in the settings) to the comment. For this, we call the <code>storage</code> API and load the <code>settings</code> entry:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">function moveComments() {
  if (CommentUtils.commentWrapperExists()) {
    return;
  }

  const wrapper = document.querySelector(Selectors.commentWrapper);
  let comments = wrapper.querySelectorAll(`${Selectors.commentWrapper} > div`);
  const postContent = document.querySelector(Selectors.postContent);

  wrapper.dataset.redditCommentWrapper = 'true';
  wrapper.style.flexDirection = 'column';
  wrapper.style.display = 'flex';

  if (directPage) {
    comments = document.querySelectorAll("[data-reddit-comment-wrapper='true'] > div");
  }

  chrome.storage.local.get('settings', ({ settings }) => { // HIGHLIGHT 18
    comments.forEach(comment => {
      if (CommentUtils.isTorComment(comment)) {
        comment.dataset.torComment = 'true';
        if (settings.background) {
          comment.style.backgroundColor = 'var(--newCommunityTheme-buttonAlpha05)';
        }
        if (settings.border) {
          comment.style.outline = '2px solid red';
        }
        comment.style.order = "-1";
        applyWaiAria(postContent, comment);
      }
    });
  })
}</code></pre>
<p>The <code>applyWaiAria()</code> function is called inside the <code>moveComments()</code> function—it adds <code>aria-</code> attributes. The other function creates a unique identifier for use with the <code>aria-</code> attributes.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">function applyWaiAria(postContent, comment) {
  const postMedia = postContent.querySelector('img[class*="ImageBox-image"], video');
  const commentId = uuidv4();

  if (!postMedia) {
    return;
  }

  comment.setAttribute('id', commentId);
  postMedia.setAttribute('aria-describedby', commentId);
}

function uuidv4() {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r &amp; 0x3 | 0x8);
    return v.toString(16);
  });
}</code></pre>
<p>The following function waits for the comments to load and calls the <code>callback</code> parameter if it finds the comment wrapper.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">function waitForComment(callback) {
  const config = { childList: true, subtree: true };
  const observer = new MutationObserver(mutations => {
    for (const mutation of mutations) {
      if (document.querySelector(Selectors.commentWrapper)) {
        callback();
        observer.disconnect();
        clearTimeout(timeout);
        break;
      }
    }
  });

  observer.observe(document.documentElement, config);
  const timeout = startObservingTimeout(observer, 10);
}

function startObservingTimeout(observer, seconds) {
  return setTimeout(() => {
    observer.disconnect();
  }, 1000 * seconds);
}</code></pre>
<h3><a href="#adding-a-service-worker" aria-hidden="true" class="aal_anchor" id="aa-adding-a-service-worker"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding a service worker</h3>
<p>Remember when we added a listener for messages inside the content script? This listener isn&#8217;t currently receiving messages. We need to send it to the content script ourselves. For this purpose we need to register a service worker.</p>
<p>We have to register our service worker inside the <code>manifest.json</code> by appending the following code to it:</p>
<pre rel="JSON" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">"background": {
  "service_worker": "sw.js"
}</code></pre>
<p>Don’t forget to create the <code>sw.js</code> file inside the <code>src</code> directory (service workers always need to be created in the extension’s root directory, <code>src</code>.</p>
<p>Now, let’s create some constants for the message and page types:</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">const messageTypes = Object.freeze({
  COMMENT_PAGE: 'comment_page',
  SUBREDDIT_PAGE: 'subreddit_page',
  MAIN_PAGE: 'main_page',
  OTHER_PAGE: 'other_page',
});

const UrlRegex = Object.freeze({
  commentPage: /\/r\/.*\/comments\/.*/,
  subredditPage: /\/r\/.*\//
});

const Utils = Object.freeze({
  getPageType: (url) => {
    if (new URL(url).pathname === '/') {
      return messageTypes.MAIN_PAGE;
    } else if (UrlRegex.commentPage.test(url)) {
      return messageTypes.COMMENT_PAGE;
    } else if (UrlRegex.subredditPage.test(url)) {
      return messageTypes.SUBREDDIT_PAGE;
    }

    return messageTypes.OTHER_PAGE;
  }
});</code></pre>
<p>We can add the service worker’s actual content. We do this with an event listener on the history state (<code>onHistoryStateUpdated</code>) that detects when a page has been updated with the <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API" rel="noopener">History API</a> (which is commonly used in SPAs to navigate without a page refresh). Inside this listener, we query the active tab and extract its <code>tabId</code>. Then we send a message to our content script containing the page type and URL.</p>
<pre rel="JavaScript" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">chrome.webNavigation.onHistoryStateUpdated.addListener(async ({ url }) => {
  const [{ id: tabId }] = await chrome.tabs.query({ active: true, currentWindow: true });

  chrome.tabs.sendMessage(tabId, {
    type: Utils.getPageType(url),
    url
  });
});</code></pre>
<h3><a href="#all-done" aria-hidden="true" class="aal_anchor" id="aa-all-done"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>All done!</h3>
<p>We’re finished! Navigate to Chrome’s extension management page ( <code>chrome://extensions</code>) and hit the reload icon on the unpacked extension. If you open a Reddit post that contains a &#8220;Transcribers of Reddit&#8221; comment with an image transcription (like <a href="https://www.reddit.com/r/ProgrammerHumor/comments/oi8e26/why_would_you_hurt_me_in_such_a_way_the/" rel="noopener">this one</a>), it will be moved to the start of the comment section and be highlighted as long as we’ve enabled it in the extension settings.</p>
<figure class="wp-block-image size-full"><img loading="lazy" width="1270" height="1332" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=1270%2C1332&#038;ssl=1" alt class="wp-image-359633 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?w=1270&amp;ssl=1 1270w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=286%2C300&amp;ssl=1 286w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=976%2C1024&amp;ssl=1 976w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=768%2C805&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=1000%2C1049&amp;ssl=1 1000w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=1270%2C1332&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="1270" height="1332" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=1270%2C1332&#038;ssl=1" alt="" class="wp-image-359633" srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?w=1270&amp;ssl=1 1270w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=286%2C300&amp;ssl=1 286w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=976%2C1024&amp;ssl=1 976w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=768%2C805&amp;ssl=1 768w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/12/s_1394379B6F411105A5BC2102DF48E9E66D4E0B302B5D9E367CAC2817C815F29E_1635293829919_Screenshot2021-10-27at02.16.01.png?resize=1000%2C1049&amp;ssl=1 1000w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript><figcaption>The &#8220;Transcribers of Reddit&#8221; extension highlights a particular comment by moving it to the top of the Reddit thread’s comment list and giving it a bright red border</figcaption></figure>
<h3><a href="#conclusion" aria-hidden="true" class="aal_anchor" id="aa-conclusion"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h3>
<p>Was that as hard as you thought it would be? It’s definitely a lot more straightforward than I thought before digging in. After setting up the <code>manifest.json</code> and creating any page files and assets we need, all we’re really doing is writing HTML, CSS, and JavaScript like normal.</p>
<p>If you ever find yourself stuck along the way, the <a href="https://developer.chrome.com/docs/extensions/reference/" rel="noopener">Chrome API</a> documentation is a great resource to get back on track.</p>
<p>Once again, <a href="https://github.com/Lars418/torExtension" rel="noopener">here’s the GitHub repo</a> with all of the code we walked through in this article. Read it, use it, and let me know what you think of it!</p>
</div>
</article>
</main>
<div class="entry-unrelated sidebar">
<div id="all-modules">
<div id="scroll-ad-position"></div>
<div id="sticky-sidebar-stuff">
<div class="fem-conditional-message">
<div class="fem-ad fem-sidebar-ad">
<div class="fem-header">
<div class="fem-header-inner">
<div class="fem-learning-partner">
Our Learning Partner
</div>
<a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar"><img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1578251803/FEM-sidebar-Generic_dipjef.png" alt="Frontend Masters logo" class="fem-logo" /></a>
<div class="fem-title">
Frontend Masters
</div>
</div>
</div>
 <div class="fem-message">
<h4>Need front-end development training?</h4>
<p><a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Frontend Masters</a> is the best place to get it. They have courses on all the most important front-end technologies, from <a href="https://frontendmasters.com/learn/react/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">React</a> to <a href="https://frontendmasters.com/learn/css/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">CSS</a>, from <a href="https://frontendmasters.com/learn/vue/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Vue</a> to <a href="https://frontendmasters.com/learn/d3-js/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">D3</a>, and beyond with <a href="https://frontendmasters.com/learn/node-js/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Node.js</a> and <a href="https://frontendmasters.com/learn/fullstack/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Full Stack</a>.</p>
</div>
</div>
</div> </div>
</div>
</div>
</div>
<div class="related-ads-comments-wrap">
<div class="related-ads-comments">
<div class="end-of-article-ads">
<div class="bsap-doubles side-by-side">
<div id="bsap_1250418" class="bsarocks bsap_3469a2a501a9e18091036aa0c89f9dcb"></div>
</div>
<div class="fem-conditional-message">
<div class="fem-ad fem-footer-ad">
<div class="fem-header">
<div class="fem-header-inner">
<a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar"><img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1578251803/FEM-footer-Generic_fgvhuc.png" alt="Frontend Masters logo" class="fem-logo-large" /></a>
</div>
</div>
<div class="fem-message">
<div>
<h4>Need front-end development training?</h4>
<p><a href="https://frontendmasters.com/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Frontend Masters</a> is the best place to get it. They have courses on all the most important front-end technologies, from <a href="https://frontendmasters.com/learn/react/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">React</a> to <a href="https://frontendmasters.com/learn/css/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">CSS</a>, from <a href="https://frontendmasters.com/learn/vue/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Vue</a> to <a href="https://frontendmasters.com/learn/d3-js/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">D3</a>, and beyond with <a href="https://frontendmasters.com/learn/node-js/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Node.js</a> and <a href="https://frontendmasters.com/learn/fullstack/?utm_source=css-tricks&utm_medium=website&utm_campaign=css-tricks-tags-sidebar">Full Stack</a>.</p>
</div>
</div>
</div>
</div>
</div>
<section class="respond-area">
<div class="respond">
<div class="comment-form-form-area">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/how-to-create-a-browser-extension/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://css-tricks.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<input type="hidden" name="_mc4wp_subscribe_wp-comment-form" value="0" /><p class=" mc4wp-checkbox mc4wp-checkbox-wp-comment-form"><label><input type="checkbox" name="_mc4wp_subscribe_wp-comment-form" value="1" checked="checked" /><span>Get the CSS-Tricks newsletter</span></label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='359615' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="7570700c3c" /></p> <p class="antispam-group antispam-group-q" style="clear: both;">
<label>Copy and paste this code: <strong class="antspmpro-input-a">micuno</strong> <span class="required">*</span></label>
<input type="hidden" name="antspmpro-a" class="antispam-control antispam-control-a" value="micuno" />
<input type="text" name="antspmpro-q-luwele" class="antispam-control antispam-control-q" value="4.1" />
</p>
<p class="antispam-group antispam-group-e" style="display: none;">
<label>Leave this field empty</label>
<input type="text" name="antspmpro-e-email-url-website-luwele" class="antispam-control antispam-control-e" value="" />
</p>
<p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="31" /></p></form> </div>
</div>
</div>
</section> <div class="related-posts">
<div id='jp-relatedposts' class='jp-relatedposts'>
</div> <div class="jetpack-sponsored-posts-message">
<img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1590422774/jetpack-logo_cegyqg.svg" alt="Jetpack Logo">
<p>The related posts above were algorithmically generated and displayed here without any load on our servers at all, <a href="https://jetpack.com/support/related-posts/?aff=8638">thanks to Jetpack</a>.</p>
</div>
</div> </div>
</div>
</div>
<footer class="site-footer">
<svg class="icon-logo-star" width="35px" height="35px" viewBox="0 0 362.62 388.52" data-spin-me="false">
<path d="M156.58,239l-88.3,64.75c-10.59,7.06-18.84,11.77-29.43,11.77-21.19,0-38.85-18.84-38.85-40C0,257.83,14.13,244.88,27.08,239l103.6-44.74L27.08,148.34C13,142.46,0,129.51,0,111.85,0,90.66,18.84,73,40,73c10.6,0,17.66,3.53,28.25,11.77l88.3,64.75L144.81,44.74C141.28,20,157.76,0,181.31,0s40,18.84,36.5,43.56L206,149.52l88.3-64.75C304.93,76.53,313.17,73,323.77,73a39.2,39.2,0,0,1,38.85,38.85c0,18.84-12.95,30.61-27.08,36.5L231.93,194.26,335.54,239c14.13,5.88,27.08,18.83,27.08,37.67,0,21.19-18.84,38.85-40,38.85-9.42,0-17.66-4.71-28.26-11.77L206,239l11.77,104.78c3.53,24.72-12.95,44.74-36.5,44.74s-40-18.84-36.5-43.56Z" />
</svg>
<div class="footer-inside">
<div class="footer-message-and-form">
<p class="colophon">
CSS-Tricks is created by <a href="https://chriscoyier.net">Chris</a> and a <a href="/about">team</a> of swell&nbsp;people.
</p>
<div class="footer-form-wrap">
<form action="https://chriscoyier.us2.list-manage.com/subscribe/post?u=155f5a9ccc4e24c318130cace&amp;id=197f127a68" method="post" id="mc-embedded-subscribe-form">
<h4>Keep up to date on web dev</h4>
<p>with our hand-crafted weekly newsletter</p>
<div class="footer-form">
<label for="mce-EMAIL" class="screen-reader">Email Address</label>
<input type="email" name="EMAIL" class="required email mailchimp-email-input" id="mce-EMAIL" placeholder="smart@cookie.com" required="">
<input type="submit" value="Subscribe" name="Subscribe" id="mc-embedded-subscribe" class="button subscribe-button">
</div>
</form>
</div> </div>
<div class="link-grid">
<div>
<div>
<h5>
Tech
</h5>
<ul>
<li><a href="https://wordpress.org/">WordPress</a> <span>(CMS)</span></li>
<li><a href="/jetpack/">Jetpack</a> <span>(Search, Backup)</span></li>
<li><a href="https://woocommerce.com/?aff=8638">WooCommerce</a> <span>(eCommerce)</span></li>
<li><a href="https://localwp.com/">Local</a> <span>(Development)</span></li>
</ul>
</div>
<div>
<h5>Hosting</h5>
<ul>
<li><a href="https://share.getf.ly/k96n2f">Flywheel</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Family</h5>
<ul>
<li><a href="https://codepen.io/">CodePen</a></li>
<li><a href="https://shoptalkshow.com/">ShopTalk Show</a></li>
</ul>
</div>
<div>
<h5>Minisites</h5>
<ul>
<li><a href="https://serverless.css-tricks.com/">The Power of Serverless</a></li>
<li><a href="https://conferences.css-tricks.com/">Upcoming Conferences</a></li>
<li><a href="https://coding-fonts.css-tricks.com/">Coding Fonts</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Contact</h5>
<ul>
<li><a href="/cdn-cgi/l/email-protection#a1d5c4c0cce1c2d2d28cd5d3c8c2cad28fc2cecc">Email</a></li>
<li><a href="https://www.notion.so/csstricks/Sponsorship-Possibilities-cb5b33a3f6f64c239220547fe7965d78">Sponsorship Info</a></li>
<li><a href="/guest-writing-for-css-tricks/">Guest Writing</a></li>
</ul>
</div>
<div>
<h5>Buy</h5>
<ul>
<li><a href="/shop/">Posters & Swag</a></li>
<li><a href="/product/mvp-supporter/">Membership</a></li>
</ul>
</div>
</div>
<div>
<div>
<h5>Follow</h5>
<ul>
<li><a href="https://twitter.com/css">Twitter</a></li>
<li><a href="https://www.instagram.com/real_css_tricks/">Instagram</a></li>
<li><a href="https://www.youtube.com/user/realcsstricks">YouTube</a></li>
<li><a href="https://codepen.io/team/css-tricks">CodePen</a></li>
<li><a href="https://github.com/CSS-Tricks">GitHub</a></li>
<li><a href="https://podcasts.apple.com/us/podcast/css-tricks-screencasts/id273881728">iTunes</a></li>
<li><a href="/feed/">RSS</a></li>
</ul>
</div>
</div>
</div>
</div>
<a href="#top-of-site" class="top-of-site-link" data-visible="false">
<span class="screen-reader-text">Back to Top</span>
<svg width="32" height="32" viewBox="0 0 100 100">
<path fill="white" d="m50 0c-13.262 0-25.98 5.2695-35.355 14.645s-14.645 22.094-14.645 35.355 5.2695 25.98 14.645 35.355 22.094 14.645 35.355 14.645 25.98-5.2695 35.355-14.645 14.645-22.094 14.645-35.355-5.2695-25.98-14.645-35.355-22.094-14.645-35.355-14.645zm20.832 62.5-20.832-22.457-20.625 22.457c-1.207 0.74219-2.7656 0.57812-3.7891-0.39844-1.0273-0.98047-1.2695-2.5273-0.58594-3.7695l22.918-25c0.60156-0.61328 1.4297-0.96094 2.2891-0.96094 0.86328 0 1.6914 0.34766 2.293 0.96094l22.918 25c0.88672 1.2891 0.6875 3.0352-0.47266 4.0898-1.1562 1.0508-2.9141 1.0859-4.1133 0.078125z" />
</svg>
</a>
</footer>
<div class="jetpack-instant-search__widget-area" style="display: none">
<div id="media_image-3" class="widget widget_media_image"><a href="https://jetpack.com/upgrade/search/?aff=8638"><img width="600" height="444" src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?fit=600%2C444&amp;ssl=1" class="image wp-image-321694  attachment-full size-full jetpack-lazy-image" alt="" loading="lazy" style="max-width: 100%; height: auto;" data-lazy-srcset="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?w=600&amp;ssl=1 600w, https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?resize=300%2C222&amp;ssl=1 300w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/09/Jetpack-Search-on-CSS-Tricks-Instant-Search.png?fit=600%2C444&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" /></a></div><div id="jetpack-search-filters-5" class="widget jetpack-filters widget_search"> <div id="jetpack-search-filters-5-wrapper" class="jetpack-instant-search-wrapper">
</div></div> </div>

<svg width="0" height="0" class="screen-reader">
<defs>
<linearGradient id="orange-to-pink" x1="0" x2="1" y1="0" y2="1">
<stop offset="0%" stop-color="#ff7a18" />
<stop offset="40%" stop-color="#af002d" />
<stop offset="100%" stop-color="#319197" />
</linearGradient>
<filter id="duotone_orange_pink">
<feColorMatrix type="matrix" result="grayscale" values="1 0 0 0 0
                  1 0 0 0 0
                  1 0 0 0 0
                  0 0 0 1 0">
</feColorMatrix>
<feComponentTransfer color-interpolation-filters="sRGB" result="duotone">
<feFuncR type="table" tableValues="0.7411764706 0.9882352941"></feFuncR>
<feFuncG type="table" tableValues="0.0431372549 0.7333333333"></feFuncG>
<feFuncB type="table" tableValues="0.568627451 0.05098039216"></feFuncB>
<feFuncA type="table" tableValues="0 1"></feFuncA>
</feComponentTransfer>
</filter>
</defs>
</svg>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="application/ld+json" class="rank-math-schema-pro">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://css-tricks.com/#organization","name":"CSS-Tricks","logo":{"@type":"ImageObject","@id":"https://css-tricks.com/#logo","url":"https://css-tricks.com/wp-content/uploads/2019/06/akqRGyta_400x400.jpg","caption":"CSS-Tricks","inLanguage":"en-US"}},{"@type":"WebSite","@id":"https://css-tricks.com/#website","url":"https://css-tricks.com","name":"CSS-Tricks","publisher":{"@id":"https://css-tricks.com/#organization"},"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/unnamed-file.png?fit=1200%2C600&amp;ssl=1","url":"https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/unnamed-file.png?fit=1200%2C600&amp;ssl=1","width":"1200","height":"600","inLanguage":"en-US"},{"@type":"Person","@id":"https://css-tricks.com/author/larskoelker/","name":"Lars K\u00f6lker","url":"https://css-tricks.com/author/larskoelker/","image":{"@type":"ImageObject","@id":"https://secure.gravatar.com/avatar/ee4fd462cb0f725f18d27a2f4dcbf275?s=96&amp;d=retro&amp;r=pg","url":"https://secure.gravatar.com/avatar/ee4fd462cb0f725f18d27a2f4dcbf275?s=96&amp;d=retro&amp;r=pg","caption":"Lars K\u00f6lker","inLanguage":"en-US"},"sameAs":["https://lars.koelker.dev"],"worksFor":{"@id":"https://css-tricks.com/#organization"}},{"@type":"WebPage","@id":"https://css-tricks.com/how-to-create-a-browser-extension/#webpage","url":"https://css-tricks.com/how-to-create-a-browser-extension/","name":"How to Create a Browser Extension | CSS-Tricks","datePublished":"2022-01-03T07:12:31-08:00","dateModified":"2022-01-03T07:12:34-08:00","author":{"@id":"https://css-tricks.com/author/larskoelker/"},"isPartOf":{"@id":"https://css-tricks.com/#website"},"primaryImageOfPage":{"@id":"https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/unnamed-file.png?fit=1200%2C600&amp;ssl=1"},"inLanguage":"en-US"},{"@type":"BlogPosting","headline":"How to Create a Browser Extension | CSS-Tricks","datePublished":"2022-01-03T07:12:31-08:00","dateModified":"2022-01-03T07:12:34-08:00","author":{"@id":"https://css-tricks.com/author/larskoelker/"},"publisher":{"@id":"https://css-tricks.com/#organization"},"description":"I\u2019ll bet you are using browser extensions right now. Some of them are extremely popular and useful, like ad blockers, password managers, and PDF viewers.","name":"How to Create a Browser Extension | CSS-Tricks","@id":"https://css-tricks.com/how-to-create-a-browser-extension/#richSnippet","isPartOf":{"@id":"https://css-tricks.com/how-to-create-a-browser-extension/#webpage"},"image":{"@id":"https://i1.wp.com/css-tricks.com/wp-content/uploads/2021/12/unnamed-file.png?fit=1200%2C600&amp;ssl=1"},"inLanguage":"en-US","mainEntityOfPage":{"@id":"https://css-tricks.com/how-to-create-a-browser-extension/#webpage"}}]}</script><script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script><script src='https://c0.wp.com/p/jetpack/10.4/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script><script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script><script defer data-domain="css-tricks.com" data-api="/plausible-proxy/api/event" src="/plausible-proxy/js/script.js"></script><script>
  var articleYear = 2022;
  var articleAuthor = "287687";
  var articleType = "post";
</script><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script><script>window.addEventListener('load', function() {
				document.querySelectorAll('link').forEach(function(e) {'not all' === e.media && e.dataset.media && (e.media=e.dataset.media,delete e.dataset.media)});
				var e = document.getElementById('jetpack-boost-critical-css');
				e && (e.media = 'not all');
			});</script><script type="text/javascript">
		(function () {
			var c = document.body.className;
			c = c.replace(/woocommerce-no-js/, 'woocommerce-js');
			document.body.className = c;
		})();
	</script><script src='https://c0.wp.com/p/jetpack/10.4/_inc/build/photon/photon.min.js' id='jetpack-photon-js'></script><script src='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/jquery-3.5.1.min.js' id='jquery-js'></script><script type='text/javascript' id='antispampro-script-js-extra'>
/* <![CDATA[ */
var antispampro_vars = {"code":"micuno","input_name_suffix":"luwele"};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/anti-spam-pro/js/anti-spam-pro-4.1.js' id='antispampro-script-js'></script><script type='text/javascript' id='jetpack-live-comment-markdown-js-extra'>
/* <![CDATA[ */
var markdownify = {"ajax_url":"\/wp-admin\/admin-ajax.php","nonce":"4c17c56066"};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack-markdown-live-preview-comments/js/markdownify.js?ver=1' id='jetpack-live-comment-markdown-js'></script><script src='https://c0.wp.com/c/5.8.2/wp-includes/js/dist/vendor/regenerator-runtime.min.js' id='regenerator-runtime-js'></script><script src='https://c0.wp.com/c/5.8.2/wp-includes/js/dist/vendor/wp-polyfill.min.js' id='wp-polyfill-js'></script><script src='https://c0.wp.com/c/5.8.2/wp-includes/js/dist/hooks.min.js' id='wp-hooks-js'></script><script src='https://c0.wp.com/c/5.8.2/wp-includes/js/dist/i18n.min.js' id='wp-i18n-js'></script><script id='wp-i18n-js-after'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script><script id='jetpack-instant-search-js-translations'>
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "jetpack", { "locale_data": { "messages": { "": {} } } } );
</script><script id='jetpack-instant-search-js-before'>
var JetpackInstantSearchOptions=JSON.parse(decodeURIComponent("%7B%22overlayOptions%22%3A%7B%22colorTheme%22%3A%22dark%22%2C%22enableInfScroll%22%3Afalse%2C%22enableSort%22%3Atrue%2C%22highlightColor%22%3A%22%23f4af38%22%2C%22overlayTrigger%22%3A%22results%22%2C%22resultFormat%22%3A%22expanded%22%2C%22showPoweredBy%22%3Atrue%2C%22defaultSort%22%3A%22relevance%22%2C%22excludedPostTypes%22%3A%5B%22attachment%22%2C%22screenshot%22%5D%7D%2C%22homeUrl%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%22%2C%22locale%22%3A%22en-US%22%2C%22postsPerPage%22%3A11%2C%22siteId%22%3A45537868%2C%22postTypes%22%3A%7B%22post%22%3A%7B%22singular_name%22%3A%22Post%22%2C%22name%22%3A%22Posts%22%7D%2C%22page%22%3A%7B%22singular_name%22%3A%22Page%22%2C%22name%22%3A%22Pages%22%7D%2C%22attachment%22%3A%7B%22singular_name%22%3A%22Media%22%2C%22name%22%3A%22Media%22%7D%2C%22product%22%3A%7B%22singular_name%22%3A%22Product%22%2C%22name%22%3A%22Products%22%7D%2C%22screenshot%22%3A%7B%22singular_name%22%3A%22Screenshot%22%2C%22name%22%3A%22Screenshots%22%7D%2C%22guides%22%3A%7B%22singular_name%22%3A%22Guide%22%2C%22name%22%3A%22Guides%22%7D%2C%22newsletters%22%3A%7B%22singular_name%22%3A%22Newsletter%22%2C%22name%22%3A%22Newsletters%22%7D%2C%22chapters%22%3A%7B%22singular_name%22%3A%22Chapter%22%2C%22name%22%3A%22Chapters%22%7D%7D%2C%22webpackPublicPath%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%5C%2Fwp-content%5C%2Fplugins%5C%2Fjetpack%5C%2F_inc%5C%2Fbuild%5C%2Finstant-search%5C%2F%22%2C%22isPhotonEnabled%22%3Atrue%2C%22apiRoot%22%3A%22https%3A%5C%2F%5C%2Fcss-tricks.com%5C%2Fwp-json%5C%2F%22%2C%22apiNonce%22%3A%225fc15eddc1%22%2C%22isPrivateSite%22%3Afalse%2C%22isWpcom%22%3Afalse%2C%22hasOverlayWidgets%22%3Atrue%2C%22widgets%22%3A%5B%7B%22filters%22%3A%5B%7B%22name%22%3A%22Post%20Types%22%2C%22type%22%3A%22post_type%22%2C%22count%22%3A5%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22post_type_0%22%7D%2C%7B%22name%22%3A%22Year%22%2C%22type%22%3A%22date_histogram%22%2C%22count%22%3A1%2C%22field%22%3A%22post_date%22%2C%22interval%22%3A%22year%22%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22date_histogram_1%22%7D%2C%7B%22name%22%3A%22Tags%22%2C%22type%22%3A%22taxonomy%22%2C%22taxonomy%22%3A%22post_tag%22%2C%22count%22%3A5%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%2C%22filter_id%22%3A%22taxonomy_2%22%7D%5D%2C%22widget_id%22%3A%22jetpack-search-filters-5%22%7D%5D%2C%22widgetsOutsideOverlay%22%3A%5B%5D%2C%22hasNonSearchWidgets%22%3Atrue%2C%22adminQueryFilter%22%3A%7B%22bool%22%3A%7B%22should%22%3A%5B%7B%22term%22%3A%7B%22post_type%22%3A%22post%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22page%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22newsletters%22%7D%7D%2C%7B%22term%22%3A%7B%22post_type%22%3A%22chapters%22%7D%7D%5D%7D%7D%7D"));
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "jetpack", { "locale_data": { "messages": { "": {} } } } );
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack/_inc/build/instant-search/jp-search-main.js?minify=false&#038;ver=f16c2efe978f910ec87858f96585dd1b' id='jetpack-instant-search-js'></script><script src='//stats.wp.com/w.js?ver=202201' id='jp-tracks-js'></script><script src='https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/comment-reply.min.js?ver=1.1' id='my-comment-reply-js'></script><script src='https://css-tricks.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/dist/intersection-observer.js?minify=false&#038;ver=2d4bf43f398489795f1893179047a63c' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script><script type='text/javascript' id='jetpack-lazy-images-js-extra'>
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script><script src='https://css-tricks.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/dist/lazy-images.js?minify=false&#038;ver=1c8bb5930b723e669774487342a8fa98' id='jetpack-lazy-images-js'></script><script type="text/javascript">
jQuery(function($) { 

			$( '.add_to_cart_button:not(.product_type_variable, .product_type_grouped)' ).on( 'click', function() {
				gtag( 'event', 'add_to_cart', { 'event_category': 'ecommerce', 'event_label': ($(this).data('product_sku')) ? ($(this).data('product_sku')) : ('#' + $(this).data('product_id')), 'items': [ {'id': ($(this).data('product_sku')) ? ($(this).data('product_sku')) : ('#' + $(this).data('product_id')),'quantity': $(this).data('quantity')} ] } );
			});
		
 });
</script><script src='https://stats.wp.com/e-202201.js' defer></script><script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.4',blog:'45537868',post:'359615',tz:'-8',srv:'css-tricks.com'} ]);
	_stq.push([ 'clickTrackerInit', '45537868', '359615' ]);
</script><script>
    window.activeMember = false;
  </script><script src="https://css-tricks.com/wp-content/themes/CSS-Tricks-19/js/min/global-concat.min.js?cache_bust=1636061739380"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-68528-29', 'auto');

  if (typeof articleYear !== "undefined") {
    ga('set', 'dimension1', articleYear);
  }
  if (typeof articleAuthor !== "undefined") {
    ga('set', 'dimension2', articleAuthor);
  }
  if (typeof articleType !== "undefined") {
    ga('set', 'dimension3', articleType);
  }

  ga('send', 'pageview');
</script><script async src="https://static.codepen.io/assets/embed/ei.js"></script><script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon='{"rayId":"6cb24057998c5a16","token":"2863ac31b15c48f5b94bd8b0c38aba94","version":"2021.12.0","si":100}' crossorigin="anonymous"></script>
</body>
</html>