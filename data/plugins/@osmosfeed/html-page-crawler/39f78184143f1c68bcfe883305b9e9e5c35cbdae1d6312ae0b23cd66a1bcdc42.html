

<!doctype html>
<html lang="en-US">
<head data-template-path="https://hacks.mozilla.org/wp-content/themes/Hax">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="w2ocEMd5yV9IsGCjhq-7ls67r4VH-Ob6oWdiZpqjN8U">

  
  <meta name="title" content="How MDN&#8217;s autocomplete search works – Mozilla Hacks - the Web developer blog">

    <meta property="og:site_name" content="Mozilla Hacks &#8211; the Web developer blog">
  <meta property="og:url" content="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search">
  <meta property="og:title" content="How MDN&#8217;s autocomplete search works – Mozilla Hacks - the Web developer blog">
  <meta property="og:description" content="Autocomplete search added to MDN Web Docs allows you to quickly jump to the document you're looking for by typing parts of the document title">
  <meta property="og:image" content="https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1.png">
  <meta property="og:image:width" content="816">
  <meta property="og:image:height" content="1508">

    <meta property="twitter:title" content="How MDN&#8217;s autocomplete search works – Mozilla Hacks - the Web developer blog">
  <meta property="twitter:description" content="Autocomplete search added to MDN Web Docs allows you to quickly jump to the document you're looking for by typing parts of the document title">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1.png">
  <meta name="twitter:site" content="@mozhacks">

  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/style.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/8.6.0/styles/solarized_light.min.css">

  <script type="text/javascript">
    window.hacks = {};
    // http://cfsimplicity.com/61/removing-analytics-clutter-from-campaign-urls
    var removeUtms  =   function(){
        var l = window.location;
        if( l.hash.indexOf( "utm" ) != -1 ){
            var anchor = l.hash.match(/#(?!utm)[^&]+/);
            anchor  =   anchor? anchor[0]: '';
            if(!anchor && window.history.replaceState){
                history.replaceState({},'', l.pathname + l.search);
            } else {
                l.hash = anchor;
            }
        };
    };

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35433268-8'],
              ['_setAllowAnchor', true]);
    _gaq.push (['_gat._anonymizeIp']);
    _gaq.push(['_trackPageview']);
    _gaq.push( removeUtms );
    (function(d, k) {
      var ga = d.createElement(k); ga.type = 'text/javascript'; ga.async = true;
      ga.src = 'https://ssl.google-analytics.com/ga.js';
      var s = d.getElementsByTagName(k)[0]; s.parentNode.insertBefore(ga, s);
    })(document, 'script');
  </script>

  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<meta name="blog-name" content="Mozilla Hacks - the Web developer blog" />
<link rel="alternate" hreflang="en" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/" />
<link rel="alternate" hreflang="x-default" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/" />

	<!-- This site is optimized with the Yoast SEO plugin v17.5 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How MDN&#039;s autocomplete search works - Mozilla Hacks - the Web developer blog</title>
	<meta name="description" content="Autocomplete search added to MDN Web Docs allows you to quickly jump to the document you&#039;re looking for by typing parts of the document title" />
	<link rel="canonical" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Peter Bengtsson" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="6 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://hacks.mozilla.org/#website","url":"https://hacks.mozilla.org/","name":"Mozilla Hacks - the Web developer blog","description":"hacks.mozilla.org","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://hacks.mozilla.org/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#primaryimage","inLanguage":"en-US","url":"https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1.png","contentUrl":"https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1.png","width":816,"height":1508,"caption":"MDN's autocomplete search in action"},{"@type":"WebPage","@id":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#webpage","url":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/","name":"How MDN's autocomplete search works - Mozilla Hacks - the Web developer blog","isPartOf":{"@id":"https://hacks.mozilla.org/#website"},"primaryImageOfPage":{"@id":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#primaryimage"},"datePublished":"2021-08-03T15:49:30+00:00","dateModified":"2021-08-03T15:49:30+00:00","author":{"@id":"https://hacks.mozilla.org/#/schema/person/85075cdb55919f1a85deefd5b6e2e204"},"description":"Autocomplete search added to MDN Web Docs allows you to quickly jump to the document you're looking for by typing parts of the document title","breadcrumb":{"@id":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/"]}]},{"@type":"BreadcrumbList","@id":"https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://hacks.mozilla.org/"},{"@type":"ListItem","position":2,"name":"Articles","item":"https://hacks.mozilla.org/articles/"},{"@type":"ListItem","position":3,"name":"How MDN&#8217;s autocomplete search works"}]},{"@type":"Person","@id":"https://hacks.mozilla.org/#/schema/person/85075cdb55919f1a85deefd5b6e2e204","name":"Peter Bengtsson","image":{"@type":"ImageObject","@id":"https://hacks.mozilla.org/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/37d081c393f95a14e2704af38ecc4c8d?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/37d081c393f95a14e2704af38ecc4c8d?s=96&d=mm&r=g","caption":"Peter Bengtsson"},"description":"Peter is a staff web developer at Mozilla working on MDN Web Docs. He blogs on www.peterbe.com","sameAs":["https://www.peterbe.com"],"url":"https://hacks.mozilla.org/author/pbengtssonmozilla-com/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//blog.mozilla.org' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Mozilla Hacks - the Web developer blog &raquo; Feed" href="https://hacks.mozilla.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Mozilla Hacks - the Web developer blog &raquo; Comments Feed" href="https://hacks.mozilla.org/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Mozilla Hacks - the Web developer blog &raquo; How MDN&#8217;s autocomplete search works Comments Feed" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/feed/" />
<link rel='stylesheet' id='wp-block-library-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/css/dist/block-library/style.min.css?ver=5.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.16' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=5.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//blog.mozilla.org/hacks/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' type='text/css' media='all' />
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/js/analytics.js?ver=5.8.2' id='analytics-js'></script>
<link rel="https://api.w.org/" href="https://hacks.mozilla.org/wp-json/" /><link rel="alternate" type="application/json" href="https://hacks.mozilla.org/wp-json/wp/v2/posts/47344" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://hacks.mozilla.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://hacks.mozilla.org/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://hacks.mozilla.org/?p=47344' />
<link rel="alternate" type="application/json+oembed" href="https://hacks.mozilla.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhacks.mozilla.org%2F2021%2F08%2Fmdns-autocomplete-search%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://hacks.mozilla.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fhacks.mozilla.org%2F2021%2F08%2Fmdns-autocomplete-search%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.5.1 stt:59,61,1,2;" />
<link rel="shortcut icon" type="image/x-icon" href="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/favicon.ico" /><style>#wpadminbar #wp-admin-bar-site-name>.ab-item:before { content: none !important;}li#wp-admin-bar-site-name a { background: url( "https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/favicon.ico" ) left center/20px no-repeat !important; padding-left: 21px !important; background-size: 20px !important; } li#wp-admin-bar-site-name { margin-left: 5px !important; } li#wp-admin-bar-site-name {} #wp-admin-bar-site-name div a { background: none !important; }
</style></head>
<body>
  <div class="outer-wrapper">
    <header class="section section--fullwidth header">
      <div class="masthead row">
        <div class="branding block block--3">
          <h1>
            <a href="https://hacks.mozilla.org">
              <img class="branding__logo" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/mdn-logo-mono.svg">
              <img class="branding__wordmark" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/wordmark.svg" alt="Mozilla">
              <span class="branding__title">Hac<span class="logo-askew">k</span>s</span>
            </a>
          </h1>
        </div>
        <div class="search block block--2">
          <form class="search__form" method="get" action="https://hacks.mozilla.org/">
            <input type="search" name="s" class="search__input" placeholder="Search Mozilla Hacks" value="">
            <i class="fa fa-search search__badge"></i>
          </form>
        </div>
        <nav class="social">
          <a class="social__link youtube" href="http://www.youtube.com/user/mozhacks" title="YouTube"><i class="fa fa-youtube" aria-hidden="true"></i><span>Hacks on YouTube</span></a>
          <a class="social__link twitter" href="https://twitter.com/mozhacks" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i><span>@mozhacks on Twitter</span></a>
          <a class="social__link rss" href="https://hacks.mozilla.org/feed/" title="RSS Feed"><i class="fa fa-rss" aria-hidden="true"></i><span>Hacks RSS Feed</span></a>
          <a class="fx-button" href="https://www.mozilla.org/firefox/download/thanks/?utm_source=hacks.mozilla.org&utm_medium=referral&utm_campaign=header-download-button&utm_content=header-download-button">Download Firefox</a>
        </nav>
      </div>
    </header>

  
<div id="content-head" class="section">
  <h1 class="post__title">How MDN&#8217;s autocomplete search works</h1>
  <div class="byline">
    <h3 class="post__author">
                      <img alt='' src='https://secure.gravatar.com/avatar/37d081c393f95a14e2704af38ecc4c8d?s=64&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/37d081c393f95a14e2704af38ecc4c8d?s=128&#038;d=mm&#038;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' loading='lazy'/>        By
                                        <a class="url" href="https://www.peterbe.com" rel="external me">Peter Bengtsson</a>                            </h2>
    <div class="post__meta">
      Posted on
      <abbr class="published" title="2021-08-03T08:49:30-07:00">
        August 3, 2021      </abbr>
      <span class="entry-cat">in
        <a href="https://hacks.mozilla.org/category/docs/" rel="category tag" title="View all posts in Docs" >Docs</a>, <a href="https://hacks.mozilla.org/category/featured/" rel="category tag" title="View all posts in Featured Article" >Featured Article</a>, <a href="https://hacks.mozilla.org/category/javascript/" rel="category tag" title="View all posts in JavaScript" >JavaScript</a>,  and <a href="https://hacks.mozilla.org/category/mdn/" rel="category tag" title="View all posts in MDN" >MDN</a>      </span>
            <div class="socialshare" data-type="bubbles"></div>
    </div>
  </div>
</div>

<main id="content-main" class="section article">
  <article class="post" role="article">
    <p>Last month, <a href="https://github.com/Gregoor/">Gregor Weber</a> and I added an autocomplete search to <a href="https://developer.mozilla.org">MDN Web Docs</a>, that allows you to quickly jump straight to the document you&#8217;re looking for by typing parts of the document title. This is the story about how that&#8217;s implemented. If you stick around to the end, I&#8217;ll share an &#8220;easter egg&#8221; feature that, once you&#8217;ve learned it, will make you look really cool at dinner parties. Or, perhaps you just want to navigate MDN faster than mere mortals.</p>
<p><img loading="lazy" class="alignnone size-medium wp-image-47345" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/07/mdn-autocomplete-1-250x462.png" alt="MDN's autocomplete search in action" width="250" height="462" srcset="https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1-250x462.png 250w, https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1-500x924.png 500w, https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1-768x1419.png 768w, https://hacks.mozilla.org/files/2021/07/mdn-autocomplete-1.png 816w" sizes="(max-width: 250px) 100vw, 250px" /></p>
<p>In its simplest form, the input field has an <code>onkeypress</code> event listener that filters through a complete list of every single document title (per locale). At the time of writing, there are 11,690 different document titles (and their URLs) for English US. You can see a preview by opening <a href="https://developer.mozilla.org/en-US/search-index.json">https://developer.mozilla.org/en-US/search-index.json</a>. Yes, it&#8217;s huge, but it&#8217;s not too huge to load all into memory. After all, together with the code that does the searching, it&#8217;s only loaded when the user has indicated intent to type something. And speaking of size, because the file is compressed with <a href="https://developer.mozilla.org/en-US/docs/Glossary/brotli_compression">Brotli</a>, the file is only 144KB over the network.</p>
<h2>Implementation details</h2>
<p>By default, the only JavaScript code that&#8217;s loaded is a small shim that watches for <code>onmouseover</code> and <code>onfocus</code> for the search <code>&lt;input&gt;</code> field. There&#8217;s also an event listener on the whole <code>document</code> that looks for a certain keystroke. Pressing <code>/</code> at any point, acts the same as if you had used your mouse cursor to put focus into the <code>&lt;input&gt;</code> field. As soon as focus is triggered, the first thing it does is download two JavaScript bundles which turns the <code>&lt;input&gt;</code> field into something much more advanced. In its simplest (pseudo) form, here&#8217;s how it works:</p>
<pre class="html"><code>&lt;input 
 type="search" 
 name="q"
 onfocus="startAutocomplete()" 
 onmouseover="startAutocomplete()"
 placeholder="Site search..." 
 value="q"&gt;</code></pre>
<pre class="js"><code>let started = false;
function startAutocomplete() {
  if (started) {
    return false;
  }
  const script = document.createElement("script");
  script.src = "https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/static/js/autocomplete.js";
  document.head.appendChild(script);
}</code></pre>
<p>Then it loads <code>/static/js/autocomplete.js</code> which is where the real magic happens. Let&#8217;s dig deeper with the pseudo code:</p>
<pre class="js"><code>(async function() {
  const response = await fetch('/en-US/search-index.json');
  const documents = await response.json();
  
  const inputValue = document.querySelector(
    'input[type="search"]'
  ).value;
  const flex = FlexSearch.create();
  documents.forEach(({ title }, i) =&gt; {
    flex.add(i, title);
  });

  const indexResults = flex.search(inputValue);
  const foundDocuments = indexResults.map((index) =&gt; documents[index]);
  displayFoundDocuments(foundDocuments.slice(0, 10));
})();</code></pre>
<p>As you can probably see, this is an oversimplification of how it actually works, but it&#8217;s not yet time to dig into the details. The next step is to display the matches. We use (TypeScript) React to do this, but the following pseudo code is easier to follow:</p>
<pre class="js"><code>function displayFoundResults(documents) {
  const container = document.createElement("ul");
  documents.forEach(({url, title}) =&gt; {
    const row = document.createElement("li");
    const link = document.createElement("a");
    link.href = url;
    link.textContent = title;
    row.appendChild(link);
    container.appendChild(row);
  });
  document.querySelector('#search').appendChild(container);
}
</code></pre>
<p>Then with some CSS, we just display this as an overlay just beneath the <code>&lt;input&gt;</code> field. For example, we highlight each <code>title</code> according to the <code>inputValue</code> and various keystroke event handlers take care of highlighting the relevant row when you navigate up and down.</p>
<h2>Ok, let&#8217;s dig deeper into the implementation details</h2>
<p>We create the <code>FlexSearch</code> index just <i>once</i> and <i>re-use it for every new keystroke</i>. Because the user might type more while waiting for the network, it&#8217;s actually reactive so executes the actual search once all the JavaScript and the JSON XHR have arrived.</p>
<p>Before we dig into what this <code>FlexSearch</code> is, let&#8217;s talk about how the display actually works. For that we use a React library called <a href="https://www.npmjs.com/package/downshift">downshift</a> which handles all the interactions, displays, and makes sure the displayed search results are accessible. <code>downshift</code> is a mature library that handles a myriad of challenges with building a widget like that, especially the aspects of making it accessible.</p>
<p>So, what is this <a href="https://www.npmjs.com/package/flexsearch"><code>FlexSearch</code> library</a>? It&#8217;s another third party that makes sure that searching on titles is done with natural language in mind. It describes itself as the &#8220;Web&#8217;s fastest and most memory-flexible full-text search library with zero dependencies.&#8221; which is a lot more performant and accurate than attempting to simply look for one string in a long list of other strings.</p>
<h2>Deciding which result to show first</h2>
<p>In fairness, if the user types <code>foreac</code>, it&#8217;s not that hard to reduce a list of 10,000+ document titles down to only those that contain <code>foreac</code> in the title, then we decide which result to show first. The way we implement that is relying on pageview stats. We record, for every single MDN URL, which one gets the most pageviews as a form of determining &#8220;popularity&#8221;. The documents that most people decide to arrive on are most probably what the user was searching for.</p>
<p>Our <a href="https://github.com/mdn/yari">build-process</a> that generates the <code>search-index.json</code> file knows about each URLs number of pageviews. We actually don&#8217;t care about absolute numbers, but what we do care about is the relative differences. For example, we know that <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach"><code>Array.prototype.forEach()</code></a> (that&#8217;s one of the document titles) is a more popular page than <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/forEach"><code>TypedArray.prototype.forEach()</code></a>, so we leverage that and sort the entries in <code>search-index.json</code> accordingly. Now, with <code>FlexSearch</code> doing the reduction, we use the &#8220;natural order&#8221; of the array as the trick that tries to give users the document they were probably looking for. It&#8217;s actually the same technique we use for <code>Elasticsearch</code> in our full site-search. More about that in: <a href="https://hacks.mozilla.org/2021/03/how-mdns-site-search-works/">How MDN’s site-search works</a>.</p>
<h2>The easter egg: How to search by URL</h2>
<p>Actually, it&#8217;s not a whimsical easter egg, but a feature that came from the fact that this autocomplete needs to work for our content creators. You see, when you work on the <a href="https://github.com/mdn/content">content in MDN</a> you start a local &#8220;preview server&#8221; which is a complete copy of all documents but all running locally, as a static site, under <code>http://localhost:5000</code>. There, you don&#8217;t want to rely on a server to do searches. Content authors need to quickly move between documents, so much of the reason why the autocomplete search is done entirely in the client is because of that.</p>
<p>Commonly implemented in tools like the VSCode and Atom IDEs, you can do &#8220;fuzzy searches&#8221; to find and open files simply by typing portions of the file path. For example, searching for <code>whmlemvo</code> should find the file <code>files/<b>w</b>eb/<b>h</b>t<b>ml</b>/<b>e</b>lement/<b>v</b>ide<b>o</b></code>. You can do that with MDN&#8217;s autocomplete search too. The way you do it is by typing <code>/</code> as the first input character.</p>
<p><img loading="lazy" class="alignnone size-medium wp-image-47349" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2021/07/Screen-Shot-2021-07-30-at-3.47.26-PM-250x217.png" alt="Activate &quot;fuzzy search&quot; on MDN" width="250" height="217" srcset="https://hacks.mozilla.org/files/2021/07/Screen-Shot-2021-07-30-at-3.47.26-PM-250x217.png 250w, https://hacks.mozilla.org/files/2021/07/Screen-Shot-2021-07-30-at-3.47.26-PM-500x435.png 500w, https://hacks.mozilla.org/files/2021/07/Screen-Shot-2021-07-30-at-3.47.26-PM-768x667.png 768w, https://hacks.mozilla.org/files/2021/07/Screen-Shot-2021-07-30-at-3.47.26-PM.png 794w" sizes="(max-width: 250px) 100vw, 250px" /></p>
<p>It makes it really quick to jump straight to a document if you know its URL but don&#8217;t want to spell it out exactly.<br />
In fact, there&#8217;s another way to navigate and that is to first press <code>/</code> anywhere when browsing MDN, which activates the autocomplete search. Then you type <code>/</code> again, and you&#8217;re off to the races!</p>
<h2>How to get really deep into the implementation details</h2>
<p>The code for all of this is in the <a href="https://github.com/mdn/yari">Yari repo</a> which is the project that builds and previews all of the <a href="https://github.com/mdn/content">MDN content</a>. To find the exact code, click into the <a href="https://github.com/mdn/yari/blob/main/client/src/search.tsx"><code>client/src/search.tsx</code></a> source code and you&#8217;ll find all the code for lazy-loading, searching, preloading, and displaying autocomplete searches.</p>
    <section class="about">
                                <h2 class="about__header">About
                          <a class="url" href="https://www.peterbe.com" rel="external me">
                Peter Bengtsson              </a>
                      </h3>
                      <p>Peter is a staff web developer at Mozilla working on MDN Web Docs. He blogs on <a href="https://www.peterbe.com">www.peterbe.com</a></p>
                    <ul class="author-meta fa-ul"><li><i class="fa-li fa fa-globe"></i><a href="https://www.peterbe.com" class="website" rel="me">https://www.peterbe.com</a></li></ul>            <p><a class="url" href="https://hacks.mozilla.org/author/pbengtssonmozilla-com/">More articles by Peter Bengtsson&hellip;</a></p>
                  </section>
  </article>
  <section class="promo">
    <form id="newsletterForm" name="newsletter-form" class="newsletter block block--1 block--polite" action="https://www.mozilla.org/en-US/newsletter/" method="post">
  <h2 class="heading">Discover great resources for web development</h2>
  <p class="newsletter__description">Sign up for the Mozilla Developer Newsletter:</p>
  <input id="fmt" name="fmt" value="H" type="hidden">
  <input id="newsletterNewslettersInput" name="newsletters" value="app-dev" type="hidden">

  <div id="newsletterErrors" class="newsletter__errors"></div>

  <div id="newsletterEmail" class="form__row">
    <label for="newsletterEmailInput" class="offscreen">E-mail</label>
    <input id="newsletterEmailInput" name="email" class="newsletter__input" required="" placeholder="you@example.com" size="30" type="email">
  </div>

  <div id="newsletterPrivacy" class="form__row form__fineprint">
    <input id="newsletterPrivacyInput" name="privacy" required="" type="checkbox">
    <label for="newsletterPrivacyInput">
      I'm okay with Mozilla handling my info as explained in this <a href="https://www.mozilla.org/privacy/">Privacy Policy</a>.
    </label>
  </div>
  <button id="newsletter-submit" type="submit" class="button positive">Sign up now</button>
</form>
<div id="newsletterThanks" class="newsletter newsletter--thanks block block--1 block--polite hidden">
  <h2 class="heading">Thanks! Please check your inbox to confirm your subscription.</h2>
  <p>If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an email from us.
  </p>
</div>
  </section>
  

<section class="discussion">
  <hr class="dino">
  <div class="comments">
    <header class="comments__head">
      <h3>11 comments</h3>
    </header>

          <ol class="comments__list" class="hfeed">
      
 <li id="comment-27138" class="comment even thread-even depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">Sea Man</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>So you overrode a useful key to make it less useful? The slash activates Firefox&#8217;s quick search by default. Seems like an odd choice to override that.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27138" rel="bookmark" title="Permanent link to this comment by Sea Man"><abbr class="published" title="2021-08-03">August 3rd, 2021</abbr> at 10:47</a>

      <p class="comment__util"> </p>
  <ol class="children">

 <li id="comment-27139" class="comment byuser comment-author-pbengtssonmozilla-com bypostauthor odd alt depth-2">
      <b class="comment__title vcard">
      <cite class="author fn">Peter Bengtsson</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>It was a trade-off we picked. I think the inspiration came from how Algolia does/did it.<br />
I think the reason I never noticed myself was because I use ⌘-f to find in page. </p>
<p>Either way, putting focus into the search field is orthogonal to what happens when you&#8217;re in the input widget. </p>
<p>By the way, you can actually use ? too to the same effect. Is that also problematic as a shortcut? </p>
<p>Would you mind joining us on <a href="https://github.com/mdn/yari/issues/new" rel="nofollow ugc">https://github.com/mdn/yari/issues/new</a> and we can dig into the details. Your feedback is much appreciated!</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27139" rel="bookmark" title="Permanent link to this comment by Peter Bengtsson"><abbr class="published" title="2021-08-03">August 3rd, 2021</abbr> at 10:57</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->

 <li id="comment-27140" class="comment even thread-odd thread-alt depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">Patrick H. Lauke</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>Screen reader behaviour could be improved a tad. The a11y-status-message container is not always updated correctly &#8211; try typing in &#8220;test&#8221; letter by letter; on the first letter, it announces that 10 results are available; any subsequent letters that are typed in (and change the number of results) don&#8217;t update the message container/make any announcement. Other words are fine though &#8230; e.g. &#8220;axes&#8221; announces the different numbers of results as you go along. It&#8217;s a bit flakey.</p>
<p>Also, for keyboard users in general, once one of the suggestions is highlighted (after reaching it with cursor keys), but the user decides to bail out by using &#8220;Tab&#8221;, the result is triggered anyway as if they had pressed enter. It should just close the autocomplete results and move focus along.</p>
<p>Pressing Esc to close the autocomplete popup leads to focus being lost. While browsers generally error correct for this, it&#8217;s not reliable. Focus should be explicitly moved to the search input again.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27140" rel="bookmark" title="Permanent link to this comment by Patrick H. Lauke"><abbr class="published" title="2021-08-03">August 3rd, 2021</abbr> at 18:26</a>

      <p class="comment__util"> </p>
  <ol class="children">

 <li id="comment-27144" class="comment byuser comment-author-pbengtssonmozilla-com bypostauthor odd alt depth-2">
      <b class="comment__title vcard">
      <cite class="author fn">Peter Bengtsson</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>I see you posted <a href="https://github.com/mdn/yari/issues/4407" rel="nofollow ugc">https://github.com/mdn/yari/issues/4407</a> and that&#8217;s very much appreciated. I hope you can join us in fixing it.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27144" rel="bookmark" title="Permanent link to this comment by Peter Bengtsson"><abbr class="published" title="2021-08-04">August 4th, 2021</abbr> at 10:07</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->

 <li id="comment-27141" class="comment even thread-even depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">Konstantin</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>It&#8217;s an interesting post, but I&#8217;d like to point out that the focus on `/` does not seem to work with all keyboard layouts. Might be an a11y issue you might want to address.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27141" rel="bookmark" title="Permanent link to this comment by Konstantin"><abbr class="published" title="2021-08-03">August 3rd, 2021</abbr> at 23:23</a>

      <p class="comment__util"> </p>
  <ol class="children">

 <li id="comment-27145" class="comment byuser comment-author-pbengtssonmozilla-com bypostauthor odd alt depth-2">
      <b class="comment__title vcard">
      <cite class="author fn">Peter Bengtsson</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>Does typing ? work with all keyboard layouts?</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27145" rel="bookmark" title="Permanent link to this comment by Peter Bengtsson"><abbr class="published" title="2021-08-04">August 4th, 2021</abbr> at 10:10</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->

 <li id="comment-27143" class="comment even thread-odd thread-alt depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">Jonas Jensen</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>This was a cool read, thank you for posting this.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27143" rel="bookmark" title="Permanent link to this comment by Jonas Jensen"><abbr class="published" title="2021-08-04">August 4th, 2021</abbr> at 06:08</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->

 <li id="comment-27146" class="comment odd alt thread-even depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">pmario</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>The &#8220;/&#8221; key may be nice if you have the right keyboard layout but it doesn&#8217;t work if it is different eg: German, where you have to type: SHIFT-7 to get &#8220;/&#8221; &#8230;</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27146" rel="bookmark" title="Permanent link to this comment by pmario"><abbr class="published" title="2021-08-04">August 4th, 2021</abbr> at 12:31</a>

      <p class="comment__util"> </p>
  <ol class="children">

 <li id="comment-27147" class="comment byuser comment-author-pbengtssonmozilla-com bypostauthor even depth-2">
      <b class="comment__title vcard">
      <cite class="author fn">Peter Bengtsson</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>So pressing Shift and 7 doesn&#8217;t register, in the event listener, as a `/` in the end?</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27147" rel="bookmark" title="Permanent link to this comment by Peter Bengtsson"><abbr class="published" title="2021-08-04">August 4th, 2021</abbr> at 13:15</a>

      <p class="comment__util"> </p>
  <ol class="children">

 <li id="comment-27156" class="comment odd alt depth-3">
      <b class="comment__title vcard">
      <cite class="author fn">Sandro</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>No, it doesn&#8217;t work (I use a Swiss German keyboard layout). The useFocusOnSlash hook (in search utils) checks the event.code property which is &#8220;Digit7&#8221; in that case. I need to press &#8220;-&#8221; (the key to the left of the right shift key) to focus the search input, this results in event.code = &#8220;Slash&#8221;.</p>
<p>I&#8217;m not sure if event.code is the right property for that job as MDN says:<br />
&gt; This property is useful when you want to handle keys based on their physical positions on the input device rather than the characters associated with those keys</p>
<p>And that&#8217;s not what you want to do&#8230; I guess.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27156" rel="bookmark" title="Permanent link to this comment by Sandro"><abbr class="published" title="2021-08-07">August 7th, 2021</abbr> at 11:46</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->

 <li id="comment-27170" class="comment even thread-odd thread-alt depth-1">
      <b class="comment__title vcard">
      <cite class="author fn">Sosyallift</cite>
    </b>
  
    
    <blockquote class="comment__body">
      <p>Screen reader behaviour could be improved a tad. The a11y-status-message container is not always updated correctly – try typing in “test” letter by letter; on the first letter, it announces that 10 results are available; any subsequent letters that are typed in (and change the number of results) don’t update the message container/make any announcement. Other words are fine though … e.g. “axes” announces the different numbers of results as you go along. It’s a bit flakey.</p>
<p>Also, for keyboard users in general, once one of the suggestions is <a href="http://www.sosyallift.com" title="Sosyallift.com" rel="nofollow ugc"> Sosyallift</a> highlighted (after reaching it with cursor keys), but the user decides to bail out by using “Tab”, the result is triggered anyway as if they had pressed enter. It should just close the autocomplete results and move focus along.</p>
<p>Pressing Esc to close the autocomplete popup leads to focus being lost. While browsers generally error correct for this, it’s not reliable. Focus should be explicitly moved to the search input again.</p>
    </blockquote>

    <a class="comment__meta" href="https://hacks.mozilla.org/2021/08/mdns-autocomplete-search/#comment-27170" rel="bookmark" title="Permanent link to this comment by Sosyallift"><abbr class="published" title="2021-08-18">August 18th, 2021</abbr> at 14:59</a>

      <p class="comment__util"> </p>
  </li><!-- #comment-## -->
      </ol>
      </div>

<p class="comments__closed"><b>Comments are closed for this article.</b></p>


</main><!-- /#content-main -->

  

    <footer class="footer section section--fullwidth">
      <div class="row">
        <p class="block block--1">
          Except where otherwise noted, content on this site is licensed
          under the
          <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license external">Creative Commons Attribution Share-Alike License v3.0</a>
          or any later version.
        </p>
        <img class="footer__logo" alt="the Mozilla dino logo" src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/themes/Hax/img/dino.svg">
      </div>
    </footer>
  </div>
  <link rel='stylesheet' id='hljstheme-css'  href='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/styles/solarized-light.css?ver=0.6.2' type='text/css' media='all' />
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=5.8.2' id='wp-embed-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/highlight.common.pack.js?ver=0.6.2' id='hljs_preload-js'></script>
<script type='text/javascript' src='https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/wp-content/plugins/wp-code-highlightjs/highlight.custom.pack.js?ver=0.6.2' id='hljs-js'></script>
    <style>pre.hljs {padding: 5px;}
pre.hljs code {}</style>
    <script type="text/javascript">
    (function($, window) {
        var init_fn_flag = false;
        var init_fn = (function() {
            if (init_fn_flag)
                return;
            init_fn_flag = true;
             hljs.configure({"tabReplace":"    "});
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
        $(document).ready(init_fn);
        $(window).on("load", init_fn);
    })(jQuery, window);
    </script>
  <script>
    // External links should open in a new tab.
    (function () {
      var postLinks = document.querySelectorAll('#content-main a');

      var origin = location.origin;

      for (var i = 0; i < postLinks.length; i++) {
        var link = postLinks[i];
        if (link.origin !== origin && !link.getAttribute('target')) {
          link.setAttribute('target', '_blank');
        }
      }
    })();

    window.addEventListener('load', function () {
      if (document.querySelector('#newsletterForm')) {
        var script = document.createElement('script');
        var path = document.head.getAttribute('data-template-path');
        script.setAttribute('src', path + '/js/newsletter.js');
        document.head.appendChild(script);
      }
    });
  </script>
</body>
</html>
