<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.62ab618efddefb603269.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=DM+Mono&family=Inter:wght@400;700&display=swap);pre[class*=language-].line-numbers{padding-left:3.8em}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;left:-3.8em;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}:root{--primary:#7d87ff;--link-color:#fff;--border-color:#111;--heading-font-color:var(--primary);--background-color:#272727;--sidebar-color:#222;--navbar-color:#333;--sidebar-color-hover:#303030;--sidebar-color-focus:#444;--category-background-color:#161616;--category-background-color-hover:#2a2a2a;--light-border-color:#444;--toolbar-background-color:#1b1b1b;--toolbar-color:#eee;--tooltip-border-color:#555;--tooltip-background-color:#232323;--font-color:#b3b9c5;--medium-font-color:#aaa;--dark-font-color:#8f949d;--bright-font-color:#eee;--input-background:#393939;--blockquote-background-color:rgba(0,0,0,0.4);--blockquote-color:var(--light-font-color);--black:#111;--inline-code-background-color:rgba(0,0,0,0.2);--inline-code-color:#eee;--h2-filter:brightness(1);--h3-filter:brightness(1.3);--h4-filter:brightness(1.5);--dark-opacity:rgba(0,0,0,0.2);--dark-opacity-hover:rgba(0,0,0,0.3);--reverse:#111;--scrollbar:var(--border-color);--scrollbar-track:var(--light-border-color);--yellow:#ffb038;--font-family:"GT Walsheim",-apple-system,BlinkMacSystemFont,"Inter","Helvetica Neue","Roboto",Roboto,Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--heading-font-family:"GT Walsheim Bold",-apple-system,BlinkMacSystemFont,"Helvetica Neue","Roboto",Roboto,Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font-family:"GT Pressura Mono",Menlo,"DM Mono","Roboto Mono",Courier New,monospace}*,:after,:before{box-sizing:border-box}a:focus-visible,button:focus-visible{outline:3px solid var(--primary)}body{-webkit-font-smoothing:antialiased;background:var(--background-color);font-family:var(--font-family);font-size:1rem;line-height:1.6;margin:0}blockquote,ol,p,table,ul{font-size:1.2rem;margin:0 0 2rem}button{appearance:none;-moz-appearance:none;-webkit-appearance:none;background:transparent;border:none;cursor:pointer}ul{padding-left:1.5rem}ul li{margin-bottom:.5rem}ul li p{margin:0}ul li ul{margin:.5rem}h1,h2,h3,h4,h5{color:var(--heading-font-color);font-family:var(--heading-font-family);line-height:1.2;margin:0 0 1.5rem;scroll-margin-top:60px}a{text-decoration:none}a.button{background:var(--primary);border:1px solid var(--primary)!important;color:var(--reverse);display:block;padding:.5rem 1rem}a.button:hover{-webkit-filter:brightness(1.1);filter:brightness(1.1)}a.button.icon-button{align-items:center;display:flex}a.button.icon-button img{margin-right:.5rem;max-height:30px}table{border-collapse:separate;border-spacing:0;display:block;max-width:100%;overflow-x:auto;width:100%}tbody,thead{white-space:nowrap}th{border-bottom:2px solid var(--border-color)}tfoot th{border-top:1px solid var(--border-color)}td{border-bottom:1px solid var(--border-color)}td,th{-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;padding:.75rem!important;text-align:left;word-break:break-word}tbody tr:nth-child(odd){background-color:var(--dark-opacity)}@media screen and (min-width:800px){table{border:1px solid var(--border-color);display:table}tbody,thead{white-space:normal}}.navbar{background:var(--navbar-color);display:flex;height:calc(100vh - 28px);min-width:80px;position:fixed;top:0;z-index:10}.navbar section{display:flex;flex-direction:column;justify-content:space-between;width:100%}.navbar a,.navbar button{align-items:center;border-left:3px solid transparent;border-right:3px solid transparent;color:var(--font-color);display:flex;justify-content:center;padding:1rem;position:relative;transition:border .2s ease}.navbar img{-webkit-filter:drop-shadow(4px 3px 1px rgba(0,0,0,.4));filter:drop-shadow(4px 3px 1px rgba(0,0,0,.4))}.navbar a:hover,.navbar button:hover{background:var(--dark-opacity)}.navbar a.active,.navbar a:focus{background:var(--dark-opacity-hover);border-left:3px solid var(--primary);outline:none}.navbar button:focus{outline:none}.navbar a .tooltip,.navbar button .tooltip{align-items:center;background:var(--tooltip-background-color);border:1px solid var(--tooltip-border-color);box-shadow:1px 10px 15px rgb(0 0 0/60%);color:var(--bright-font-color);display:none;font-size:.9rem;justify-content:center;left:120px;line-height:1.6;padding:.2rem .75rem;position:absolute;top:50%;-webkit-transform:translate3D(-50%,-50%,0);transform:translate3D(-50%,-50%,0);white-space:nowrap;width:5rem;z-index:11}.navbar a:hover .tooltip,.navbar button:hover .tooltip{display:flex}.navbar a .tooltip:before,.navbar button .tooltip:before{background:var(--tooltip-background-color);box-shadow:-1px 1px 0 0 var(--tooltip-border-color);content:"";display:block;height:.5rem;left:-.25rem;margin-top:-.25rem;position:absolute;top:50%;-webkit-transform:rotate(45deg);transform:rotate(45deg);width:.5rem}.navbar img{height:auto;max-width:40px}.sidebar{background:var(--sidebar-color);height:calc(100vh - 28px);left:80px;overflow-x:hidden;overflow-y:hidden;position:fixed;top:0;width:320px;z-index:9}.sidebar:hover{overflow-y:auto}.sidebar .title{align-items:center;background:var(--toolbar-background-color);color:var(--font-color);display:flex;font-size:.85rem;font-weight:600;height:35px;justify-content:space-between;padding:0 .5rem 0 2.5rem;position:fixed;text-transform:uppercase;top:0;width:320px;z-index:8}button.colors .colors-dropdown{background:var(--toolbar-background-color);box-shadow:0 3px 3px rgba(0,0,0,.2);display:none;left:0;position:absolute;top:35px;width:100%}button.colors.open{background:var(--toolbar-background-color);color:var(--font-color)}button.colors.open .colors-dropdown{display:block;z-index:13}.color{cursor:pointer;padding:.2rem}.color span{border-radius:50%;display:block;height:12px;width:12px}.color-selection{align-items:center;color:var(--font-color);display:flex;height:30px;justify-content:space-between;padding:0 .5rem}.color-selection:hover{background:rgba(0,0,0,.1);color:var(--bright-font-color)}.color-selection:hover span{-webkit-filter:brightness(1.1);filter:brightness(1.1)}.sidebar .categories{margin-top:35px}.sidebar button.collapse-categories{height:35px;padding:0 .75rem}.sidebar button.collapse-categories:hover{background:var(--dark-opacity)}.sidebar button.collapse-categories div{border:1px solid var(--font-color);line-height:0;padding:1px 3px}.sidebar button.collapse-categories svg rect{fill:var(--font-color)}.sidebar button.category{align-items:center;background:var(--category-background-color);border:none;color:var(--bright-font-color);cursor:pointer;display:grid;font-size:.8rem;font-weight:700;grid-template-columns:1.5rem auto;margin-bottom:1px;padding:.75rem 1rem;position:sticky;text-align:left;text-transform:uppercase;top:35px;width:100%;z-index:7}.sidebar button.category:hover{background:var(--category-background-color-hover);color:var(--bright-font-color)}.sidebar button.category:focus-visible{background:var(--primary);border-bottom:none;color:var(--reverse)!important;outline:none}.sidebar button.category:focus{color:var(--bright-font-color);outline:none}.sidebar button.category svg{margin-right:.5rem}.sidebar button.category:focus svg path,.sidebar button.category svg path{stroke:var(--bright-font-color)}.sidebar button.category:focus-visible svg path{stroke:var(--reverse)}.sidebar nav{width:320px}.sidebar nav.collapsed{display:none}.sidebar a{align-items:center;border-left:3px solid transparent;color:var(--medium-font-color);display:grid;font-family:var(--heading-font-family);font-size:.85rem;grid-template-columns:2rem auto;line-height:1.2;padding:.4rem 1rem}.sidebar a svg path{-webkit-filter:var(--icon-filter);filter:var(--icon-filter)}.sidebar a:hover{background:var(--sidebar-color-hover);color:var(--bright-font-color)}.sidebar a.active,.sidebar a:focus{background:var(--sidebar-color-focus);border-left:3px solid var(--primary);color:var(--bright-font-color);outline:none}.sidebar a.active svg path{fill:var(--primary)}.footer{background:var(--toolbar-background-color);bottom:0;height:28px;left:0;position:fixed;width:100%;z-index:10}.footer section{align-items:stretch;display:flex;height:100%;justify-content:space-between}.footer img{display:inline-block;max-height:20px;width:auto}.footer nav{display:flex;gap:.25rem;margin:0 1rem}.footer a,.footer span{align-items:center;color:var(--dark-font-color);display:flex;font-size:.8rem;line-height:28px;padding:0 .5rem}.footer span{color:var(--toolbar-color)}.footer a:hover{background:var(--dark-opacity);color:var(--bright-font-color);cursor:pointer}main{margin-left:400px;margin-top:35px}.no-sidebar main{margin-left:80px}.container{margin-left:auto;margin-right:auto;max-width:900px;padding:2rem}.container.large{max-width:1350px}.container.small,.small{max-width:550px}.file-header{background:var(--toolbar-background-color);display:flex;height:35px;justify-content:flex-start;left:400px;padding-right:.5rem;position:fixed;top:0;width:calc(100vw - 400px);z-index:9}.no-sidebar .file-header{left:80px;width:calc(100vw - 80px)}.file-header button{align-items:center;background:transparent;border:none;color:var(--font-color);cursor:pointer;display:flex;gap:.5rem;justify-content:space-between;line-height:0;padding:0 1rem;position:relative}.file-header button:hover{background:var(--dark-opacity);color:var(--font-color)}.file-header button:focus{outline:none}.file-header button:focus-visible{outline:3px solid var(--primary)}.file-header button span{font-size:.9rem}.file-header button svg rect{fill:var(--font-color)}.file{align-items:center;background:var(--background-color);border-right:1px solid var(--sidebar-color);border-top:3px solid var(--primary);border-top-right-radius:3px;color:var(--bright-font-color);display:flex;font-size:.9rem;left:0;padding:0 1rem;position:relative;top:0}.theme-switcher img{max-width:20px}.toolbar{display:flex;margin-left:auto}.toolbar button{border-left:1px solid var(--background-color)}.toolbar button:first-of-type{border-left:1px solid transparent}.hero header{padding:2rem 0 0;text-align:left}.hero h1{color:var(--bright-font-color);font-size:3.2rem;margin-bottom:1rem}.hero p.subtitle{color:var(--font-color);font-size:1.4rem}.hero .hero-buttons{align-items:center;display:flex;gap:1rem}article{margin-bottom:3rem}article header{text-align:center}article h1{color:var(--bright-font-color);font-size:2.5rem;font-weight:700;margin-bottom:.75rem}article h2,article h3,article h4,article h5{margin:0 0 1.25rem}article .description{color:var(--dark-font-color);font-size:1.4rem;margin-bottom:0}.post-details{color:var(--dark-font-color);margin:1rem 0}.tags{align-items:center;display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center;margin:1.5rem 0}.tags a{background:var(--tooltip-background-color);border:1px solid var(--tooltip-border-color);color:var(--bright-font-color);display:inline-block;font-size:.9rem;font-weight:400;line-height:normal;padding:.3rem .5rem;vertical-align:middle}.tags a:hover{background:transparent;border:1px solid var(--primary);color:var(--primary);font-weight:400}article a{border-top:2px solid transparent;color:var(--link-color)}article a,article a:hover{border-bottom:2px solid var(--primary);font-weight:600}article a:hover{background:var(--primary);border-top:2px solid var(--primary);color:var(--reverse)}article li a,article li a:hover{border-bottom:none;border-top:none}article img{display:block;max-width:100%}article h2{-webkit-filter:var(--h2-filter);filter:var(--h2-filter);font-size:2.25rem;padding-bottom:.25rem}article h2 code{font-size:2.2rem!important}article h3{-webkit-filter:var(--h3-filter);filter:var(--h3-filter);font-size:1.75rem}article h3 code{font-size:1.6rem!important}article h4{-webkit-filter:var(--h4-filter);filter:var(--h4-filter);font-size:1.1rem;padding-bottom:.25rem;text-transform:uppercase}article h4 code{font-size:1.25rem!important}article h5{font-size:1rem;text-transform:uppercase}h2:not(:first-child),h3:not(:first-child),h4:not(:first-child){margin-top:3rem}blockquote{background:var(--blockquote-background-color);border:2px solid var(--tooltip-border-color);padding:1rem}blockquote p{color:var(--blockquote-color)}blockquote ul{margin-top:1rem}blockquote p:last-of-type,blockquote ul:last-of-type{margin-bottom:0}.comments{padding-bottom:2rem}.blog-page h2{border-bottom:2px solid var(--light-border-color);margin-top:2.5rem}a.post{grid-gap:1rem;align-items:center;border:1px solid transparent;display:grid;grid-template-columns:auto 60px;margin-left:-1rem;margin-right:-1rem;padding:.55rem 1rem}a.post.new,a.post:hover{background:var(--dark-opacity);border:1px solid transparent}a.post.new{background:transparent;border:1px solid transparent}a.post.new:hover{background:var(--dark-opacity)}a.post.new time{color:var(--yellow)!important}a.post.new h3{color:var(--bright-font-color)}a.post.new .new-badge{color:var(--yellow);margin-right:.75rem}a.post h3{color:var(--font-color);-webkit-filter:brightness(1);filter:brightness(1);font-size:1.1rem;font-weight:500;margin:0}a.post:hover h3{color:var(--bright-font-color)}a.post:hover time,a.post time{color:var(--dark-font-color)}a.post time{display:block;font-family:var(--code-font-family);font-size:.8rem;font-weight:400;text-align:center}.projects{display:flex;flex-direction:column}@media screen and (min-width:600px){.projects{grid-gap:2rem;display:grid;grid-template-columns:repeat(auto-fill,300px);justify-content:center}}.project{background:var(--dark-opacity);border:1px solid var(--border-color);color:var(--dark-font-color);display:flex;flex-direction:column;padding:1.5rem}.project h2{border-bottom:none;font-size:1.5rem;margin-bottom:0;text-align:center}.project .description{color:var(--font-color);font-size:1.2rem;line-height:1.3;margin-bottom:1rem;text-align:center}.project .links{display:flex;gap:.5rem}.project .stars{align-items:center;display:flex;gap:1rem;justify-content:center;margin-top:auto}.project .stars img{max-width:20px}a.anchor.before{border:none}a.anchor.before:hover{background:transparent}a.anchor.before svg{fill:#fff}a.image-link,a.image-link:hover{border-bottom:none;border-top:none}a.image-link:hover{background:none}.primary-color{color:var(--primary)}.primary-underline{border-bottom:3px solid var(--primary)}.deemphasized{color:var(--dark-font-color)}.gatsby-resp-image-wrapper{margin-left:0!important}a.gatsby-resp-image-link{background:transparent!important;border-bottom:none!important;border-top:none!important}.highlighted{background:var(--primary);color:var(--reverse)}.not-found-image{margin:0 auto;width:400px}.flex{display:flex}.flex-align-center{align-items:center}.flex-header,.flex-justify-between{justify-content:space-between}.flex-header{align-items:center;display:flex}.flex-header a{font-size:1rem}.search-bar{grid-gap:1rem;align-items:center;display:grid;grid-template-columns:auto 50px}.search-icon{cursor:pointer}.search-input{-webkit-appearance:none;background:var(--input-background);border:1px solid transparent;border-radius:0;color:var(--bright-font-color);font-size:1.1rem;line-height:1.1;padding:.75rem 1rem;width:100%}.search-input:active,.search-input:focus,.search-input:hover{border-color:var(--primary)}.search-input:focus{box-shadow:1px 1px 1px var(--primary);-webkit-filter:brightness(1.1);filter:brightness(1.1);outline:none}::-webkit-scrollbar{background:var(--scrollbar);height:8px;width:8px}::-webkit-scrollbar-thumb{background:var(--scrollbar-track);border-radius:0}::selection{background:var(--primary);color:var(--reverse)}::-moz-selection{background:var(--primary);color:var(--reverse)}::marker{color:var(--primary)}.search-input::-webkit-search-cancel-button{color:var(--bright-font-color)}.collapsed main{margin-left:80px}.collapsed .file-header{left:80px;width:calc(100vw - 80px)}.collapsed .sidebar{display:none}.desktop-only{display:block!important}@media screen and (max-width:1000px){blockquote,ol,p,table,ul{font-size:1.05rem;margin:0 0 1.5rem}main{margin-left:0!important;margin-top:95px}.sidebar{display:none}.navbar{border-bottom:1px solid var(--light-border-color);box-shadow:1px 1px 2px rgba(0,0,0,.1);height:60px;left:0;top:35px;width:100%;z-index:9}.navbar img{max-width:30px}.navbar section{flex-direction:row}.navbar section nav{display:flex}.navbar a,.navbar button{border-left:none!important;border-right:none!important}.navbar a.active,.navbar a:focus,.navbar a:hover,.navbar button:focus-visible{background:var(--navbar-color);border-left:none!important;border-right:none!important}.navbar button:focus{border:3px solid transparent;border-left:none;border-right:none}.navbar a:hover .tooltip,.navbar button:hover .tooltip{display:none}.file-header{left:0!important;margin-top:0;width:100%!important}.file{background:var(--navbar-color)}.file,.file-header button span{font-size:1rem}button.colors,button.colors .colors-dropdown{width:100px}.projects{grid-gap:1rem;grid-template-columns:repeat(2,50%)}.project .stars{justify-content:center}.footer{height:auto;padding:1.5rem 0;position:static}.footer section{align-items:center;flex-direction:column;gap:1.25rem}.footer a,.footer span{line-height:1.2}.desktop-only{display:none!important}.hero h1{font-size:2.5rem}.hero p.subtitle{font-size:1.2rem}.container{padding:1.5rem}article h1{font-size:2.2rem;line-height:1.2}article header{padding-top:1rem}article .description{font-size:1.3rem}}.theme{background:var(--background-color);color:var(--font-color)}#resume header{text-align:left}#resume section h2,#resume section h3,#resume section h4,#resume section h5{margin-bottom:1rem;margin-top:0}#resume section h2{border-bottom:1px solid var(--light-border-color);font-size:1.1rem;margin-top:2.5rem;text-transform:uppercase}#resume section h3{align-items:center;display:flex;justify-content:space-between}#resume section h3 span{display:block;font-size:1rem;font-weight:400}#resume section h3{font-size:1.3rem;margin-bottom:.5rem}#resume section li,#resume section p{font-size:1rem;line-height:1.3}#resume section li{margin-bottom:.5rem}.divider{background:var(--primary);height:1px;margin-bottom:2rem;width:100%}:root{--code-font-color:#b3b9c5;--code-background-color:#333;--string:#92d192;--variable:#f2777a;--property:#abb2bf;--number:#fca369;--operator:#ac8d58;--punctuation:#d5d8df;--comment:#848991;--function:#62cfcf;--keyword:#ffeead;--attribute:#ffd479;--class:#e1a6f2;--tag:#6ab0f3;--error:#f2777a;--terminal-color:var(--code-font-color)}code[class*=language-],pre[class*=language-]{word-wrap:normal;color:var(--code-font-color);font-family:var(--code-font-family);font-size:.9rem!important;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{-webkit-font-smoothing:subpixel-antialiased;background:var(--code-background-color);font-family:Menlo,monospace;margin-bottom:2rem;margin-top:2rem;overflow:initial;padding:1rem}:not(pre)>code[class*=language-]{-webkit-font-smoothing:antialiased;background:var(--inline-code-background-color)!important;color:var(--inline-code-color)!important;font-size:1rem;font-weight:600;padding:2px 3px;white-space:pre-wrap}a:hover :not(pre)>code[class*=language-]{color:var(--black)}pre.language-text{background:transparent}pre.language-shell,pre.language-terminal,pre.language-text.line-numbers{padding-left:1.5rem!important}pre.language-shell .line-numbers-rows,pre.language-terminal .line-numbers-rows,pre.language-text .line-numbers-rows{display:none}code.language-text{background:var(--light-background)!important;box-shadow:none;color:var(--font-color)!important}pre.language-text code.language-text{border:none}code.language-shell:before{color:var(--comment);content:"$ "}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:4.5rem;position:relative}pre.language-terminal{-webkit-text-size-adjust:none;background:var(--reverse);border:1px solid var(--category-background-color);color:var(--font-color);margin:2rem 0;padding-top:3rem;position:relative;white-space:normal}code.language-terminal{-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:none;-moz-text-size-adjust:none;text-size-adjust:none;color:var(--terminal-color)}pre.language-terminal:before{background:var(--category-background-color);border-bottom:1px solid var(--light-border-color);color:var(--dark-font-color);content:"\2022 \2022 \2022";font-size:2.5rem;left:0;letter-spacing:-5px;line-height:0;margin:0;padding:15px 0 12px;position:absolute;text-indent:6px;top:0;width:100%}.line-numbers .line-numbers-rows{border-right:1px solid #444;font-size:100%;left:-3.8rem;letter-spacing:-1px;padding-right:.5rem;pointer-events:none;position:absolute;top:1rem!important;width:3rem!important}.line-numbers-rows>span:before{color:#777}.gatsby-highlight{-webkit-text-size-adjust:none;-moz-text-size-adjust:none;text-size-adjust:none;font-size:.9rem;margin:1.5rem -1.5rem;max-width:999999px;overflow-x:auto;overflow-y:hidden;padding-left:1.5rem}.gatsby-highlight pre[class*=language-]{float:left;margin-bottom:0;margin-top:0;min-width:calc(100% + 1.5rem)}.gatsby-highlight-code-line{background-color:#222;border-left:.25rem solid var(--primary);display:block;margin-left:-.75rem;margin-right:-1rem;padding-left:.5rem;padding-right:1.5rem}.filename{align-items:center;background:#222;color:#ccc;display:flex;font-size:.9rem;line-height:1;margin-bottom:-2rem;padding:.5rem 1.5rem}.token.cdata,.token.comment,.token.doctype,.token.important,.token.prolog{color:var(--comment)}.token.punctuation{color:var(--punctuation)}.token.namespace{opacity:.7}.token.property{color:var(--property)}.token.constant,.token.deleted,.token.symbol,.token.tag{color:var(--tag)}.token.number{color:var(--number)}.token.builtin,.token.char,.token.inserted,.token.url{color:var(--code-font-color)}.token.attr-name,.token.selector{color:var(--attribute)}.token.attr-value,.token.string{color:var(--string)}.token.operator{color:var(--operator)}.token.atrule,.token.keyword{color:var(--keyword)}.token.function{color:var(--function)}.language-css,.token.boolean,.token.class-name{color:var(--class)!important}.token.regex{color:var(--keyword)}.token.variable{color:var(--variable)}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.language-jsx .token.class-name{color:var(--tag)!important}code::selection,pre::selection{background:hsla(0,0%,59%,.3)!important;color:inherit;text-shadow:none}code[class*=language-] ::selection,pre[class*=language-]::selection{background:hsla(0,0%,59%,.3)!important;color:inherit;text-shadow:none}.filename,pre[class*=language-]{margin-left:-1.5rem;margin-right:-1.5rem}pre[class*=language-].line-numbers{padding-left:3.5rem}pre[class*=language-]{margin-bottom:1.5rem;margin-top:1.5rem}.filename{margin-bottom:-1.5rem}@media screen and (min-width:1350px){.gatsby-highlight{margin-bottom:2rem}.filename{margin-top:2rem}.filename,.gatsby-highlight{margin-left:-3.5rem;margin-right:-3.5rem}pre.language-text.line-numbers{padding-left:3.5rem!important}}.light.theme{--heading-font-color:#222;--link-color:#111;--border-color:#bbb;--light-border-color:#d0d0d0;--background-color:#fff;--sidebar-color:#f0f0f0;--navbar-color:#ddd;--sidebar-color-hover:#dedede;--sidebar-color-focus:#fff;--category-background-color:#d5d5d5;--category-background-color-hover:silver;--toolbar-color:#333;--toolbar-background-color:#f0f0f0;--tooltip-border-color:#999;--tooltip-background-color:#f0f0f0;--font-color:#454545;--medium-font-color:#555;--dark-font-color:#888;--input-background:transparent;--bright-font-color:#222;--blockquote-background-color:rgba(0,0,0,0.02);--blockquote-color:#111;--inline-code-background-color:rgba(0,0,0,0.05);--inline-code-color:#111;--h2-filter:brightness(0.8);--h3-filter:brightness(0.9);--h4-filter:brightness(0.95);--icon-filter:brightness(0.8);--dark-opacity:rgba(0,0,0,0.05);--dark-opacity-hover:rgba(0,0,0,0.1);--reverse:#fff;--terminal-color:var(--bright-font-color);--scrollbar:#888;--scrollbar-track:#bbb}</style><meta name="generator" content="Gatsby 3.12.1"/><title data-react-helmet="true">Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript | Tania Rascia</title><meta data-react-helmet="true" name="description" content="Recently, I set up unit and integration tests for a Node API in TypeScript, and I couldn&#x27;t find a lot of resources for setting up and…"/><meta data-react-helmet="true" name="image" content="https://www.taniarascia.com/static/ed9878c0488cff7b7ee973c201f0bb68/92ab1/ts.png"/><meta data-react-helmet="true" property="og:url" content="https://www.taniarascia.com/integration-testing-with-jest-typescript-objection/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript"/><meta data-react-helmet="true" property="og:description" content="Recently, I set up unit and integration tests for a Node API in TypeScript, and I couldn&#x27;t find a lot of resources for setting up and…"/><meta data-react-helmet="true" property="og:image" content="https://www.taniarascia.com/static/ed9878c0488cff7b7ee973c201f0bb68/92ab1/ts.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript"/><meta data-react-helmet="true" name="twitter:description" content="Recently, I set up unit and integration tests for a Node API in TypeScript, and I couldn&#x27;t find a lot of resources for setting up and…"/><meta data-react-helmet="true" name="twitter:image" content="https://www.taniarascia.com/static/ed9878c0488cff7b7ee973c201f0bb68/92ab1/ts.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://www.taniarascia.com","name":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript","alternateName":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://www.taniarascia.com/integration-testing-with-jest-typescript-objection/","name":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript","image":"https://www.taniarascia.com/static/ed9878c0488cff7b7ee973c201f0bb68/92ab1/ts.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://www.taniarascia.com","name":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript","alternateName":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript","headline":"Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript","image":{"@type":"ImageObject","url":"https://www.taniarascia.com/static/ed9878c0488cff7b7ee973c201f0bb68/92ab1/ts.png"},"description":"Recently, I set up unit and integration tests for a Node API in TypeScript, and I couldn't find a lot of resources for setting up and…"}]</script><link rel="icon" href="/favicon-32x32.png?v=07f5a193c5a1357203c0389b1002fb71" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#5183f5"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=07f5a193c5a1357203c0389b1002fb71"/><link rel="alternate" type="application/rss+xml" title="Tania Rascia | RSS Feed" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link as="script" rel="preload" href="/webpack-runtime-a0e74d583841f3e0a74a.js"/><link as="script" rel="preload" href="/framework-97155db9408cb0e3fcd4.js"/><link as="script" rel="preload" href="/app-2c67c096c1a7f0695165.js"/><link as="script" rel="preload" href="/commons-99325db68594412750ba.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-855d4395f6fd9edac223.js"/><link as="fetch" rel="preload" href="/page-data/integration-testing-with-jest-typescript-objection/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/352937542.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><article><header><div class="container"><h1>Integration Tests with Jest, Supertest, Knex, and Objection in TypeScript</h1><div class="post-meta"><div class="tags"><a class="tag-typescript" href="/tags/typescript">typescript</a><a class="tag-testing" href="/tags/testing">testing</a><a class="tag-jest" href="/tags/jest">jest</a><a class="tag-node" href="/tags/node">node</a></div><div class="post-details">Written by <a href="/me">Tania Rascia</a> on<!-- --> <time>April 06, 2021</time></div></div><p class="description">Learn how to set up and tear down a database for integration tests using Jest and Supertest in a TypeScript API. Make actual calls to an actual database in your tests and assert the HTTP responses.</p></div></header><div id="/integration-testing-with-jest-typescript-objection/" class="container"><p>Recently, I set up unit and integration tests for a Node API in TypeScript, and I couldn't find a lot of resources for setting up and tearing down, database seeding, and hooking everything up in TypeScript, so I'll share the approach I went with.</p>
<h4 id="prerequisites" style="position:relative;"><a href="#prerequisites" aria-label="prerequisites permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h4>
<p>This article will help if:</p>
<ul>
<li>You're using <a href="https://www.typescriptlang.org/">TypeScript</a> as the language for an API in <a href="https://nodejs.org/en/">Node</a>/<a href="https://expressjs.com/">Express</a>.</li>
<li>You're using <a href="https://vincit.github.io/objection.js/">Objection.js</a> as an ORM for your API, which runs on <a href="https://knexjs.org/">Knex</a> behind the scenes.</li>
<li>You're using <a href="https://jestjs.io/">Jest</a> for testing.</li>
</ul>
<h4 id="goals" style="position:relative;"><a href="#goals" aria-label="goals permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Goals</h4>
<ul>
<li>You want to be able to spin up a test database, make real API calls with responses and errors, and tear down the database at the end of the tests.</li>
</ul>
<p>This is not meant to be a complete tutorial that gives step-by-step instructions for every detail, but will give you the big picture of setting up the TypeScript API with Objection and making a test suite for it.</p>
<h2 id="installation" style="position:relative;"><a href="#installation" aria-label="installation permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>This app involves <code class="language-text">objection</code>, <code class="language-text">knex</code>, <code class="language-text">pg</code>, <code class="language-text">express</code>, and <code class="language-text">typescript</code>, with <code class="language-text">jest</code> and <code class="language-text">supertest</code> for testing.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span></span><span class="token function">npm</span> i objection knex pg express
<span class="token function">npm</span> i -D typescript jest jest-extended supertest ts-jest ts-node</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2 id="setup" style="position:relative;"><a href="#setup" aria-label="setup permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup</h2>
<p>Assume you have an API with an endpoint at <code class="language-text">GET /books/:id</code> that returns a Book object. Your Objection model for the Book would look like this, assuming there's a <code class="language-text">book</code> table in the database:</p>
<div class="filename">book.model.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'objection'</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  id<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span>
  name<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span>
  author<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span>

  <span class="token keyword">static</span> tableName <span class="token operator">=</span> <span class="token string">'book'</span> <span class="token comment">// database table name</span>
  <span class="token keyword">static</span> idColumn <span class="token operator">=</span> <span class="token string">'id'</span> <span class="token comment">// id column name</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">BookShape</span> <span class="token operator">=</span> ModelObject<span class="token operator">&lt;</span>Book<span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Here's an Express app with a single endpoint. It's essential to export <code class="language-text">app</code> and NOT run <code class="language-text">app.listen()</code> here so tests won't start the app and cause issues.</p>
<div class="filename">app.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> express<span class="token punctuation">,</span> <span class="token punctuation">{</span> Application<span class="token punctuation">,</span> Request<span class="token punctuation">,</span> Response<span class="token punctuation">,</span> NextFunction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Book <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./book.model'</span>

<span class="token comment">// Export the app</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> app<span class="token operator">:</span> Application <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// GET endpoint for the book</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>
  <span class="token string">'/books/:id'</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span>request<span class="token operator">:</span> Request<span class="token punctuation">,</span> response<span class="token operator">:</span> Response<span class="token punctuation">,</span> next<span class="token operator">:</span> NextFunction<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>params

      <span class="token keyword">const</span> book<span class="token operator">:</span> BookShape <span class="token operator">=</span> <span class="token keyword">await</span> Book<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>book<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Book not found'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>The <code class="language-text">index.ts</code> is where you would set up your database connection and start the app.</p>
<div class="filename">index.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> Knex <span class="token keyword">from</span> <span class="token string">'knex'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'objection'</span>

<span class="token comment">// Import the app</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> app <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app'</span>

<span class="token comment">// Set up the database (assuming Postgres)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">5000</span>
<span class="token keyword">const</span> knex <span class="token operator">=</span> <span class="token function">Knex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
  connection<span class="token operator">:</span> <span class="token punctuation">{</span>
    host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    database<span class="token operator">:</span> <span class="token string">'books_database'</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">5432</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">'your_password'</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span> <span class="token string">'your_username'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Connect database to Objection</span>
Model<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span>knex<span class="token punctuation">)</span>

<span class="token comment">// Start the app</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">*:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - Listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>So now you have a complete API for the <code class="language-text">/books/:id</code> endpoint. This API would start with:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>tsc <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> start</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Or you could use <code class="language-text">nodemon</code> to get a dev server going.</p>
<h2 id="migration" style="position:relative;"><a href="#migration" aria-label="migration permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migration</h2>
<p>In Knex, you can use a migration to seed the schema/data instead of just using raw SQL. To make a <a href="http://knexjs.org/#Migrations">migration</a>, you'd just use the Knex CLI to create a migration file:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>knex migrate:make initial-schema</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>And set up the data - in this case, making <code class="language-text">book</code> table with a few columns:</p>
<div class="filename">db/migrations/initial-chema.js</div>
<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">exports<span class="token punctuation">.</span><span class="token function-variable function">up</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">knex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token string">'book'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    table<span class="token punctuation">.</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">primary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notNullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    table<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'author'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notNullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">down</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">knex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> knex<span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token string">'book'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Similar instructions are available for <code class="language-text">seed</code>.</p>
<h2 id="test-configuration" style="position:relative;"><a href="#test-configuration" aria-label="test configuration permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Test Configuration</h2>
<p>Your basic <code class="language-text">jest.config.js</code> would look something like this:</p>
<div class="filename">jest-config.js</div>
<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  clearMocks<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  roots<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;rootDir>'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testEnvironment<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^.+\\.ts?$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  setupFilesAfterEnv<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jest-extended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  globals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'ts-jest'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      diagnostics<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalSetup<span class="token operator">:</span> <span class="token string">'&lt;rootDir>/tests/global-setup.ts'</span><span class="token punctuation">,</span>
  globalTeardown<span class="token operator">:</span> <span class="token string">'&lt;rootDir>/tests/global-teardown.ts'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Note the <code class="language-text">globalSetup</code> and <code class="language-text">globalTeardown</code> properties and their corresponding files. In those files, you can seed and migrate the database, and tear it down when you're done.</p>
<h3 id="global-setup" style="position:relative;"><a href="#global-setup" aria-label="global setup permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Global setup</h3>
<p>In the global setup, I made a two step process - first connect without the database to create it, then migrate and seed the database. (<a href="http://knexjs.org/#Migrations">Migration instructions</a> are in the Knex documentation.)</p>
<div class="filename">tests/global-setup.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> Knex <span class="token keyword">from</span> <span class="token string">'knex'</span>

<span class="token keyword">const</span> database <span class="token operator">=</span> <span class="token string">'test_book_database'</span>

<span class="token comment">// Create the database</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createTestDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> knex <span class="token operator">=</span> <span class="token function">Knex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">/* connection info without database */</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span><span class="token function">raw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DROP DATABASE IF EXISTS </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>database<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span><span class="token function">raw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">CREATE DATABASE </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>database<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Seed the database with schema and data</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">seedTestDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> knex <span class="token operator">=</span> <span class="token function">Knex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    client<span class="token operator">:</span> <span class="token string">'pg'</span><span class="token punctuation">,</span>
    connection<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">/* connection info with database */</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span>migrate<span class="token punctuation">.</span><span class="token function">latest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span>seed<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Then just export the function that does both.</p>
<div class="filename">tests/global-setup.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">createTestDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">seedTestDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Test database created successfully'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3 id="global-teardown" style="position:relative;"><a href="#global-teardown" aria-label="global teardown permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Global teardown</h3>
<p>For teardown, just delete the database.</p>
<div class="filename">tests/global-teardown.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> knex<span class="token punctuation">.</span><span class="token function">raw</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DROP DATABASE IF EXISTS </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>database<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="integration-tests" style="position:relative;"><a href="#integration-tests" aria-label="integration tests permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integration Tests</h2>
<p>With an integration test, you want to be able to seed some data in the individual test, and be able to test all the successful responses as well as error responses.</p>
<p>In the test setup, you can add any additional seed data to the database that you want, creating a new Knex instance and connecting it to the Objection model.</p>
<p>These tests will utilize <a href="https://www.npmjs.com/package/supertest">Supertest</a>, a popular library for HTTP assertions.</p>
<p>Import supertest, knex, objection, and the app, seed whatever data you need, and begin writing tests.</p>
<div class="filename">books.test.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'supertest'</span>
<span class="token keyword">import</span> Knex <span class="token keyword">from</span> <span class="token string">'knex'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'objection'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> app <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../app'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'books'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> knex<span class="token operator">:</span> <span class="token builtin">any</span>
  <span class="token keyword">let</span> seededBooks

  <span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    knex <span class="token operator">=</span> <span class="token function">Knex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">/* configuration information with test_book_database */</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    Model<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span>knex<span class="token punctuation">)</span>

    <span class="token comment">// Seed anything</span>
    seededBooks <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">knex</span><span class="token punctuation">(</span><span class="token string">'book'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'A Game of Thrones'</span><span class="token punctuation">,</span> author<span class="token operator">:</span> <span class="token string">'George R. R. Martin'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">returning</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    knex<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">decribe</span><span class="token punctuation">(</span><span class="token string">'GET /books/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// Tests will go here</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3 id="successful-response-test" style="position:relative;"><a href="#successful-response-test" aria-label="successful response test permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Successful response test</h3>
<p>At this point, all the setup is ready and you can test a successful seed and <code class="language-text">GET</code> on the endpoint.</p>
<div class="filename">tests/books.test.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return a book'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> seededBooks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id

  <span class="token keyword">const</span> <span class="token punctuation">{</span> body<span class="token operator">:</span> book <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/books/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'A Game of Thrones'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h3 id="error-response-test" style="position:relative;"><a href="#error-response-test" aria-label="error response test permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Error response test</h3>
<p>It's also important to make sure all expected errors are working properly.</p>
<div class="filename">tests/books.test.ts</div>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return 404 error '</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> badId <span class="token operator">=</span> <span class="token number">7500</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> body<span class="token operator">:</span> errorResult <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/books/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>badId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>errorResult<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toStrictEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    message<span class="token operator">:</span> <span class="token string">'Book not found'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="conclusion" style="position:relative;"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>Now once you run <code class="language-text">npm run test</code>, or <code class="language-text">jest</code>, in the command line, it will create the <code class="language-text">test_book_database</code> database, seed it with any migrations you had (to set up the schema and any necessary data), and you can access the database in each integration test.</p>
<p>This ensures the entire process from database seeding to the API controllers are working properly. This type of code will give you full coverage on the models, routes, and handlers within the app.</p></div></article><section id="comments" class="comments container"><h2>Comments</h2><div></div></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/integration-testing-with-jest-typescript-objection/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-3d3abe80edde96e60783.js"],"app":["/app-2c67c096c1a7f0695165.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d76829c69637006557b1.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-66650a6abbb0d281679c.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5c9acbffdf2efd338ab0.js"],"component---src-pages-notes-js":["/component---src-pages-notes-js-cfe54b2a40be3b21c4a1.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-25992abc219b15b21e4d.js"],"component---src-templates-category-js":["/component---src-templates-category-js-52135eae98ea43ba7b30.js"],"component---src-templates-note-js":["/component---src-templates-note-js-573bf0a9a36243f2e71e.js"],"component---src-templates-page-js":["/component---src-templates-page-js-cbf0799a96c58c65aa62.js"],"component---src-templates-post-js":["/component---src-templates-post-js-855d4395f6fd9edac223.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-163b692971695ad5a520.js"]};/*]]>*/</script><script src="/polyfill-3d3abe80edde96e60783.js" nomodule=""></script><script src="/component---src-templates-post-js-855d4395f6fd9edac223.js" async=""></script><script src="/commons-99325db68594412750ba.js" async=""></script><script src="/app-2c67c096c1a7f0695165.js" async=""></script><script src="/framework-97155db9408cb0e3fcd4.js" async=""></script><script src="/webpack-runtime-a0e74d583841f3e0a74a.js" async=""></script></body></html>