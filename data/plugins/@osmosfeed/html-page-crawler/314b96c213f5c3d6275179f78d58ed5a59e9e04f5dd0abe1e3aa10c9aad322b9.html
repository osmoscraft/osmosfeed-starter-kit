<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta name="robots" content="noodp">

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, viewport-fit=cover">

    <title>  The File System Access API with Origin Private File System | WebKit</title>

    <meta name="application-name" content="WebKit">

    <link rel="stylesheet" type="text/css" href="https://webkit.org/wp-content/themes/webkit/style.css?20200127" media="all">
    <link rel="stylesheet" href="https://www.apple.com/wss/fonts?families=SF+Pro,v1" type="text/css">
    <link rel="stylesheet" href="https://www.apple.com/wss/fonts?families=SF+Mono,v2" type="text/css">
    <meta name="supported-color-schemes" content="light dark">

    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="https://webkit.org/feed/">
    <link rel="alternate" type="text/xml" title="RSS .92" href="https://webkit.org/feed/rss/">
    <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="https://webkit.org/feed/atom/">
    <link rel="pingback" href="https://webkit.org/wp/xmlrpc.php">

    <link rel="shortcut icon" sizes="32x32" type="image/x-icon" href="/favicon.ico">

    <meta name='robots' content='max-image-preview:large' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://webkit.org/wp/wp-includes/css/dist/block-library/style.min.css?ver=5.9' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://webkit.org/wp/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://webkit.org/wp/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.9" />
<link rel="canonical" href="https://webkit.org/blog/12257/the-file-system-access-api-with-origin-private-file-system/" />
<link rel='shortlink' href='https://webkit.org/?p=12257' />
<link rel="alternate" type="application/json+oembed" href="https://webkit.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwebkit.org%2Fblog%2F12257%2Fthe-file-system-access-api-with-origin-private-file-system%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://webkit.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwebkit.org%2Fblog%2F12257%2Fthe-file-system-access-api-with-origin-private-file-system%2F&#038;format=xml" />

    <!-- Schema.org markup -->
    <meta itemprop="name" content="The File System Access API with Origin Private File System">
    <meta itemprop="description" content="WebKit supports new API that makes it possible for web apps to create, open, read, and write files directly, or create directories and enumerate their contents.">

    <!-- Twitter Card data -->
    <meta name="twitter:site" content="@webkit">
    <meta name="twitter:title" content="The File System Access API with Origin Private File System">
    <meta name="twitter:description" content="WebKit supports new API that makes it possible for web apps to create, open, read, and write files directly, or create directories and enumerate their contents.">

    <!-- Open Graph data -->
    <meta property="og:title" content="The File System Access API with Origin Private File System">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://webkit.org/blog/12257/the-file-system-access-api-with-origin-private-file-system/">
    <meta property="og:description" content="WebKit supports new API that makes it possible for web apps to create, open, read, and write files directly, or create directories and enumerate their contents.">
    <meta property="og:site_name" content="WebKit">
    <meta property="article:published_time" content="2022-02-14T09:00:36-08:00">
    <meta property="article:modified_time" content="2022-02-14T10:19:52-08:00">
    <meta property="article:section" content="Standards">
    <meta property="fb:admins" content="1085088865">
</head>
<body class="post-template-default single single-post postid-12257 single-format-standard">
    <!-- Copyright © 2020 Apple Inc. All rights reserved. -->
<svg xmlns="http://www.w3.org/2000/svg">
	<style> svg { display: block; width: 0; height: 0; } </style>
    <filter id="invertLightness" x="0" y="0" style="color-interpolation-filters: sRGB">
        <feColorMatrix type="matrix" in="SourceGraphic" result="red" values="1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 1" />
        <feColorMatrix type="matrix" in="SourceGraphic" result="green" values="0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1" />
        <feColorMatrix type="matrix" in="SourceGraphic" result="blue" values="0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1" />
        <feBlend in="red" in2="green" mode="lighten" result="maxyellow" />
        <feBlend in="maxyellow" in2="blue" mode="lighten" result="max" />
        <feBlend in="red" in2="green" mode="darken" result="minyellow" />
        <feBlend in="minyellow" in2="blue" mode="darken" result="min" />
        <feComponentTransfer result="adjustment" in="min">
            <feFuncR type="linear" intercept="1" slope="-1" />
            <feFuncG type="linear" intercept="1" slope="-1" />
            <feFuncB type="linear" intercept="1" slope="-1" />
        </feComponentTransfer>
        <feComposite operator="arithmetic" in="SourceGraphic" in2="adjustment" k1="0" k2="1" k3="1" k4="-1" result="channelAdjustment" />
        <feComposite operator="arithmetic" in="channelAdjustment" in2="max" k1="0" k2="1" k3="-1" k4="1" result="finalColors" />
        <feComposite operator="in" in="finalColors" in2="SourceAlpha" />
    </filter>
</svg>    <header aria-label="WebKit.org Header" id="header">
        <div class="page-width">
        <a href="/"><div id="logo" class="site-logo">WebKit</div></a>
        <nav id="site-nav" aria-label="Site Menu">
<div class="menu-main-menu-container"><input type="checkbox" id="menu-main-menu-toggle" class="menu-toggle" /><label for="menu-main-menu-toggle" class="label-toggle main-menu" data-open="Main Menu" data-close="Close Menu"></label><ul id="menu-main-menu" class="menu" role="menubar"><li id="menu-item-4270" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-4270"><a href="https://webkit.org/blog/" role="menuitem">Blog</a></li>
<li id="menu-item-6091" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6091"><a href="https://webkit.org/downloads/" role="menuitem">Downloads</a></li>
<li id="menu-item-4272" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4272"><a href="https://webkit.org/status/" role="menuitem">Feature Status</a></li>
<li id="menu-item-9988" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-9988"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><a href="#nav-sub-menu" role="menuitem" aria-haspopup="true" aria-owns="sub-menu-for-9988" aria-controls="sub-menu-for-9988" aria-expanded="true"><label for="toggle-9988" class="label-toggle">Documentation</label></a>
<ul class="sub-menu sub-menu-layer" role="menu" id="sub-menu-for-9988">
	<li id="menu-item-4273" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4273"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><a href="https://webkit.org/reporting-bugs/" role="menuitem">How to Report Bugs</a></li>
	<li id="menu-item-9989" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9989"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><a href="/web-inspector" role="menuitem">Web Inspector</a></li>
	<li id="menu-item-10868" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10868"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><a href="https://webkit.org/tracking-prevention/" role="menuitem">Tracking Prevention</a></li>
</ul>
</li>
<li id="menu-item-4274" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-4274"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="#nav-sub-menu" role="menuitem" aria-haspopup="true" aria-owns="sub-menu-for-4274" aria-controls="sub-menu-for-4274" aria-expanded="true"><label for="toggle-4274" class="label-toggle">Contribute</label></a>
<ul class="sub-menu sub-menu-layer" role="menu" id="sub-menu-for-4274">
	<li id="menu-item-10037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10037"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="https://webkit.org/project/" role="menuitem">Project Goals</a></li>
	<li id="menu-item-4277" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4277"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="https://webkit.org/getting-started/" role="menuitem">Getting Started</a></li>
	<li id="menu-item-4284" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4284"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="https://webkit.org/contributing-code/" role="menuitem">Contributing Code</a></li>
	<li id="menu-item-4281" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4281"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="https://webkit.org/testing-contributions/" role="menuitem">Testing Contributions</a></li>
	<li id="menu-item-4282" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4282"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="https://webkit.org/policy-and-guidelines/" role="menuitem">Policy and Guidelines</a></li>
	<li id="menu-item-4278" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4278"><input type="checkbox" id="toggle-9988" class="menu-toggle" /><input type="checkbox" id="toggle-4274" class="menu-toggle" /><a href="http://trac.webkit.org" role="menuitem">Trac Timeline</a></li>
</ul>
</li>
</ul></div></nav>
        </div>
    </header>

<main id="content">
    <div class="page-width">
    
        <article class="post-12257 post type-post status-publish format-standard hentry category-standards" id="post-12257">
            <h1><a href="https://webkit.org/blog/12257/the-file-system-access-api-with-origin-private-file-system/" rel="bookmark" title="Permanent Link: The File System Access API with Origin Private File System">The File System Access API with Origin Private File System</a></h1>
            <div class="byline">
                <p class="date">Feb 14, 2022</p>
                <p class="author">by <span>Sihui Liu</span></p>
                            </div>

            <div class="bodycopy">
                <p>It is very common for an application to interact with local files. For example, a general workflow is opening a file, making some changes, and saving the file. For web apps, this might be hard to implement. It is possible to simulate the file operations using IndexedDB API, an HTML input element with the <code>file</code> type, an HTML anchor element with the <code>download</code> attribute, etc, but that would require a good understanding of these standards and careful design for a good user experience. Also, the performance may not be satisfactory for frequent operations and large files.</p>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API">File System Access API</a> makes it possible for web apps to have easy and efficient file access. It provides a way to create, open, read, and write files directly. It also allows apps to create directories and enumerate their contents.</p>
<h2>Origin Private File System</h2>
<p>WebKit has added support for the File System Access API with <a href="https://wicg.github.io/file-system-access/#wellknowndirectory-origin-private-file-system">the origin private file system</a> — a private storage endpoint to some <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin">origin</a>. Conceptually, every origin owns an independent directory, and a page can only access files or directories in its origin’s directory. For example, <a href="https://webkit.org/">https://webkit.org</a> cannot read files created by <a href="https://apple.com/">https://apple.com</a>.</p>
<p>Based on the implementation of different browsers, one entry in the origin private file system does not necessarily map to an entry in the user’s local filesystem — it can be an object stored in some database. That means a file or directory created via the File System Access API may not be easily retrieved from outside of the browser.</p>
<h2>Persistence</h2>
<p>The API is currently unavailable for Safari windows in Private Browsing mode. For where is it available, its storage lifetime is the same as other persistent storage types like IndexedDB and LocalStorage. The storage policy will conform to the <a href="https://storage.spec.whatwg.org/#storage-endpoints">Storage Standard</a>. Safari users can view and delete file system storage for a site via Preferences on macOS or Settings on iOS.</p>
<h2>Browser Support</h2>
<p>The File System Access API with origin private file system is enabled in WebKit from <a href="https://commits.webkit.org/242951@main">r284131</a>. It is available in Safari on:</p>
<ul>
<li>macOS 12.2 and above</li>
<li>iOS 15.2 and above</li>
</ul>
<p>In Safari on macOS 12.4 and iOS 15.4, we introduced the <code>getFile()</code> method of <code>FileSystemFileHandle</code>.</p>
<h2>The API</h2>
<p>WebKit currently supports four interfaces of the File System Access API:</p>
<ul>
<li><code>FileSystemHandle</code>, which represents an entry in the file system. It is available in Worker and </li>
<li><code>FileSystemFileHandle</code>, which inherits from FileSystemHandle and represents a file entry. </li>
<li><code>FileSystemDirectoryHandle</code>, which inherits from FileSystemHandle and represents a directory entry. </li>
<li><code>FileSystemSyncAccessHandle</code>, which provides an exclusive duplex stream for synchronous read and write on an entry. Unlike the interfaces above, which exist in both Window and Worker contexts, <code>FileSystemSyncAccessHandle</code> is only available in Worker.</li>
</ul>
<p>With these basic interfaces in mind, let&#8217;s look at how to use them by diving into some examples.</p>
<h2>Examples</h2>
<h3>Accessing the Origin Private File System</h3>
<p>In the origin private file system, a <code>FileSystemHandle</code> represents either the root directory of the origin’s space, or a descendant of the root directory. Therefore, the first step is to get the root <code>FileSystemDirectoryHandle</code>. It is done via <a href="https://storage.spec.whatwg.org/#dom-navigatorstorage-storage"><code>StorageManager</code></a> interface.</p>
<pre><code class="js"><span class="keyword type">const</span> <span class="identifier">root</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">navigator</span>.<span class="identifier">storage</span>.<span class="identifier">getDirectory</span>();
</code></pre>
<h3>Creating a directory or a file</h3>
<p>With a <code>FileSystemDirectoryHandle</code> object like root, you can get access to its child with some specific name using <code>getDirectoryHandle()</code> and <code>getFileHandle()</code> methods.</p>
<pre><code class="js"><span class="comment">// Create a file named Untiled.txt under root directory.
</span><span class="keyword type">const</span> <span class="identifier">untitledFile</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getFileHandle</span>(<span class="string">"Untitled.txt"</span>, { <span class="string">"create"</span> <span class="operator">:</span> <span class="keyword literal">true</span> });
<span class="comment">// Get access to existing Untitled.txt file.
</span><span class="comment">// untitledFile and existingUntitledFile point to the same entry.
</span><span class="keyword type">const</span> <span class="identifier">existingUntitledFile</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getFileHandle</span>(<span class="string">"Untitled.txt"</span>);
<span class="comment">// Create a directory named Diary Folder.
</span><span class="keyword type">const</span> <span class="identifier">diaryDirectory</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getDirectoryHandle</span>(<span class="string">"Diary Folder"</span>, { <span class="string">"create"</span> <span class="operator">:</span> <span class="keyword literal">true</span> });
</code></pre>
<h3>Moving or Renaming a Directory or a File</h3>
<p>To move around the file or directory a <code>FileSystemHandle</code> represents, you can use the <code>move()</code> method. The first parameter is a <code>FileSystemDirectoryHandle</code> representing the target parent directory, and the second parameter is a <code>USVString</code> representing the target file name. The string must be a <a href="https://wicg.github.io/file-system-access/#valid-file-name">valid file name</a>.</p>
<pre><code class="js"><span class="comment">// Move Untitled.txt from /root/ to /root/Diary Folder/.
</span><span class="identifier">await</span> <span class="identifier">untitledFile</span>.<span class="identifier">move</span>(<span class="identifier">diaryDirectory</span>, <span class="identifier">untitledFile</span>.<span class="identifier">name</span>);
<span class="comment">// Rename Untitled.txt to Feb_01.txt
</span><span class="identifier">await</span> <span class="identifier">untitledFile</span>.<span class="identifier">move</span>(<span class="identifier">diaryDirectory</span>, <span class="string">"Feb_01.txt"</span>);
<span class="comment">// The two steps above can be combined as:
</span><span class="comment">// await untitledFile.move(diaryDirectory, "Feb_01.txt");
</span></code></pre>
<h3>Resolving the Path from a Directory Entry to its Descendant</h3>
<p>To find out if a <code>FileSystemHandle</code> is a descendant of an existing <code>FileSystemDirectoryHandle</code>, and to get their relative path, you can use the <code>resolve()</code> method. The result is an array of component names that forms the path.</p>
<pre><code class="js"><span class="comment">// Get access to Feb_01.txt in Diary Folder.
</span><span class="keyword type">const</span> <span class="identifier">diaryFile</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">diaryDirectory</span>.<span class="identifier">getFileHandle</span>(<span class="string">"Feb_01.txt"</span>);
<span class="comment">// Resolve path between Feb_01.txt and root.
</span><span class="keyword type">const</span> <span class="identifier">relativePath</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">resolve</span>(<span class="identifier">diaryFile</span>);
<span class="comment">// relativePath is ["Diary Folder", "Feb_01.txt"].
</span></code></pre>
<h3>Enumerating Contents in a Directory</h3>
<p>The methods introduced above require you to know the name of target, but if you don’t know the name, you can still get it by enumerating the contents of an existing directory with <code>async</code> iterators returned by the <code>keys()</code>, <code>values()</code>, and <code>entries()</code> methods.</p>
<pre><code class="js"><span class="comment">// Create a directory named Trash under the root directory.
</span><span class="keyword type">const</span> <span class="identifier">trashDirectory</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getDirectoryHandle</span>(<span class="string">"Trash"</span>, { <span class="string">"create"</span> <span class="operator">:</span> <span class="keyword literal">true</span> });
<span class="comment">// Find directories under root/ and print their names.
</span><span class="keyword type">const</span> <span class="identifier">directoryNames</span> <span class="operator">=</span> [];
<span class="keyword control">for</span> <span class="identifier">await</span> (<span class="keyword type">const</span> <span class="identifier">handle</span> <span class="keyword operator">of</span> <span class="identifier">root</span>.<span class="identifier">values</span>()) {
    <span class="keyword control">if</span> (<span class="identifier">handle</span>.<span class="identifier">kind</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">"directory"</span>) {
        <span class="identifier">directoryNames</span>.<span class="identifier">push</span>(<span class="identifier">handle</span>.<span class="identifier">name</span>);
    }
}
<span class="comment">// directoryNames is ["Trash", "Diary Folder"].
</span></code></pre>
<h3>Deleting a Directory or a File</h3>
<p>With a <code>FileSystemDirectoryHandle</code> object, you can delete its child entries by name with the <code>removeEntry()</code> method.</p>
<pre><code class="js"><span class="comment">// Delete Feb_01.txt in Diary Folder.
</span><span class="identifier">await</span> <span class="identifier">diaryDirectory</span>.<span class="identifier">removeEntry</span>(<span class="identifier">diaryFile</span>.<span class="identifier">name</span>);
<span class="comment">// Delete Trash and all its descendants.
</span><span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">removeEntry</span>(<span class="identifier">trashDirectory</span>.<span class="identifier">name</span>, { <span class="string">"recursive"</span> <span class="operator">:</span> <span class="keyword literal">true</span> });
</code></pre>
<h3>Reading a File</h3>
<p>Once you have the <code>FileSystemFileHandle</code> representing the target file, you can read its properties and content by converting it to a <a href="https://w3c.github.io/FileAPI/#file-section"><code>File</code></a> object using the <code>getFile()</code> method. You can get file information and content using interfaces of <code>File</code>.</p>
<pre><code class="js"><span class="keyword type">const</span> <span class="identifier">fileHandle</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getFileHandle</span>(<span class="string">"Draft.txt"</span>, { <span class="string">"create"</span> <span class="operator">:</span> <span class="keyword literal">true</span> });
<span class="keyword type">const</span> <span class="identifier">file</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">fileHandle</span>.<span class="identifier">getFile</span>();
</code></pre>
<h3>Reading and Writing a File in a Worker Thread</h3>
<p>Another way to read a file is to use the <code>read()</code> method of the <code>FileSystemSyncAccessHandle</code> interface. You can create a <code>FileSystemSyncAccessHandle</code> from a <code>FileSystemFileHandle</code> object using the <code>createSyncAccessHandle()</code> method. Since <code>FileSystemSyncAccessHandle</code> is only available in Worker contexts, you will need to <a href="https://html.spec.whatwg.org/multipage/workers.html#creating-a-dedicated-worker">create a dedicated Worker</a> first.</p>
<p>Unlike <code>getFile()</code> that returns a Promise, <code>read()</code> is synchronous, and thus provides better performance. If you&#8217;re aiming for the most efficient file access, <code>FileSystemSyncAccessHandle</code> is the way to go.</p>
<p>To write a file, you can use the synchronous <code>write()</code> method of <code>FileSystemSyncAccessHandle</code>. In the current implementation, this is the only way to write a file in WebKit.</p>
<p>To implement synchronous read and write operations, a <code>FileSystemSyncAccessHandle</code> must have exclusive access to a file entry. Therefore, the attempt to create a second <code>FileSystemSyncAccessHandle</code> on an entry will fail, if the previous <code>FileSystemSyncAccessHandle</code> is not closed properly.</p>
<pre><code class="js"><span class="comment">// Get access to the existing Draft.txt file.
</span><span class="keyword type">const</span> <span class="identifier">root</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">navigator</span>.<span class="identifier">storage</span>.<span class="identifier">getDirectory</span>();
<span class="keyword type">const</span> <span class="identifier">draftFile</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">root</span>.<span class="identifier">getFileHandle</span>(<span class="string">"Draft.txt"</span>);
<span class="comment">// Create FileSystemSyncAccessHandle on the file.
</span><span class="keyword type">const</span> <span class="identifier">accessHandle</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">draftFile</span>.<span class="identifier">createSyncAccessHandle</span>();
<span class="comment">// Get size of the file.
</span><span class="keyword type">const</span> <span class="identifier">fileSize</span> <span class="operator">=</span> <span class="identifier">await</span> <span class="identifier">accessHandle</span>.<span class="identifier">getSize</span>();
<span class="comment">// Read file content to a buffer.
</span><span class="keyword type">const</span> <span class="identifier">readBuffer</span> <span class="operator">=</span> <span class="keyword operator">new</span> <span class="identifier">ArrayBuffer</span>(<span class="identifier">fileSize</span>);
<span class="keyword type">const</span> <span class="identifier">readSize</span> <span class="operator">=</span> <span class="identifier">accessHandle</span>.<span class="identifier">read</span>(<span class="identifier">readBuffer</span>, { <span class="string">"at"</span><span class="operator">:</span> <span class="number">0</span> });
<span class="comment">// Write a sentence to the end of the file.
</span><span class="keyword type">const</span> <span class="identifier">encoder</span> <span class="operator">=</span> <span class="keyword operator">new</span> <span class="identifier">TextEncoder</span>();
<span class="keyword type">const</span> <span class="identifier">writeBuffer</span> <span class="operator">=</span> <span class="identifier">encoder</span>.<span class="identifier">encode</span>(<span class="string">"Thank you for reading this."</span>);
<span class="keyword type">const</span> <span class="identifier">writeSize</span> <span class="operator">=</span> <span class="identifier">accessHandle</span>.<span class="identifier">write</span>(<span class="identifier">writeBuffer</span>, { <span class="string">"at"</span> <span class="operator">:</span> <span class="identifier">readSize</span> });
<span class="comment">// Truncate file to 1 byte.
</span><span class="identifier">await</span> <span class="identifier">accessHandle</span>.<span class="identifier">truncate</span>(<span class="number">1</span>);
<span class="comment">// Persist changes to disk.
</span><span class="identifier">await</span> <span class="identifier">accessHandle</span>.<span class="identifier">flush</span>();
<span class="comment">// Always close FileSystemSyncAccessHandle if done.
</span><span class="identifier">await</span> <span class="identifier">accessHandle</span>.<span class="identifier">close</span>();
</code></pre>
<h2>Summary</h2>
<p>If your web app needs to interact with files, you should try the new File System Access API. It provides interfaces that are similar to the native file system API, with optimized performance.</p>
<p>As the standard evolves and development goes on, we will keep adding or updating interfaces and methods according to the <a href="https://wicg.github.io/file-system-access/">File System Access API</a> spec. If you encounter any issue when using this API, please file a bug on <a href="https://bugs.webkit.org/">bugs.webkit.org</a> under the “Website Storage” component. You may also create a new bug report for feature requests, describing your use case and why the feature is important. If you have any question or suggestion about the API itself, you can file a spec issue in the <a href="https://github.com/wicg/file-system-access/issues/">WICG repo</a>. Your feedback is very important to us.</p>

                            </div>
        </article>

        <aside class="nextrouter" aria-label="Next/Previous posts">
            <div class="bodycopy">
                                    </div>
        </aside>
        <aside class="nextrouter previous" aria-label="Next/Previous posts">
            <div class="bodycopy">
            <a class="page-numbers prev-post" href="https://webkit.org/blog/12255/release-notes-for-safari-technology-preview-140/" rel="prev"><div class="nextrouter-copy"><span class="label">Previously</span><span class="title">Release Notes for Safari Technology Preview 140</span><span class="link">Learn more</span></div></a>            </div>
        </aside>

    
    
    </div><!--.page-width-->
</main><!-- #content -->

<footer>
    <div class="page-width">
        <nav id="footer-nav" aria-label="Footer menu"><div class="menu-footer-menu-container"><ul id="menu-footer-menu" class="menu"><li id="menu-item-7617" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7617"><a href="https://twitter.com/webkit">@webkit</a></li>
<li id="menu-item-5365" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5365"><a href="https://webkit.org/sitemap/">Site Map</a></li>
<li id="menu-item-4185" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4185"><a href="http://www.apple.com/legal/privacy/">Privacy Policy</a></li>
<li id="menu-item-4287" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4287"><a href="https://webkit.org/licensing-webkit/">Licensing WebKit</a></li>
<li id="menu-item-4187" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4187"><a href="https://webkit.org/terms-of-use/">WebKit and the WebKit logo are trademarks of Apple Inc.</a></li>
</ul></div></nav>
    </div>
</footer>


<script type='text/javascript' src='https://webkit.org/wp-content/themes/webkit/scripts/global.js?ver=1.0' id='theme-global-js'></script>
</body>
</html>
<!-- Dynamic page generated in 0.232 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2022-02-14 16:21:50 -->

<!-- super cache -->